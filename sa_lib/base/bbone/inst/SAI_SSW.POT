;read object texts
#DO READ_TEXT("SAGR_LANG/SAI_SSW.TXT")

;collect information for object identifier (OI-attribute)
@OBJ_IDENT
#LOOP_WITH I = 1 .. %NR_OF_FIELDS
  @FIELD_IDENT = %OBJECT_IDENTIFIER_'I'_NAME
  @OBJ_IDENT=%OBJ_IDENT+SUBSTR('ID'_PICTURE_FUNCTION_CONF:V'FIELD_IDENT',1,%OI_LENGTH'I')
#LOOP_END

;collect information for RX-attribute
#IF 'ID'_PICTURE_FUNCTION_CONF:VCHANNEL_NUMBER>0 #THEN @ADDITIONAL_IDENT= SUBSTR(DEC('ID'_PICTURE_FUNCTION_CONF:VCHANNEL_NUMBER),1,10)
#ELSE_IF 'ID'_PICTURE_FUNCTION_CONF:VFUNCTION_BLOCK<>"" #THEN @ADDITIONAL_IDENT= SUBSTR('ID'_PICTURE_FUNCTION_CONF:VFUNCTION_BLOCK,1,10)
#ELSE @ADDITIONAL_IDENT  = "          "
@UNIT_IDENT = SUBSTR('ID'_PICTURE_FUNCTION_CONF:VDATA_ACQUISITION_UNIT,1,10)
@XX         = 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
@YY         = 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_PURPOSE

;create needed scales, command procedures and event channels

;command procedure for updating objects from the process
@C_SEARCH = FETCH(0,"C","BGU_UPDATE")
#IF C_SEARCH:VIU == -1 #THEN #BLOCK
  #CREATE BGU_UPDATE:C = LIST(-
       IU = 1,-
       MO = 1,-
       CM = FPI_SSW:VUPDATE_COMMENT,-
       IN = ("",-
             "#DO READ_TEXT(""SAGR_BBONE/BGU_UPDATE.TXT"")"))
#BLOCK_END

;define 1:1 scale for AI object if it does not exist
@X_SEARCH=FETCH(0,"X","1_1")
#IF X_SEARCH:VIU == -1 #THEN #BLOCK
  #CREATE 1_1:X = LIST(SA = 0)
#BLOCK_END

#CASE 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE
  #WHEN "AI" #BLOCK
    ;define 1/1000 scale for ANSI-AI object if it does not exist
    @X_SEARCH = FETCH(0,"X","BGU_1_1000")
    #IF X_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BGU_1_1000:X = LIST(SA = 1, SC = (0,1000,0,1))
    #BLOCK_END
  #BLOCK_END
#CASE_END

#CASE 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE
  #WHEN "BI" #BLOCK
    ;create command procedure for BI to DB updating
    @C_SEARCH = FETCH(0,"C","BGU_BI2DB")
    #IF C_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BGU_BI2DB:C = LIST(-
            IU = 1,-
            MO = 1,-
            CM = FPI_SSW:VBI2DB_COMMENT,-
            IN = ("@INDEX = %IX-100","#IF %BI==0 #THEN #SET ''LN'':P''INDEX'' = LIST(DB=2,RT=%RT,RM=%RM,OS=%OS)","#ELSE_IF %BI==1 #THEN #SET ''LN'':P''INDEX'' = LIST(DB=1,RT=%RT,RM=%RM,OS=%OS)"))
    #BLOCK_END

    ;create event channel for BI to DB updating command procedure
    @A_SEARCH = FETCH(0,"A","BGU_BI2DB")
    #IF A_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BGU_BI2DB:A = LIST(-
          CM = FPI_SSW:VBI2DB_COMMENT,-
            OT = "C",-
            ON = "BGU_BI2DB")
    #BLOCK_END
  #BLOCK_END                                             ;binary input

  #WHEN "AI" #BLOCK
    ;create command procedure for AI to DB updating
    @C_SEARCH = FETCH(0,"C","BGU_AI2DB")
    #IF C_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BGU_AI2DB:C = LIST(-
            IU = 1,-
            MO = 1,-
            CM = FPI_SSW:VAI2DB_COMMENT,-
          IN = ("@INDEX = %IX-100","#SET ''LN'':P''INDEX'' = LIST(DB=TRUNC(%AI),RT=%RT,RM=%RM,OS=%OS)"))
    #BLOCK_END

    ;create event channel for AI to DB updating command procedure
    @A_SEARCH = FETCH(0,"A","BGU_AI2DB")
    #IF A_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BGU_AI2DB:A = LIST(-
          CM = FPI_SSW:VAI2DB_COMMENT,-
            OT = "C",-
            ON = "BGU_AI2DB")
    #BLOCK_END
  #BLOCK_END                                             ;analog input

  #WHEN "2BI" #BLOCK
    ;create event channel for 2 BIs to DB updating command procedure
    @A_SEARCH = FETCH(0,"A","BGU_2BI2DB")
    #IF A_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BGU_2BI2DB:A = LIST(-
          CM = FPI_SSW:VBI22DB_COMMENT,-
            OT = "C",-
            ON = "BGU_2BI2DB")
    #BLOCK_END
    
    ;create command procedure 1 for 2 BIs to DB updating
    @C1_SEARCH = FETCH(0,"C","BGU_2BI2DB")
    ;** TiLi 17.01.2004: Update this procedure to support DNP REF 543
    @b_Update = False
    #IF C1_SEARCH:VIU == 1 #THEN #BLOCK
       #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK
          #error ignore
          @t_Version = ""
          @t_Version = substr(BGU_2BI2DB:CCM,240,0)
          #if length(%t_Version) > 0 #then #block
             @i_Check = locate(%t_Version,"MV Process")
             #if %i_Check > 0 #then #block
                #if %t_Version < "MV Process 2.9." #then @b_Update = True
             #block_end
          #block_end
          #else @b_Update = True
       #BLOCK_END
    #BLOCK_END
        
    #IF C1_SEARCH:VIU == -1 or %b_Update #THEN #BLOCK
      #if %b_Update #then #block
         @v_CIN = BGU_2BI2DB:CIN
         @trash = write_text("pict/BGU_2BI2DB.BAK",%v_CIN)								;20.10.2011 HoDa, 
         @trash = console_output("Command procedure BGU_2BI2DB:C updated")				;@xx replaced with @trash to prevent overwriting XX var. used for RX construction
         @trash = console_output("Back up from previous in file pict/BGU_2BI2DB.BAK")   ;see line 16 and 452
         #delete BGU_2BI2DB:C
      #block_end
      ;** TiLi end
      #CREATE BGU_2BI2DB:C =LIST(-
            IU = 1,-
            MO = 1,-
            CM = FPI_SSW:VBI22DB_COMMENT,-
            IN = ("#IF %IX==110 OR %IX==111 OR %IX==130 #THEN #BLOCK",-
                  "  @IX1 = %IX",-
                  "  @IX2 = %IX-2",-
                  "#BLOCK_END",-
                  "#ELSE #BLOCK",-
                  "  @IX1 = %IX+2",-
                  "  @IX2 = %IX",-
                  "#BLOCK_END",-
                  "#IF %IX > 120 #THEN @IX_FAULTY = 126",-
                  "#ELSE_IF %IX == 110 OR %IX == 108 #THEN @IX_FAULTY = 106",-
                  "#ELSE @IX_FAULTY = 107",-
                  "#ERROR IGNORE",-
                  "@S = STATUS",-
                  "@FAULTY_STATUS = ''LN'':POS''IX_FAULTY''",-
                  "#IF (STATUS == 0) #THEN #BLOCK",-
                  "  #IF %FAULTY_STATUS < 10 #THEN #IF ''LN'':POV''IX_FAULTY'' == 1 #THEN #RETURN",-
                  "#BLOCK_END",-
                  "@OBJ1_STATUS = ''LN'':POS''IX1''",-
                  "@OBJ2_STATUS = ''LN'':POS''IX2''",-
                  "#IF %OBJ1_STATUS < 10 AND %OBJ2_STATUS < 10 #THEN #BLOCK",-
                  "  @OBJ1_VALUE = ''LN'':POV''IX1''",-
                  "  @OBJ2_VALUE = ''LN'':POV''IX2''",-
                  "  #IF %OBJ1_VALUE <> %OBJ2_VALUE #THEN #EXEC BGU_SETDB:C (@LN=%LN,@IX=%IX,@RT=%RT,@RM=%RM,@OS=%OS)",-
                  "  #ELSE #EXEC_AFTER 2 BGU_SETDB:C (@LN=%LN,@IX=%IX,@RT=%RT,@RM=%RM,@OS=%OS)",-
                  "#BLOCK_END"))
       #if %b_Update #then #block
          @t_Tmp_CM = BGU_2BI2DB:CCM
          @t_Tmp_CM = substr(%t_Tmp_CM,1,239) + "MV Process 2.9."
          #set BGU_2BI2DB:CCM = %t_Tmp_CM
       #block_end
    #BLOCK_END

    ;create command procedure 2 for 2 BIs to DB updating
    @C2_SEARCH = FETCH(0,"C","BGU_SETDB")    
    #IF C2_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BGU_SETDB:C =LIST(-
            IU = 1,-
            MO = 1,-
            CM = FPI_SSW:VBI22DB_COMMENT,-
          IN = ("@T0=PACK_TIME(YEAR,MONTH,DAY,0,0,0)",-
                  "",-
                  "#CASE %IX",-
                  "  #WHEN 110 #BLOCK",-
                  "    @IX1=%IX",-
                  "    @IX2=%IX-2",-
                  "    @IX3=10",-
                  "    @IX4=%IX-2",-
                  "  #BLOCK_END",-
                  "  #WHEN 108 #BLOCK",-
                  "    @IX1=%IX+2",-
                  "    @IX2=%IX",-
                  "    @IX3=10",-
                  "    @IX4=%IX+2",-
                  "  #BLOCK_END",-
                  "  #WHEN 111 #BLOCK",-
                  "    @IX1=%IX",-
                  "    @IX2=%IX-2",-
                  "    @IX3=11",-
                  "    @IX4=%IX-2",-
                  "  #BLOCK_END",-                 
                  "  #WHEN 109 #BLOCK",-
                  "    @IX1=%IX+2",-
                  "    @IX2=%IX",-
                  "    @IX3=11",-
                  "    @IX4=%IX+2",-
                  "  #BLOCK_END",-                 
                  "  #WHEN 130 #BLOCK",-
                  "    @IX1=%IX",-
                  "    @IX2=%IX-2",-
                  "    @IX3=30",-
                  "    @IX4=%IX-2",-
                  "  #BLOCK_END",-
                  "  #WHEN 128 #BLOCK",-
                  "    @IX1=%IX+2",-
                  "    @IX2=%IX",-
                  "    @IX3=30",-
                  "    @IX4=%IX+2",-
                  "  #BLOCK_END",-
                  "#CASE_END",-
                  "@VALUE = 2*''LN'':P''IX1''+''LN'':P''IX2''",-
                  "#IF (''LN'':PRT''IX''-%T0)+''LN'':PRM''IX''/1000 >= -",-
                  "    (''LN'':PRT''IX4''-%T0)+''LN'':PRM''IX4''/1000 -",-
                  "    #THEN #SET ''LN'':P''IX3'' = LIST(DB=ROUND(%VALUE),RT=%RT,RM=%RM,OS=%OS)"))
    #BLOCK_END
  #BLOCK_END                                             ;two binary inputs
#CASE_END                                                ;indication type

;** TiLi 07.01.2004
#IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK

   ;create event channel for updating faulty state (11) to DB 
    @A_SEARCH = FETCH(0,"A","BGU_1TO3")
    #IF A_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BGU_1TO3:A = LIST(-
            CM = FPI_SSW:VBI22DB_COMMENT,-
            OT = "C",-
            ON = "BGU_1TO3")
    #BLOCK_END

   ;create command procedure for updating faulty state (11) to DB 
    @C1_SEARCH = FETCH(0,"C","BGU_1TO3")    
    #IF C1_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BGU_1TO3:C =LIST(-
            IU = 1,-
            MO = 1,-
            CM = FPI_SSW:VBI22DB_COMMENT,-
            IN = ("@OBJ1_STATUS = ''LN'':POS''IX''",-
                  "#IF %OBJ1_STATUS < 10 #THEN #BLOCK",-
                  "  @OBJ1_VALUE = ''LN'':POV''IX''",-
                  "  #IF %IX == 107 #THEN @IND_IX = 11",-
                  "  #ELSE_IF %IX == 126 #THEN @IND_IX = 30",-
                  "  #ELSE @IND_IX = 10",-  
                  "  #IF %OBJ1_VALUE == 1 #THEN #SET ''LN'':P''IND_IX'' = LIST(DB=3,RT=%RT,RM=%RM)",-
                  "  #ELSE #EXEC_AFTER 2 BGU_2BI2DB:C (@LN=%LN,@IX=%IND_IX+100,@RT=%RT,@RM=%RM,@OS=%OBJ1_STATUS)",- 
                  "#BLOCK_END"))
    #BLOCK_END
#BLOCK_END
; TiLi END

#IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
      @v_LN_OPC_Instances = vector
      @t_OPC_Prefix = ""
      @v_CSWI_Instance(1) = ""
      @v_CILO_Instance(1) = ""
      @v_RREC_Instance(1) = ""
      @v_RSYN_Instance(1) = ""
      @v_XCBR_Instance(1) = ""
      @v_XSWI_Instance(1) = ""
      @v_LN_OPC_Instances = 'ID'_PICTURE_FUNCTION_CONF:VOPC_LN_INSTANCES
      @t_OPC_Prefix = 'ID'_PICTURE_FUNCTION_CONF:VOPC_ITEM_PREFIX
      @v_CSWI_Instance = pick(%v_LN_OPC_Instances,select(locate(%v_LN_OPC_Instances,"CSWI"),">0"))
      @v_CILO_Instance = pick(%v_LN_OPC_Instances,select(locate(%v_LN_OPC_Instances,"CILO"),">0"))
      @v_RREC_Instance = pick(%v_LN_OPC_Instances,select(locate(%v_LN_OPC_Instances,"RREC"),">0"))
      @v_RSYN_Instance = pick(%v_LN_OPC_Instances,select(locate(%v_LN_OPC_Instances,"RSYN"),">0"))
      @v_XCBR_Instance = pick(%v_LN_OPC_Instances,select(locate(%v_LN_OPC_Instances,"XCBR"),">0"))
      @v_XSWI_Instance = pick(%v_LN_OPC_Instances,select(locate(%v_LN_OPC_Instances,"XSWI"),">0"))
      #IF DATA_TYPE('ID'_PICTURE_FUNCTION_CONF:VDEFINE_ITEM_NAME) <> "NONE" #THEN - 
         @b_Fill_IN = 'ID'_PICTURE_FUNCTION_CONF:VDEFINE_ITEM_NAME
      #ELSE @b_Fill_IN = false
      #if length(%v_CSWI_Instance) == 0 #then #block
         @v_CSWI_Instance = pick(%v_LN_OPC_Instances,select(locate(%v_LN_OPC_Instances,"XSWI"),">0"))
         #if length(%v_CSWI_Instance) == 0 #then @v_CSWI_Instance(1) = ""
      #block_end
      #if length(%v_CILO_Instance) == 0 #then @v_CILO_Instance(1) = ""
      #if length(%v_RREC_Instance) == 0 #then @v_RREC_Instance(1) = ""
      #if length(%v_RSYN_Instance) == 0 #then @v_RSYN_Instance(1) = ""
#BLOCK_END
@IN(1..10) = ""

;switching device type
#CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE

  ;=====================================================================================================;
  ;circuit breaker, disconnector and earth switch                                                       ;
  ;=====================================================================================================;
  #WHEN "QB","QS","QI","QD","QF","QL","QE","QM" #BLOCK

    ;initialize variables
    @DX
    @OX
    @HE
    @PF
    @RI
    @RX
    @LD
    @P_OBJ01
    @P_OBJ02
    @P_OBJ03
    @P_OBJ04
    @P_OBJ05
    @P_OBJ06
    @P_OBJ07
    @P_OBJ08
    @P_OBJ09
    @P_OBJ10
    @P_OBJ11
    @P_OBJ12
    @P_OBJ13
    @P_OBJ14
    @P_OBJ15
    @P_OBJ16
    @P_OBJ17
    @P_OBJ18
    @P_OBJ19
    @P_OBJ20
    @P_OBJ21
    @P_OBJ22
    @P_OBJ23
    @P_OBJ49              ;HoDa 16.11.2008 added for Tagout repr/symbol handling
    @P_OBJ50              ;HoDa 16.11.2008 added for Tagout event/log handling 
    @P_OBJECTS = LIST()


    ;define object to be created

    ;double binary indication
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
      #WHEN "SPA" #BLOCK
        @DX(1)    ="N7D"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "LON","LONMARK" #BLOCK
        @DX(1)    ="X7D"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "IEC101","IEC103", "ICCP" #BLOCK
        @DX(1)    ="C12"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "ANSI" #BLOCK
        @DX(1)    ="12"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "PROC" #BLOCK
        @DX(1)    ="12"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "RTU" #BLOCK
        #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
          @DX(1)  ="I7D"
          @HE(1)  = 0                                    ;history enable = no
          @PF(1)  = "DUMMY"                              ;physical format for printout
          @LD(1)  = 0                                    ;listing device = none
        #BLOCK_END

        #ELSE #BLOCK
          @DX(1)  ="I7D"
          @HE(1)  = 1                                    ;history enable = yes
          @PF(1)  = "FORM5SAGR1"                         ;physical format for printout
          @LD(1)  = BIT_MASK(1)                          ;listing device = 1
        #BLOCK_END
      #BLOCK_END

      #WHEN "RTU_E" #BLOCK
        #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
          @DX(1)  ="R7D"
          @HE(1)  = 0                                    ;history enable = no
          @PF(1)  = "DUMMY"                              ;physical format for printout
          @LD(1)  = 0                                    ;listing device = none
        #BLOCK_END

        #ELSE #BLOCK
          @DX(1)  ="R7D"
          @HE(1)  = 1                                    ;history enable = yes
          @PF(1)  = "FORM5SAGR1"                         ;physical format for printout
          @LD(1)  = BIT_MASK(1)                          ;listing device = 1
        #BLOCK_END
      #BLOCK_END

      #WHEN "DNP_30" #BLOCK
        #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
           @DX(1)    ="D12"
           @HE(1)    = 0                                 ;history enable = no
           @PF(1)    = "DUMMY"                           ;physical format for printout
           @LD(1)    = 0                                 ;listing device = 1
        #BLOCK_END

        #ELSE #BLOCK
           @DX(1)    ="D12"
           @HE(1)    = 1                                 ;history enable = yes
           @PF(1)    = "FORM5SAGR1"                      ;physical format for printout
           @LD(1)    = BIT_MASK(1)                       ;listing device = 1
        #BLOCK_END
      #BLOCK_END

      #WHEN "MODBUS_RTU" #BLOCK
        @DX(1)  ="I7D"
        @HE(1)  = 1                                      ;history enable = yes
        @PF(1)  = "FORM5SAGR1"                           ;physical format for printout
        @LD(1)  = BIT_MASK(1)                            ;listing device = 1
      #BLOCK_END

      #WHEN "IEC61850" #BLOCK
        @DX(1)  ="E7D"
        @HE(1)  = 1                                      ;history enable = yes
        @PF(1)  = "FORM5SAGR1"                           ;physical format for printout
        @LD(1)  = BIT_MASK(1)                            ;listing device = 1
      #BLOCK_END

    #CASE_END
  
    @t_Sta_Type = 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE

    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
      #WHEN "QB","QS","QI" #BLOCK                        ;circuit breaker
        @OX(1)=FPI_SSW:VCB_POS_IND                       ;signal text for position indication
        #if %t_Sta_Type <> "IEC61850" #then @RI(1)=3     ;dynamic text for position indication printout
        #else @RI(1)=17
        @DB  =1                   ;defalt position closed
      #BLOCK_END
      #WHEN "QD","QF","QL" #BLOCK                        ;disconnector
        @OX(1)=FPI_SSW:VDC_POS_IND                       ;signal text position indication
        #if %t_Sta_Type <> "IEC61850" #then @RI(1)=4     ;dynamic text for position indication printout
        #else @RI(1)=18
        @DB  =1                   ;defalt position closed
      #BLOCK_END
      #WHEN "QE","QM" #BLOCK                             ;earth switch
        @OX(1)=FPI_SSW:VES_POS_IND                       ;signal text position indication
        #if %t_Sta_Type <> "IEC61850" #then @RI(1)=5     ;dynamic text for position indication printout
        #else @RI(1)=19
        @DB  =2                   ;defalt position open
      #BLOCK_END
    #CASE_END

    @RX(1) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -            ;function block or channel number, data acquisition unit
             "FP'XX''YY'IPOS"                            ;and group information
   #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
      @RX(1) = SUBSTR(%RX(1),1,35) + "CSWI.Pos.stVal"
      #IF %b_Fill_IN #THEN @IN(1) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Pos.stVal"
      #ELSE @IN(1) = ""
   #BLOCK_END
   #ELSE @IN(1) = ""

   #MODIFY P_OBJECTS:V = LIST(P_OBJ01 = LIST(-
          IX = 10,-                                      ;index = 10
          PT = 12,-                                      ;process object type = DB
          DX = %DX(1),-                                  ;directive text
          DB = %DB,-                                     ;object value = 1
          NV = 4,-                                       ;normal value = none
          OI = %OBJ_IDENT,-                              ;substation & bay name
          OX = %OX(1),-                                  ;object text
          IU = 1,-                                       ;in use = yes
          SS = 1,-                                       ;switch state = manual
          EE = 1,-                                       ;event enable = yes
          HE = %HE(1),-                                  ;history enable
          HA = 1,-                                       ;history activation = new value
          HF = 0,-                                       ;history at first update = no
          HL = BIT_MASK(15),-                            ;history log number = 15
          RC = 1,-                                       ;receipt = acknowledgement required
          AB = 0,-                                       ;alarm blocking = no
          AC = 1,-                                       ;alarm class = 1
          LA = 9,-                                       ;alarm activation = intermediate & faulty alarming
          AD = 0,-                                       ;alarm delay = 0
          PD = 0,-                                       ;picture device = none
          PI = "",-                                      ;alarm picture
          PF = %PF(1),-                                  ;physical format for printout
          RI = %RI(1),-                                  ;dynamic texts for printout
          PA = 1,-                                       ;printout activation = new value
          PU = 0,-                                       ;picture/ printout at first update = no
          LD = %LD(1),-                                  ;listing device
          IN = %IN(1),-                                  ;IEC 61850 instance name
          RX = %RX(1)))                                  ;data acquisition unit and group information

    ;if motorized switching device                           
    #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

      ;control objects
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VCONTROL_TYPE

        #WHEN "SEC-5AO" #BLOCK

          ;output objects for control commands (open/close/execute open/execute close/cancel)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(2..6) ="N4"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..6) ="X4"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..6) ="C11"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..6) ="11"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..6) ="O5"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..6) ="I4"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..6) ="R4"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
               @DX(2..6) ="D11"
               #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..205)="D9T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
               @DX(2..6) ="I4"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
               @DX(2..6) ="E4"
            #BLOCK_END

      #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(2)=FPI_SSW:VCB_OPEN_SEL                ;signal text for open select
              @OX(3)=FPI_SSW:VCB_CLOSE_SEL               ;signal text for close select
              @OX(4)=FPI_SSW:VCB_OPEN_EXEC               ;signal text for execute
              @OX(5)=FPI_SSW:VCB_CLOSE_EXEC              ;signal text for execute
              @OX(6)=FPI_SSW:VCB_CANCEL_CMD              ;signal text for cancel
              @RI(2)=12                                  ;dynamic text for open select printout
              @RI(3)=12                                  ;dynamic text for close select printout
              @RI(4)=13                                  ;dynamic text for execute printout
              @RI(5)=13                                  ;dynamic text for execute printout
              @RI(6)=14                                  ;dynamic text for cancel printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(2)=FPI_SSW:VDC_OPEN_SEL                ;signal text for open select
              @OX(3)=FPI_SSW:VDC_CLOSE_SEL               ;signal text for close select
              @OX(4)=FPI_SSW:VDC_OPEN_EXEC               ;signal text for execute
              @OX(5)=FPI_SSW:VDC_CLOSE_EXEC              ;signal text for execute
              @OX(6)=FPI_SSW:VDC_CANCEL_CMD              ;signal text for cancel
              @RI(2)=15                                  ;dynamic text for open select printout
              @RI(3)=15                                  ;dynamic text for close select printout
              @RI(4)=16                                  ;dynamic text for execute printout
              @RI(5)=16                                  ;dynamic text for execute printout
              @RI(6)=17                                  ;dynamic text for cancel printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(2)=FPI_SSW:VES_OPEN_SEL                ;signal text for open select
              @OX(3)=FPI_SSW:VES_CLOSE_SEL               ;signal text for close select
              @OX(4)=FPI_SSW:VES_OPEN_EXEC               ;signal text for execute
              @OX(5)=FPI_SSW:VES_CLOSE_EXEC              ;signal text for execute
              @OX(6)=FPI_SSW:VES_CANCEL_CMD              ;signal text for cancel
              @RI(2)=18                                  ;dynamic text for open select printout
              @RI(3)=18                                  ;dynamic text for close select printout
              @RI(4)=19                                  ;dynamic text for execute printout
              @RI(5)=19                                  ;dynamic text for execute printout
              @RI(6)=17                                  ;dynamic text for cancel printout
            #BLOCK_END
          #CASE_END

          @RX(2..6) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          @v_61850_Ident = ("CSWI.Pos.ctlSelOff", "CSWI.Pos.ctlSelOn", "CSWI.Pos.ctlOperOff", "CSWI.Pos.ctlOperOn", "CSWI.Pos.ctlCan")

          #LOOP_WITH I=2..6
            #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
              @RX(%i) = SUBSTR(%RX(%i),1,35) + %v_61850_Ident(%i-1)
              @IN(2..6) = ""
              #IF %b_Fill_IN #THEN @IN(%i) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + substr(%v_61850_Ident(%i-1), 5 , 0)
            #BLOCK_END
            #if %i == 6 #then #block
               @i_tmp_count = %i + 100
               @i_Tmp_IX = 16
            #block_end
            #else #block
               @i_tmp_count = %i
               @i_Tmp_IX = %i
            #block_end                
                  
             @P_OBJ0'i_tmp_count'_LIST = LIST(-
                IX = 9+%i_Tmp_IX,-                       ;index = 13
                PT = 11,-                                ;process object type = AO
                DX = %DX(%I),-                           ;directive text
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(%I),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                HO = 0,-                                 ;high alarm limit = 0
                LO = 0,-                                 ;low alarm limit = 0
                ST = "Command",-                         ;unit of value
                SN = "1_1",-                             ;scale name
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(%I),-                           ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device = 1
                IN = %IN(%I),-                           ;IEC 61850 instance name
                RX = %RX(%I))                            ;data acquisition unit and group information
    
            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
 
              @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                              ;data acquisition unit and group information

                  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END               
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'i_tmp_count'=%P_OBJ0'i_tmp_count'_LIST)
          #LOOP_END
        #BLOCK_END

        ;secured control with four binary outputs
        #WHEN "SEC-5BO" #BLOCK

          ;output objects for control commands (open/close/execute open/execute close/cancel)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(2..6) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..6) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..6) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..6) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..6) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..6) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..6) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
               @DX(2..6) ="D5"
               #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..205)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
               @DX(2..6) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
               @DX(2..6) ="E1"
            #BLOCK_END

      #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(2)=FPI_SSW:VCB_OPEN_SEL                ;signal text for open select
              @OX(3)=FPI_SSW:VCB_CLOSE_SEL               ;signal text for close select
              @OX(4)=FPI_SSW:VCB_OPEN_EXEC               ;signal text for execute
              @OX(5)=FPI_SSW:VCB_CLOSE_EXEC              ;signal text for execute
              @OX(6)=FPI_SSW:VCB_CANCEL_CMD              ;signal text for cancel
              @RI(2)=4                                   ;dynamic text for open select printout
              @RI(3)=5                                   ;dynamic text for close select printout
              @RI(4)=6                                   ;dynamic text for execute printout
              @RI(5)=6                                   ;dynamic text for execute printout
              @RI(6)=7                                   ;dynamic text for cancel printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(2)=FPI_SSW:VDC_OPEN_SEL                ;signal text for open select
              @OX(3)=FPI_SSW:VDC_CLOSE_SEL               ;signal text for close select
              @OX(4)=FPI_SSW:VDC_OPEN_EXEC               ;signal text for execute
              @OX(5)=FPI_SSW:VDC_CLOSE_EXEC              ;signal text for execute
              @OX(6)=FPI_SSW:VDC_CANCEL_CMD              ;signal text for cancel
              @RI(2)=11                                  ;dynamic text for open select printout
              @RI(3)=12                                  ;dynamic text for close select printout
              @RI(4)=13                                  ;dynamic text for execute printout
              @RI(5)=13                                  ;dynamic text for execute printout
              @RI(6)=14                                  ;dynamic text for cancel printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(2)=FPI_SSW:VES_OPEN_SEL                ;signal text for open select
              @OX(3)=FPI_SSW:VES_CLOSE_SEL               ;signal text for close select
              @OX(4)=FPI_SSW:VES_OPEN_EXEC               ;signal text for execute
              @OX(5)=FPI_SSW:VES_CLOSE_EXEC              ;signal text for execute
              @OX(6)=FPI_SSW:VES_CANCEL_CMD              ;signal text for cancel
              @RI(2)=18                                  ;dynamic text for open select printout
              @RI(3)=19                                  ;dynamic text for close select printout
              @RI(4)=20                                  ;dynamic text for execute printout
              @RI(5)=20                                  ;dynamic text for execute printout
              @RI(6)=21                                  ;dynamic text for cancel printout
            #BLOCK_END
          #CASE_END

          @RX(2..6) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          @v_61850_Ident = ("CSWI.Pos.ctlSelOff", "CSWI.Pos.ctlSelOn", "CSWI.Pos.ctlOperOff", "CSWI.Pos.ctlOperOn", "CSWI.Pos.ctlCan")

          #LOOP_WITH I=2..6
            #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
             @RX(%i) = SUBSTR(%RX(%i),1,35) + %v_61850_Ident(%i-1)
               @IN(2..6) = ""
               #IF %b_Fill_IN #THEN @IN(%i) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + substr(%v_61850_Ident(%i-1), 5 , 0)
            #BLOCK_END
            #if %i == 6 #then #block
               @i_tmp_count = %i + 100
               @i_Tmp_IX = 16
            #block_end
            #else #block
               @i_tmp_count = %i
               @i_Tmp_IX = %i
            #block_end
            @P_OBJ0'i_tmp_count'_LIST = LIST(-
                  IX = 9+%i_Tmp_IX,-                     ;index = 11,12,13,14,25
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  IN = %IN(%I),-
                  RX = %RX('I'))                         ;data acquisition unit and group information
    
            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
 
              @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                              ;data acquisition unit and group information

                  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END               
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'i_tmp_count'=%P_OBJ0'i_tmp_count'_LIST)
          #LOOP_END
        #BLOCK_END


        ;secured control with four binary outputs
        #WHEN "SEC-4BO" #BLOCK

          ;output objects for control commands (open/close/execute/cancel)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(2..5) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..5) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..5) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..5) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..5) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..5) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..5) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
               @DX(2..5) ="D5"
               #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..205)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
               @DX(2..5) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
               @DX(2..5) ="E1"
            #BLOCK_END

      #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(2)=FPI_SSW:VCB_OPEN_SEL                ;signal text for open select
              @OX(3)=FPI_SSW:VCB_CLOSE_SEL               ;signal text for close select
              @OX(4)=FPI_SSW:VCB_EXEC_CMD                ;signal text for execute
              @OX(5)=FPI_SSW:VCB_CANCEL_CMD              ;signal text for cancel
              @RI(2)=4                                   ;dynamic text for open select printout
              @RI(3)=5                                   ;dynamic text for close select printout
              @RI(4)=6                                   ;dynamic text for execute printout
              @RI(5)=7                                   ;dynamic text for cancel printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(2)=FPI_SSW:VDC_OPEN_SEL                ;signal text for open select
              @OX(3)=FPI_SSW:VDC_CLOSE_SEL               ;signal text for close select
              @OX(4)=FPI_SSW:VDC_EXEC_CMD                ;signal text for execute
              @OX(5)=FPI_SSW:VDC_CANCEL_CMD              ;signal text for cancel
              @RI(2)=11                                  ;dynamic text for open select printout
              @RI(3)=12                                  ;dynamic text for close select printout
              @RI(4)=13                                  ;dynamic text for execute printout
              @RI(5)=14                                  ;dynamic text for cancel printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(2)=FPI_SSW:VES_OPEN_SEL                ;signal text for open select
              @OX(3)=FPI_SSW:VES_CLOSE_SEL               ;signal text for close select
              @OX(4)=FPI_SSW:VES_EXEC_CMD                ;signal text for execute
              @OX(5)=FPI_SSW:VES_CANCEL_CMD              ;signal text for cancel
              @RI(2)=18                                  ;dynamic text for open select printout
              @RI(3)=19                                  ;dynamic text for close select printout
              @RI(4)=20                                  ;dynamic text for execute printout
              @RI(5)=21                                  ;dynamic text for cancel printout
            #BLOCK_END
          #CASE_END

          @RX(2..5) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=2..5
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 9+%I,-                            ;index = 11,12,13,14
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information
    
            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
 
              @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information

                  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END               
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 4 x binary outputs

        ;secured control with two binary outputs
        #WHEN "SEC-2BO" #BLOCK

          ;output objects for control commands (open execute/close execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(2..3) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..3) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..3) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..3) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..3) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..3) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..3) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
               @DX(2..3) ="D5"
               #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..205)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
               @DX(2..3) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
               @DX(2..3) ="E1"
            #BLOCK_END

          #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(2)=FPI_SSW:VCB_OPEN_EXEC               ;signal text for open execute
              @OX(3)=FPI_SSW:VCB_CLOSE_EXEC              ;signal text for close execute
              #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK
                 @RI(2..3)=8                             ;dynamic text for open/close execute printout
              #BLOCK_END                                 
              #ELSE #BLOCK
                @RI(2)=9                                 ;dynamic text for open execute printout
                @RI(3)=10                                ;dynamic text for close execute printout
              #BLOCK_END
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(2)=FPI_SSW:VDC_OPEN_EXEC               ;signal text for open execute
              @OX(3)=FPI_SSW:VDC_CLOSE_EXEC              ;signal text for close execute
              #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK
                 @RI(2..3)=15                            ;dynamic text for open/close execute printout
              #BLOCK_END                                 
              #ELSE #BLOCK
                @RI(2)=16                                ;dynamic text for open execute printout
                @RI(3)=17                                ;dynamic text for close execute printout
              #BLOCK_END
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(2)=FPI_SSW:VES_OPEN_EXEC               ;signal text for open execute
              @OX(3)=FPI_SSW:VES_CLOSE_EXEC              ;signal text for close execute
              @RI(2)=23                                  ;dynamic text for open execute printout
              @RI(3)=24                                  ;dynamic text for close execute printout
              #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK
                 @RI(2..3)=22                             ;dynamic text for open/close execute printout
              #BLOCK_END                                 
              #ELSE #BLOCK
                @RI(2)=23                                ;dynamic text for open execute printout
                @RI(3)=24                                ;dynamic text for close execute printout
              #BLOCK_END
            #BLOCK_END
          #CASE_END

          @RX(2..3) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=2..3
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 9+%I,-                            ;index = 11,12
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
              @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information
             #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 2 x binary outputs

        ;secured control with two digital outputs
        #WHEN "SEC-2DO" #BLOCK

          ;output objects for control commands (open execute/close execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK   
              @DX(2..3) ="N3"      
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..3) ="X3"      
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..3) ="C7"      
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..3) ="7"      
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..3) ="O7"      
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..3) ="I3"         
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..3) ="R3"      
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK   
              @DX(2..3) ="I3"      
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK   
              @DX(2..3) ="E3"      
            #BLOCK_END
          #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(2)=FPI_SSW:VCB_OPEN_EXEC               ;signal text for open execute
              @OX(3)=FPI_SSW:VCB_CLOSE_EXEC              ;signal text for close execute
              @RI(2)=1                                   ;dynamic text for open execute printout
              @RI(3)=2                                   ;dynamic text for close execute printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(2)=FPI_SSW:VDC_OPEN_EXEC               ;signal text for open execute
              @OX(3)=FPI_SSW:VDC_CLOSE_EXEC              ;signal text for close execute
              @RI(2)=3                                   ;dynamic text for open execute printout
              @RI(3)=4                                   ;dynamic text for close execute printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(2)=FPI_SSW:VES_OPEN_EXEC               ;signal text for open execute
              @OX(3)=FPI_SSW:VES_CLOSE_EXEC              ;signal text for close execute
              @RI(2)=5                                   ;dynamic text for open execute printout
              @RI(3)=6                                   ;dynamic text for close execute printout
            #BLOCK_END
          #CASE_END

          @RX(2..3) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=2..3
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 9+%I,-                            ;index = 11,12
                  PT = 7,-                               ;process object type = DO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 50)                               ;type identification (ASDU) 50 = set point command, short floating point
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 2 x digital outputs

        ;secured control with a single binary output
        #WHEN "SEC-BO" #BLOCK

          ;output object for control commands (select & execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(4)    ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(4)    ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(4)    ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(4)    ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(4)    ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(4)    ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(4)    ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(4)    ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(204)="D3T"         
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(4)    ="I1"               
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(4)    ="E1"               
            #BLOCK_END
          #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(4)=FPI_SSW:VCB_OBJ_CMD                 ;signal text for control object
              @RI(4)=8                                   ;dynamic text for control object printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(4)=FPI_SSW:VDC_OBJ_CMD                 ;signal text for control object
              @RI(4)=15                                  ;dynamic text for control object printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(4)=FPI_SSW:VES_OBJ_CMD                 ;signal text for control object
              @RI(4)=22                                  ;dynamic text for control object printout
            #BLOCK_END
          #CASE_END

          @RX(4) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -      ;function block or channel number, data acquisition unit
                   "FP'XX''YY'COBC"                      ;and group information

          @P_OBJ04_LIST = LIST(-
                IX = 13,-                                ;index = 13
                PT = 5,-                                 ;process object type = BO
                DX = %DX(4),-                             ;directive text
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(4),-                            ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(4),-                            ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device = 1
                RX = %RX(4))                             ;data acquisition unit and group information

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "IEC101", "ICCP" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 'ID'_PICTURE_FUNCTION_CONF:VCMD_PARAMETER) ;type identification (ASDU) 45 = single command, 46 = double command
            #WHEN "IEC103" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 0)                               ;type identification (ASDU) 20 = general command
            #WHEN "DNP_30" #BLOCK

                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK

              @TMP_INDEX = 204
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 213,-                                 ;index = 111,112,113,114
              PT = 3,-                                   ;process object type = AI
              DX = "D3T",-                               ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(4),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(4))                             ;data acquisition unit and group information
             #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST) 

                #BLOCK_END
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ04=%P_OBJ04_LIST)
        #BLOCK_END                                       ;secured control/ a single binary output

        ;direct control with a single binary output
        #WHEN "DIR-BO" #BLOCK

          ;output object for control commands (open & close)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(4)    ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(4)    ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(4)    ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(4)    ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(4)    ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(4)    ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(4)    ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(4)    ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(104)="D3T"
            #BLOCK_END
   
            #WHEN "MODBUS_RTU" #BLOCK
              @DX(4)    ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(4)    ="E1"
            #BLOCK_END

          #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(4)=FPI_SSW:VCB_OBJ_CMD                 ;signal text for control object
              @RI(4)=8                                   ;dynamic text for control object printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(4)=FPI_SSW:VDC_OBJ_CMD                 ;signal text for control object
              @RI(4)=15                                  ;dynamic text for control object printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(4)=FPI_SSW:VES_OBJ_CMD                 ;signal text for control object
              @RI(4)=22                                  ;dynamic text for control object printout
            #BLOCK_END
          #CASE_END

          @RX(4) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -      ;function block or channel number, data acquisition unit
                   "FP'XX''YY'COBC"                      ;and group information

          @P_OBJ04_LIST = LIST(-
                IX = 13,-                                ;index = 13
                PT = 5,-                                 ;process object type = BO
                DX = %DX(4),-                            ;directive text
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(4),-                            ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(4),-                            ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device = 1
                RX = %RX(4))                             ;data acquisition unit and group information

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "IEC101", "ICCP" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 45)                                 ;type identification (ASDU) 45 = single command, 46 = double command
            #WHEN "IEC103" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 0)                                 ;type identification (ASDU) 20 = general command
            #WHEN "DNP_30" #BLOCK
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
                 @TMP_INDEX = 204
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 213,-                                 ;index = 111,112,113,114
              PT = 3,-                                   ;process object type = AI
              DX = "D3T",-                               ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(4),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(4))                             ;data acquisition unit and group information
             #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ04=%P_OBJ04_LIST)
        #BLOCK_END                                       ;direct control/ a single binary output

        ;control with a single analog output
        #WHEN "AO" #BLOCK

          ;output object for control commands (select open/close and execute/cancel or open/close execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(4)    ="N4"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(4)    ="X4"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(4)    ="C11"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(4)    ="11"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(4)    ="O5"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(4)    ="I4"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(4)    ="R4"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(4)    ="D11"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(4)    ="I4"
            #BLOCK_END            

            #WHEN "IEC61850" #BLOCK
              @DX(4)    ="E4"
            #BLOCK_END
          #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(4)=FPI_SSW:VCB_OBJ_CMD                 ;signal text for control object
              @RI(4)=1                                   ;dynamic text for control object printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(4)=FPI_SSW:VDC_OBJ_CMD                 ;signal text for control object
              @RI(4)=2                                   ;dynamic text for control object printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(4)=FPI_SSW:VES_OBJ_CMD                 ;signal text for control object
              @RI(4)=3                                   ;dynamic text for control object printout
            #BLOCK_END
          #CASE_END

          @RX(4) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -      ;function block or channel number, data acquisition unit
                   "FP'XX''YY'COBC"                      ;and group information

          @P_OBJ04_LIST = LIST(-
                IX = 13,-                                ;index = 13
                PT = 11,-                                ;process object type = AO
                DX = %DX(4),-                            ;directive text
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(4),-                            ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                HO = 0,-                                 ;high alarm limit = 0
                LO = 0,-                                 ;low alarm limit = 0
                ST = "Command",-                         ;unit of value
                SN = "1_1",-                             ;scale name
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(4),-                            ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device = 1
                RX = %RX(4))                             ;data acquisition unit and group information

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "IEC101", "ICCP" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 50)                                 ;type identification (ASDU) 48 = set point cmd, normalized value, 49 = set point cmd, scaled valueed value, 50 = set point cmd, short floating point number
            #WHEN "IEC103" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 0)                                 ;type identification (ASDU) 20 = general command
          #CASE_END
          #MODIFY P_OBJECTS:V = LIST(P_OBJ04=%P_OBJ04_LIST)
        #BLOCK_END                                       ;control/ a single analog output
      #CASE_END                                          ;control type

      ;input objects for external control blocking and open/close interlocking
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(6..8)   ="N7S"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(6..8)   ="X7S"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(6..8)   ="C3"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(6..8)   ="3"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(6..8)   ="O1"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(6..8) ="I7S" 
            @HE(6..8) = 0                                ;history enable = no
            @PF(6..8) = "DUMMY"                          ;physical format for printout
            @LD(6..8) = 0                                ;listing device = none
          #BLOCK_END

          #ELSE #BLOCK
            @DX(6..8) ="I7S" 
            @HE(6..8) = 1                                ;history enable = yes
            @PF(6..8) = "FORM5SAGR1"                     ;physical format for printout
            @LD(6..8) = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(6..8) ="R7S"
            @HE(6..8) = 0                                ;history enable = no
            @PF(6..8) = "DUMMY"                          ;physical format for printout
            @LD(6..8) = 0                                ;listing device = none
          #BLOCK_END

          #ELSE #BLOCK
            @DX(6..8) ="R7S"
            @HE(6..8) = 1                                ;history enable = yes
            @PF(6..8) = "FORM5SAGR1"                     ;physical format for printout
            @LD(6..8) = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
            #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
               @DX(6..8) ="D3" 
               @HE(6..8) = 0                             ;history enable = no
               @PF(6..8) = "DUMMY"                       ;physical format for printout
               @LD(6..8) = 0                             ;listing device = 1
            #BLOCK_END
            
            #ELSE #BLOCK
               @DX(6..8) ="D3" 
               @HE(6..8) = 1                             ;history enable = yes
               @PF(6..8) = "FORM5SAGR1"                  ;physical format for printout
               @LD(6..8) = BIT_MASK(1)                   ;listing device = 1
            #BLOCK_END
          #BLOCK_END

         #WHEN "MODBUS_RTU" #BLOCK
            @DX(6..8) ="I7S" 
            @HE(6..8) = 1                                ;history enable = yes
            @PF(6..8) = "FORM5SAGR1"                     ;physical format for printout
            @LD(6..8) = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(6)      = "E6"
            @DX(7..8)   = "E7S"
            @HE(6..8)   = 1                                ;history enable = yes
            @PF(6)      = "FORM5SAGR1"                     ;physical format for printout
            @PF(7..8)   = "FORM5SAGR1"                     ;physical format for printout
            @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END
      #CASE_END                     

      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
        #WHEN "QB","QS","QI" #BLOCK                      ;circuit breaker
          @OX(6)=FPI_SSW:VCB_EXT_CNTR_BLK                ;signal text for external interlocking
          @OX(7)=FPI_SSW:VCB_OPEN_ILOCKED                ;signal text for open interlocked
          @OX(8)=FPI_SSW:VCB_CLOSE_ILOCKED               ;signal text for close interlocked
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
             @RI(6)=3
             @RI(7..8)=43
          #BLOCK_END
          #ELSE @RI(6..8)=3                             ;dynamic text for object printout
        #BLOCK_END
        #WHEN "QD","QF","QL" #BLOCK                      ;disconnector
          @OX(6)=FPI_SSW:VDC_EXT_CNTR_BLK                ;signal text for external interlocking
          @OX(7)=FPI_SSW:VDC_OPEN_ILOCKED                ;signal text for open interlocked
          @OX(8)=FPI_SSW:VDC_CLOSE_ILOCKED               ;signal text for close interlocked
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
             @RI(6)=3
             @RI(7..8)=43
          #BLOCK_END
          #ELSE @RI(6..8)=8                                    ;dynamic text for object printout
        #BLOCK_END
        #WHEN "QE","QM" #BLOCK                           ;earth switch
          @OX(6)=FPI_SSW:VES_EXT_CNTR_BLK                ;signal text for external interlocking
          @OX(7)=FPI_SSW:VES_OPEN_ILOCKED                ;signal text for open interlocked
          @OX(8)=FPI_SSW:VES_CLOSE_ILOCKED               ;signal text for close interlocked
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
             @RI(6)=3
             @RI(7..8)=43
          #BLOCK_END
          #ELSE @RI(6..8)=13                                   ;dynamic text for object printouT
        #BLOCK_END
      #CASE_END

      @RX(6)    = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'IBLK"                       ;and group information
      @RX(7..8) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'IINH"                       ;and group information

      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
       
        @RX(6) = SUBSTR(%RX(6),1,35) + "CSWI.Beh.stVal"
 ;       #IF %b_Fill_IN AND (LENGTH(%v_XCBR_Instance) == 0 AND length(%v_XSWI_Instance) == 0) #THEN @IN(1) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Beh.stVal"
        #IF %b_Fill_IN #THEN @IN(1) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Beh.stVal"
        #ELSE @IN(1) = ""

        #MODIFY P_OBJECTS:V = LIST(P_OBJ06 = LIST(-
          IX = 15,-                                      ;index = 15
          PT = 9,-                                       ;process object type = AI
          DX = %DX(6),-                                  ;directive text
          AI = 1,-                                       ;object value = 0
          OI = %OBJ_IDENT,-                              ;substation & bay name
          OX = %OX(6),-                                  ;object text
          IU = 1,-                                       ;in use = yes
          SS = 1,-                                       ;switch state = auto
          EE = 1,-                                       ;event enable = yes
          HE = 1,-                                       ;history enable = no
          HA = 1,-                                       ;history activation = update
          HF = 0,-                                       ;history at first update = yes
          HL = BIT_MASK(15),-                            ;history log number = 15
          HI = 0,-                                       ;upper alarm limit = 0
          HW = 0,-                                       ;upper warning limit = 0
          LW = 0,-                                       ;lower warning limit = 0
          LI = 0,-                                       ;lower alarm limit = 0
          ST = "Blocking",-                              ;unit of value
          SN = "1_1",-                                   ;scale name
          SZ = 1,-                                       ;zone supervision = SCADA
          RC = 0,-                                       ;receipt = acknowledgement not required
          AB = 0,-                                       ;alarm blocking = no
          AC = 0,-                                       ;alarm class = disabled
          AD = 0,-                                       ;alarm delay = 0
          PD = 0,-                                       ;picture device = none
          PI = "",-                                      ;alarm picture
          PF = %PF(6),-                                  ;physical format for printout
          RI = 16,-                                      ;dynamic texts for printout
          PA = 1,-                                       ;printout activation = update
          PU = 0,-                                       ;picture/ printout at first update = yes
          LD = 0,-                                       ;listing device = none
          IN = %IN(1),-                                  ;
          RX = %RX(6)))                                  ;group information

      #BLOCK_END

      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
         @I_LOOP_START = 7
         @RX(7) = SUBSTR(%RX(7),1,35) + "CILO.EnaOpn.stVal"
         @RX(8) = SUBSTR(%RX(8),1,35) + "CILO.EnaCls.stVal"
         #IF %b_Fill_IN AND %v_CILO_Instance(1) <> "" #THEN #BLOCK
            @IN(7) = %t_OPC_Prefix + "." + %v_CILO_Instance(1) + ".EnaOpn.stVal"
            @IN(8) = %t_OPC_Prefix + "." + %v_CILO_Instance(1) + ".EnaCls.stVal"
         #BLOCK_END
         #ELSE @IN(7..8) = ""
         @i_Default_OV = 1
      #BLOCK_END
      #ELSE #BLOCK
         @I_LOOP_START = 6
         @i_Default_OV = 0
         @IN(7..8) = ""
      #BLOCK_END
      
      #LOOP_WITH I=%I_LOOP_START..8
        #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I' = LIST(-
              IX = 9+%I,-                                ;index = 15,16,17
              PT = 3,-                                   ;process object type = BI
              DX = %DX('I'),-                            ;directive text
              BI = %i_Default_OV,-                       ;object value
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX('I'),-                            ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = %HE('I'),-                            ;history enable
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 1,-                                   ;receipt = acknowledgement required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class 
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = %PF('I'),-                            ;physical format for printout
              RI = %RI('I'),-                            ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = %LD('I'),-                            ;listing device
              IN = %IN(%I),-
              RX = %RX('I')))                            ;group information
      #LOOP_END

      ;external interlocking cause
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(9)   ="N6"
        #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(9)   ="X6"
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(9)   ="C9"
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(9)   ="9"
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(9)   ="O2"
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          @DX(9)   ="I6"
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          @DX(9)   ="R6"
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
          @DX(9)   ="D9"
        #BLOCK_END

        #WHEN "MODBUS_RTU" #BLOCK
          @DX(9)   ="I6"
        #BLOCK_END

        #WHEN "IEC61850" #BLOCK
          @DX(9)   ="E6"
        #BLOCK_END

      #CASE_END

      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
        #WHEN "QB","QS","QI" #BLOCK                      ;circuit breaker
          @OX(9)=FPI_SSW:VCB_ILOCK_CAUSE                 ;signal text for interlocking cause
        #BLOCK_END
        #WHEN "QD","QF","QL" #BLOCK                      ;disconnector
          @OX(9)=FPI_SSW:VDC_ILOCK_CAUSE                 ;signal text for interlocking cause
        #BLOCK_END
        #WHEN "QE","QM" #BLOCK                           ;earth switch
          @OX(9)=FPI_SSW:VES_ILOCK_CAUSE                 ;signal text for interlocking cause
        #BLOCK_END
      #CASE_END

      @RX(9) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -          ;function block or channel number, data acquisition unit
               "FP'XX''YY'IINH"                          ;and group information

      #MODIFY P_OBJECTS:V = LIST(P_OBJ09 = LIST(-
            IX = 18,-                                    ;index = 18
            PT = 9,-                                     ;process object type = AI
            DX = %DX(9),-                                ;directive text
            AI = 0,-                                     ;object value = 0
            OI = %OBJ_IDENT,-                            ;substation & bay name
            OX = %OX(9),-                                ;object text
            IU = 1,-                                     ;in use = yes
            SS = 2,-                                     ;switch state = auto
            EE = 1,-                                     ;event enable = yes
            HE = 0,-                                     ;history enable = no
            HA = 2,-                                     ;history activation = update
            HF = 1,-                                     ;history at first update = yes
            HL = BIT_MASK(15),-                          ;history log number = 15
            HI = 0,-                                     ;upper alarm limit = 0
            HW = 0,-                                     ;upper warning limit = 0
            LW = 0,-                                     ;lower warning limit = 0
            LI = 0,-                                     ;lower alarm limit = 0
            ST = "Cause",-                               ;unit of value
            SN = "1_1",-                                 ;scale name
            SZ = 1,-                                     ;zone supervision = SCADA
            RC = 0,-                                     ;receipt = acknowledgement not required
            AB = 0,-                                     ;alarm blocking = no
            AC = 0,-                                     ;alarm class = disabled
            AD = 0,-                                     ;alarm delay = 0
            PD = 0,-                                     ;picture device = none
            PI = "",-                                    ;alarm picture
            PF = "",-                                    ;physical format for printout
            RI = 0,-                                     ;dynamic texts for printout
            PA = 2,-                                     ;printout activation = update
            PU = 1,-                                     ;picture/ printout at first update = yes
            LD = 0,-                                     ;listing device = none
            RX = %RX(9)))                                ;data acquisition unit and group information

    #BLOCK_END                                           ;motorized

    ;selection on monitor
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
      #WHEN "SPA" #BLOCK
        @DX(10)   ="N6"
      #BLOCK_END

      #WHEN "LON","LONMARK" #BLOCK
        @DX(10)   ="X6"
      #BLOCK_END

      #WHEN "IEC101","IEC103", "ICCP" #BLOCK
        @DX(10)   ="C9"
      #BLOCK_END

      #WHEN "ANSI" #BLOCK
        @DX(10)   ="9"
      #BLOCK_END

      #WHEN "PROC" #BLOCK
        @DX(10)   ="O2"
      #BLOCK_END

      #WHEN "RTU" #BLOCK
        @DX(10)   ="I6"
      #BLOCK_END

      #WHEN "RTU_E" #BLOCK
        @DX(10)   ="R6"
      #BLOCK_END

      #WHEN "DNP_30" #BLOCK
        @DX(10)   ="D9"
      #BLOCK_END

      #WHEN "MODBUS_RTU" #BLOCK
        @DX(10)   ="I6"
      #BLOCK_END

      #WHEN "IEC61850" #BLOCK
          @DX(10)   ="E6"
        #BLOCK_END
    #CASE_END

    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
      #WHEN "QB","QS","QI" #BLOCK                        ;circuit breaker
        @OX(10)=FPI_SSW:VCB_SEL_ON_MON                   ;signal text for selected on monitor
      #BLOCK_END
      #WHEN "QD","QF","QL" #BLOCK                        ;disconnector
        @OX(10)=FPI_SSW:VDC_SEL_ON_MON                   ;signal text for selected on monitor
      #BLOCK_END
      #WHEN "QE","QM" #BLOCK                             ;earth switch
        @OX(10)=FPI_SSW:VES_SEL_ON_MON                   ;signal text for selected on monitor
      #BLOCK_END
    #CASE_END

    @RX(10) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -           ;function block or channel number, data acquisition unit
              "FP'XX''YY'XMEV"                           ;and group information

    #MODIFY P_OBJECTS:V = LIST(P_OBJ10 = LIST(-
          IX = 19,-                                      ;index = 19
          PT = 9,-                                       ;process object type = AI
          DX = %DX(10),-                                 ;directive text
          AI = 0,-                                       ;object value = 0
          OI = %OBJ_IDENT,-                              ;substation & bay name
          OX = %OX(10),-                                 ;object text
          IU = 1,-                                       ;in use = yes
          SS = 2,-                                       ;switch state = auto
          EE = 1,-                                       ;event enable = yes
          HE = 0,-                                       ;history enable = no
          HA = 2,-                                       ;history activation = update
          HF = 1,-                                       ;history at first update = yes
          HL = BIT_MASK(15),-                            ;history log number = 15
          HI = 0,-                                       ;upper alarm limit = 0
          HW = 0,-                                       ;upper warning limit = 0
          LW = 0,-                                       ;lower warning limit = 0
          LI = 0,-                                       ;lower alarm limit = 0
          ST = "Sessions",-                              ;unit of value
          SN = "1_1",-                                   ;scale name
          SZ = 1,-                                       ;zone supervision = SCADA
          RC = 0,-                                       ;receipt = acknowledgement not required
          AB = 0,-                                       ;alarm blocking = no
          AC = 0,-                                       ;alarm class = disabled
          AD = 0,-                                       ;alarm delay = 0
          PD = 0,-                                       ;picture device = none
          PI = "",-                                      ;alarm picture
          PF = "",-                                      ;physical format for printout
          RI = 0,-                                       ;dynamic texts for printout
          PA = 2,-                                       ;printout activation = update
          PU = 1,-                                       ;picture/ printout at first update = yes
          LD = 0,-                                       ;listing device = none
          RX = %RX(10)))                                 ;group information

    ;if motorized switching device
    #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK
 
      ;input object for command event
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(11)    ="N7S"
          @HE(11)    = 0                                 ;history enable = no
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
         #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(11)    ="X7S"
          @HE(11)    = 0                                 ;history enable = no
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(11)    ="C3"
          @HE(11)    = 0                                 ;history enable = no
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(11)    ="3"
          @HE(11)    = 0                                 ;history enable = no
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(11)    ="O1"
          @HE(11)    = 0                                 ;history enable = no
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(11)  ="I7S" 
            @HE(11)  = 0                                 ;history enable = no
            @PF(11)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(11)  ="I7S" 
            @HE(11)  = 1                                 ;history enable = yes
            @PF(11)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(11)  ="R7S"
            @HE(11)  = 0                                 ;history enable = no
            @PF(11)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(11)  ="R7S"
            @HE(11)  = 1                                 ;history enable = yes
            @PF(11)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(11)  ="D3" 
            @HE(11)  = 0                                 ;history enable = no
            @PF(11)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(11)  ="D3" 
            @HE(11)  = 1                                 ;history enable = yes
            @PF(11)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "MODBUS_RTU" #BLOCK
            @DX(11)  ="I7S" 
            @HE(11)  = 0                                 ;history enable = no
            @PF(11)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
 
        #WHEN "IEC61850" #BLOCK
          @DX(11)    ="E7S"
          @HE(11)    = 0                                 ;history enable = no
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
         #BLOCK_END
      #CASE_END               

      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
        #WHEN "QB","QS","QI" #BLOCK                      ;circuit breaker
          @OX(11)=FPI_SSW:VCB_CMD_EVENT                  ;signal text for command event
          @RI(11)=4                                      ;dynamic text for command event printout
        #BLOCK_END
        #WHEN "QD","QF","QL" #BLOCK                      ;disconnector
          @OX(11)=FPI_SSW:VDC_CMD_EVENT                  ;signal text for command event
          @RI(11)=9                                      ;dynamic text for command event printout
        #BLOCK_END
        #WHEN "QE","QM" #BLOCK                           ;earth switch
          @OX(11)=FPI_SSW:VES_CMD_EVENT                  ;signal text for command event
          @RI(11)=14                                     ;dynamic text for command event printout
        #BLOCK_END
      #CASE_END

      @RX(11) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -         ;function block or channel number, data acquisition unit
                "FP'XX''YY'ICEV"                         ;and group information
      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
         @RX(11) = SUBSTR(%RX(11),1,35) + "CSWI.Pos.stSeld"
         #IF %b_Fill_IN #THEN @IN(1) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Pos.stSeld"
         #ELSE @IN(1) = ""
      #BLOCK_END

      #MODIFY P_OBJECTS:V = LIST(P_OBJ11 = LIST(-
            IX = 20,-                                    ;index = 20
            PT = 3,-                                     ;process object type = BI
            DX = %DX(11),-                               ;directive text
            BI = 0,-                                     ;object value
            OI = %OBJ_IDENT,-                            ;substation & bay name
            OX = %OX(11),-                               ;object text
            IU = 1,-                                     ;in use = yes
            SS = 2,-                                     ;switch state = auto
            EE = 1,-                                     ;event enable = yes
            HE = %HE(11),-                               ;history enable
            HA = 1,-                                     ;history activation = new value
            HF = 0,-                                     ;history at first update = no
            HL = BIT_MASK(15),-                          ;history log number = 15
            RC = 1,-                                     ;receipt = acknowledgement required
            AB = 0,-                                     ;alarm blocking = no
            AC = 0,-                                     ;alarm class 
            AG = 0,-                                     ;alarming value = 0
            AD = 0,-                                     ;alarm delay = disabled
            PD = 0,-                                     ;picture device = none
            PI = "",-                                    ;alarm picture
            PF = %PF(11),-                               ;physical format for printout
            RI = %RI(11),-                               ;dynamic texts for printout
            PA = 1,-                                     ;printout activation = new value
            PU = 0,-                                     ;picture/ printout at first update = no
            LD = 0,-                                     ;listing device = none
            IN = %IN(1),-
            RX = %RX(11)))                               ;data acquisition unit and group information
 
    #BLOCK_END                                           ;motorized

    ;optional auxiliary plug
    #IF 'ID'_PICTURE_FUNCTION_CONF:VAUXILIARY_PLUG #THEN #BLOCK
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(12)    ="N7S"
          @HE(12)    = 1                                 ;history enable = yes
          @PF(12)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(12)    ="X7S"
          @HE(12)    = 1                                 ;history enable = yes
          @PF(12)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(12)    ="C3"
          @HE(12)    = 1                                 ;history enable = yes
          @PF(12)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(12)    ="3"
          @HE(12)    = 1                                 ;history enable = yes
          @PF(12)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(12)    ="O1"
          @HE(12)    = 1                                 ;history enable = yes
          @PF(12)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(12)  ="I7S" 
            @HE(12)  = 0                                 ;history enable = no
            @PF(12)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(12)  ="I7S" 
            @HE(12)  = 1                                 ;history enable = yes
            @PF(12)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(12)  ="R7S"
            @HE(12)  = 0                                 ;history enable = no
            @PF(12)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(12)  ="R7S"
            @HE(12)  = 1                                 ;history enable = yes
            @PF(12)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(12)  ="D3" 
            @HE(12)  = 0                                 ;history enable = yes
            @PF(12)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(12)  ="D3" 
            @HE(12)  = 1                                 ;history enable = yes
            @PF(12)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "MODBUS_RTU" #BLOCK
            @DX(12)  ="I7S" 
            @HE(12)  = 1                                 ;history enable = yes
            @PF(12)  = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

         #WHEN "IEC61850" #BLOCK
          @DX(12)    ="E7S"
          @HE(12)    = 1                                 ;history enable = yes
          @PF(12)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

      #CASE_END

      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
        #WHEN "QB","QS","QI" #BLOCK                      ;circuit breaker
          @OX(12)=FPI_SSW:VCB_AUX_PLUG                   ;signal text for auxiliary plug
          @RI(12)=31                                     ;dynamic text for auxiliary plug printout
        #BLOCK_END
        #WHEN "QD","QF","QL" #BLOCK                      ;disconnector
          @OX(12)=FPI_SSW:VDC_AUX_PLUG                   ;signal text for auxiliary plug
          @RI(12)=31                                     ;dynamic text for auxiliary plug printout
        #BLOCK_END
        #WHEN "QE","QM" #BLOCK                           ;earth switch
          @OX(12)=FPI_SSW:VES_AUX_PLUG                   ;signal text for auxiliary plug
          @RI(12)=31                                     ;dynamic text for auxiliary plug printout
        #BLOCK_END
      #CASE_END

      @RX(12) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -         ;function block or channel number, data acquisition unit
                "FP'XX''YY'IAUX"                         ;and group information

      #MODIFY P_OBJECTS:V = LIST(P_OBJ12 = LIST(-
            IX = 21,-                                    ;index = 21
            PT = 3,-                                     ;process object type = BI
            DX = %DX(12),-                               ;directive text
            BI = 1,-                                     ;object value
            OI = %OBJ_IDENT,-                            ;substation & bay name
            OX = %OX(12),-                               ;object text
            IU = 1,-                                     ;in use = yes
            SS = 1,-                                     ;switch state = man
            EE = 1,-                                     ;event enable = yes
            HE = %HE(12),-                               ;history enable
            HA = 1,-                                     ;history activation = new value
            HF = 0,-                                     ;history at first update = no
            HL = BIT_MASK(15),-                          ;history log number = 15
            RC = 1,-                                     ;receipt = acknowledgement required
            AB = 0,-                                     ;alarm blocking = no
            AC = 0,-                                     ;alarm class 
            AG = 0,-                                     ;alarming value = 0
            AD = 0,-                                     ;alarm delay = disabled
            PD = 0,-                                     ;picture device = none
            PI = "",-                                    ;alarm picture
            PF = %PF(12),-                               ;physical format for printout
            RI = %RI(12),-                               ;dynamic texts for printout
            PA = 1,-                                     ;printout activation = new value
            PU = 0,-                                     ;picture/ printout at first update = no
            LD = BIT_MASK(1),-                           ;listing device
            RX = %RX(12)))                                ;data acquisition unit and group information

    #BLOCK_END                                           ;auxiliary plug


;Synchrocheck Bypass
    #IF 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE == "QS" #THEN #BLOCK
       
       ;create command procedure for Synchrocheck Bypass
       #do read_text("SAGR_INST/sai_bypass.scl")

           ;Indication Object
            @RX(22) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -         ;function block or channel number, data acquisition unit
                      "FP'XX''YY'ISYN"                         ;and group information
           #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
              @RX(1) = SUBSTR(%RX(1),1,35) + "RSYN.Rel.stVal"
              #IF LENGTH(%v_RSYN_Instance) > 0 #THEN #BLOCK
                 #IF %b_Fill_IN #THEN @IN(1) = %t_OPC_Prefix + "." + %v_RSYN_Instance(1) + ".Rel.stVal"
                 #ELSE @IN(1) = ""
              #BLOCK_END
              #ELSE @IN(1) = ""
           #BLOCK_END
           #ELSE @IN(1) = ""

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
               #WHEN "LON" #BLOCK
                  @T_DX = "X7S"
                  @I_OV = 0
               #BLOCK_END
               #WHEN "IEC61850" #BLOCK
                  @T_DX = "E7S"
                  @I_OV = 1
               #BLOCK_END
               #OTHERWISE #BLOCK
                  @T_DX = "X7S"
                  @I_OV = 0
               #BLOCK_END
            #CASE_END

            #MODIFY P_OBJECTS:V = LIST(P_OBJ22 = LIST(-
                  IX = 22,-                                    ;index = 22
                  PT = 3,-                                     ;process object type = BI
                  DX = %T_DX,-                                 ;directive text
                  BI = %I_OV,-                                     ;object value
                  OI = %OBJ_IDENT,-                            ;substation & bay name
                  OX = FPI_SSW:VCB_SYN_IND,-                   ;object text
                  IU = 1,-                                     ;in use = yes
                  SS = 1,-                                     ;switch state = man
                  EE = 1,-                                     ;event enable = yes
                  HE = 1,-                                     ;history enable
                  HA = 4,-                                     ;history activation = value up
                  HF = 0,-                                     ;history at first update = no
                  HL = BIT_MASK(15),-                          ;history log number = 15
                  RC = 0,-                                     ;receipt = no acknowledgement required
                  AB = 0,-                                     ;alarm blocking = no
                  AC = 0,-                                     ;alarm class 
                  AG = 0,-                                     ;alarming value = 0
                  AD = 0,-                                     ;alarm delay = disabled
                  PD = 0,-                                     ;picture device = none
                  PI = "",-                                    ;alarm picture
                  PF = "FORM5SAGR1",-                          ;physical format for printout
                  RI = 41,-                                    ;dynamic texts for printout
                  PA = 4,-                                     ;printout activation = value up
                  PU = 0,-                                     ;picture/ printout at first update = no
                  LD = BIT_MASK(1),-                           ;listing device
                  IN = %IN(1),-
                  RX = %RX(22)))                               ;data acquisition unit and group information

           #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE <> "IEC61850" #THEN #BLOCK
           ;Command Object
            @RX(23) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -      ;function block or channel number, data acquisition unit
                     "FP'XX''YY'CSYN"                       ;and group information
            #MODIFY P_OBJECTS:V = LIST(P_OBJ23 = LIST(-
                   IX = 23,-                                ;index = 23
                   PT = 5,-                                 ;process object type = BO
                   DX = "X1",-                              ;directive text
                   OI = %OBJ_IDENT,-                        ;substation & bay name
                   OX = FPI_SSW:VCB_SYN_CMD,-               ;object text
                   IU = 1,-                                 ;in use = yes
                   SS = 1,-                                 ;switch state = manual
                   EE = 1,-                                 ;event enable = yes
                   HE = 1,-                                 ;history enable = yes
                   HA = 2,-                                 ;history activation = update
                   HF = 1,-                                 ;history at first update = yes
                   HL = BIT_MASK(15),-                      ;history log number = 15
                   PF = "FORM5SAGR1",-                      ;physical format for printout
                   RI = 57,-                                ;dynamic texts for printout
                   PA = 2,-                                 ;printout activation = update
                   PU = 1,-                                 ;picture/ printout at first update = yes
                   LD = BIT_MASK(1),-                       ;listing device = 1
                   RX = %RX(23)))                           ;data acquisition unit and group information
           #BLOCK_END
                   

    #BLOCK_END                                              ;synchrocheck bypass
;Synchrocheck Bypass End


    ;position indication other than double indication
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE

      ;analog input
      #WHEN "AI" #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(13)   ="N6"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(13)   ="X6"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(13)   ="C9"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(13)   ="9"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(13)   ="O2"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(13)   ="I6"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(13)   ="R6"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(13)   ="D9"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(13)   ="I6"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(13)   ="E6"
          #BLOCK_END
        #CASE_END

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
          #WHEN "QB","QS","QI" #BLOCK                    ;circuit breaker
            @OX(13)=FPI_SSW:VCB_POS_IND                  ;signal text for position indication
          #BLOCK_END
          #WHEN "QD","QF","QL" #BLOCK                    ;disconnector
            @OX(13)=FPI_SSW:VDC_POS_IND                  ;signal text for position indication
          #BLOCK_END
          #WHEN "QE","QM" #BLOCK                         ;earth switch
            @OX(13)=FPI_SSW:VES_POS_IND                  ;signal text for position indication
          #BLOCK_END
        #CASE_END

        @RX(13) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'EPOS"                       ;and group information

        ;TiLi 24.11.2003: ID 7833
        #if 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "ANSI" #then @SN(13) = "BGU_1_1000"
        #else @SN(13) = "1_1"
        ;**

        #MODIFY P_OBJECTS:V = LIST(P_OBJ13 = LIST(-
              IX = 110,-                                 ;index = 110
              PT = 9,-                                   ;process object type = AI
              DX = %DX(13),-                             ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(13),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "POS",-                               ;unit of value
              SN = %SN(13),-                             ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              AN = "BGU_AI2DB",-                         ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(13)))                             ;data acquisition unit and group information

      #BLOCK_END                                         ;analog input

      ;binary input
      #WHEN "BI" #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(13)   ="N7S"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(13)   ="X7S"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(13)   ="C3"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(13)   ="3"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(13)   ="O1"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(13)   ="I7S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(13)   ="R7S"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(13)   ="D3"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(13)   ="I7S"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(13)   ="E7S"
          #BLOCK_END

        #CASE_END

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
          #WHEN "QB","QS","QI" #BLOCK                    ;circuit breaker
            @OX(13)=FPI_SSW:VCB_POS_IND                  ;signal text for position indication
          #BLOCK_END
          #WHEN "QD","QF","QL" #BLOCK                    ;disconnector
            @OX(13)=FPI_SSW:VDC_POS_IND                  ;signal text for position indication
          #BLOCK_END
          #WHEN "QE","QM" #BLOCK                         ;earth switch
            @OX(13)=FPI_SSW:VES_POS_IND                  ;signal text for position indication
          #BLOCK_END
        #CASE_END

        @RX(13) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'EPOS"                       ;and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ13 = LIST(-
              IX = 110,-                                 ;index = 110
              PT = 3,-                                   ;process object type = BI
              DX = %DX(13),-                             ;directive text
              BI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(13),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_BI2DB",-                         ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(13)))                             ;data acquisition unit and group information

      #BLOCK_END                                         ;binary input

      ;two binary inputs
      #WHEN "2BI" #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(13..14)   ="N7S"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(13..14)   ="X7S"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(13..14)   ="C3"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(13..14)   ="3"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(13..14)   ="O1"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(13..14)   ="I7S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(13..14)   ="R7S"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(13..14)   ="D3"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(13..14)   ="I7S"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(13..14)   ="E7S"
          #BLOCK_END
        #CASE_END

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
          #WHEN "QB","QS","QI" #BLOCK                    ;circuit breaker
            @OX(13)=FPI_SSW:VCB_OPEN_IND                 ;signal text for open indication
            @OX(14)=FPI_SSW:VCB_CLOSE_IND                ;signal text for close indication
          #BLOCK_END
          #WHEN "QD","QF","QL" #BLOCK                    ;disconnector
            @OX(13)=FPI_SSW:VDC_OPEN_IND                 ;signal text for open indication
            @OX(14)=FPI_SSW:VDC_CLOSE_IND                ;signal text for close indication
          #BLOCK_END
          #WHEN "QE","QM" #BLOCK                         ;earth switch
            @OX(13)=FPI_SSW:VES_OPEN_IND                 ;signal text for open indication
            @OX(14)=FPI_SSW:VES_CLOSE_IND                ;signal text for close indication
          #BLOCK_END
        #CASE_END

        @RX(13..14) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EPOS"                   ;and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ13 = LIST(-
              IX = 110,-                                 ;index = 110
              PT = 3,-                                   ;process object type = BI
              DX = %DX(13),-                             ;directive text
              BI = 0,-                                   ;object value = 0
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(13),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_2BI2DB",-                        ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(13)))                             ;data acquisition unit and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ14 = LIST(-
              IX = 108,-                                 ;index = 108
              PT = 3,-                                   ;process object type = BI
              DX = %DX(14),-                             ;directive text
              BI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(14),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_2BI2DB",-                        ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(14)))                             ;data acquisition unit and group information
      #BLOCK_END                                         ;two binary inputs
    #CASE_END                                            ;indication type
    
    ;** TiLi 07.01.2004 additional faulty indication for DNP 3.0 and MODBUS
    #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK

       #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "DNP_30" #BLOCK
            @DX(24)   ="D3"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(24)   ="I7S"
          #BLOCK_END
        #CASE_END

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
          #WHEN "QB","QS","QI" #BLOCK                    ;circuit breaker
            @OX(24)=FPI_SSW:VCB_FAULTY_IND               ;signal text for close indication
          #BLOCK_END
          #WHEN "QD","QF","QL" #BLOCK                    ;disconnector
            @OX(24)=FPI_SSW:VDC_FAULTY_IND               ;signal text for close indication
          #BLOCK_END
          #WHEN "QE","QM" #BLOCK                         ;earth switch
            @OX(24)=FPI_SSW:VES_FAULTY_IND               ;signal text for close indication
          #BLOCK_END
        #CASE_END

       @RX(24) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EPOS"                   ;and group information

       #MODIFY P_OBJECTS:V = LIST(P_OBJ24 = LIST(-
              IX = 106,-                                 ;index = 106
              PT = 3,-                                   ;process object type = BI
              DX = %DX(24),-                             ;directive text
              BI = 0,-                                   ;object value = 0, 4.5.2009 HoDa default object value changed to 0 = not faulty
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(24),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_1TO3",-                          ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(24)))                             ;data acquisition unit and group information
    #BLOCK_END
    ;** TiLi END

    ;event recording objects
    #IF ('ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="RTU" OR -
        'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="RTU_E" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30") AND -
        'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK

      ;event recording object for position indication (DB)
      #IF 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE=="DB" #THEN #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "RTU" #BLOCK
            @DX(13)    ="I10D"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(13)    ="R10D"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(13)    ="D12"
          #BLOCK_END         
        #CASE_END

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
          #WHEN "QB","QS","QI" #BLOCK                    ;circuit breaker
            @OX(13)=FPI_SSW:VCB_POS_IND                  ;signal text for position indication
            @RI(13)=3                                    ;dynamic text for position indication printout
          #BLOCK_END
          #WHEN "QD","QF","QL" #BLOCK                    ;disconnector
            @OX(13)=FPI_SSW:VDC_POS_IND                  ;signal text for position indication
            @RI(13)=4                                    ;dynamic text for position indication printout
          #BLOCK_END
          #WHEN "QE","QM" #BLOCK                         ;earth switch
            @OX(13)=FPI_SSW:VES_POS_IND                  ;signal text for position indication
            @RI(13)=5                                    ;dynamic text for position indication printout
          #BLOCK_END
        #CASE_END

        @RX(13) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'EPOS"                       ;and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ13 = LIST(-
              IX = 110,-                                 ;index = 110
              PT = 12,-                                  ;process object type = DB
              DX = %DX(13),-                             ;directive text
              NV = 4,-                                   ;normal value = none
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(13),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 1,-                                   ;history enable = yes
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              LA = 0,-                                   ;alarm activation = none
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "FORM5SAGR1",-                        ;physical format for printout
              RI = %RI(13),-                             ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = BIT_MASK(1),-                         ;listing device = 1
              RX = %RX(13)))                             ;data acquisition unit and group information

      #BLOCK_END                                         ;double binary

      ;if motorized switching device
      #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

        ;event recording objects for external control blocking and open/close interlocking 
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "RTU" #BLOCK
            @DX(15..17)    ="I10S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(15..17)    ="R10S"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(15..17)    ="D3"
          #BLOCK_END                  
        #CASE_END

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
          #WHEN "QB","QS","QI" #BLOCK                    ;circuit breaker
            @OX(15)=FPI_SSW:VCB_EXT_CNTR_BLK             ;signal text for external interlocking
            @OX(16)=FPI_SSW:VCB_OPEN_ILOCKED             ;signal text for open interlocked
            @OX(17)=FPI_SSW:VCB_CLOSE_ILOCKED            ;signal text for close interlocked
            @RI(15..17)=3                                ;dynamic text for object printout
          #BLOCK_END
          #WHEN "QD","QF","QL" #BLOCK                    ;disconnector
            @OX(15)=FPI_SSW:VDC_EXT_CNTR_BLK             ;signal text for external interlocking
            @OX(16)=FPI_SSW:VDC_OPEN_ILOCKED             ;signal text for open interlocked
            @OX(17)=FPI_SSW:VDC_CLOSE_ILOCKED            ;signal text for close interlocked
            @RI(15..17)=8                                ;dynamic text for object printout
          #BLOCK_END
          #WHEN "QE","QM" #BLOCK                         ;earth switch
            @OX(15)=FPI_SSW:VES_EXT_CNTR_BLK             ;signal text for external interlocking
            @OX(16)=FPI_SSW:VES_OPEN_ILOCKED             ;signal text for open interlocked
            @OX(17)=FPI_SSW:VES_CLOSE_ILOCKED            ;signal text for close interlocked
            @RI(15..17)=13                               ;dynamic text for object printout
          #BLOCK_END
        #CASE_END

        @RX(15)     = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EBLK"                   ;and group information
        @RX(16..17) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EINH"                   ;and group information

        #LOOP_WITH I=15..17
          #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
                IX = 100+%I,-                            ;index = 115,116,117
                PT = 3,-                                 ;process object type = BI
                DX = %DX('I'),-                          ;directive text
                BI = 0,-                                 ;object value
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX('I'),-                          ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class 
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI('I'),-                          ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX('I')))                          ;data acquisition unit and group information
        #LOOP_END

      #BLOCK_END                                         ;motorized

      ;event recording objects for optional auxiliary plug 
      #IF 'ID'_PICTURE_FUNCTION_CONF:VAUXILIARY_PLUG #THEN #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "RTU" #BLOCK
            @DX(18)    ="I10S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(18)    ="R10S"            
          #BLOCK_END
          
          #WHEN "DNP_30" #BLOCK
            @DX(18)    ="D3"            
          #BLOCK_END
        #CASE_END

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
          #WHEN "QB","QS","QI" #BLOCK                    ;circuit breaker
            @OX(18)=FPI_SSW:VCB_AUX_PLUG                 ;signal text for auxiliary plug
            @RI(18)=31                                   ;dynamic text for auxiliary plug printout
          #BLOCK_END
          #WHEN "QD","QF","QL" #BLOCK                    ;disconnector
            @OX(18)=FPI_SSW:VDC_AUX_PLUG                 ;signal text for auxiliary plug
            @RI(18)=31                                   ;dynamic text for auxiliary plug printout
          #BLOCK_END
          #WHEN "QE","QM" #BLOCK                         ;earth switch
            @OX(18)=FPI_SSW:VES_AUX_PLUG                 ;signal text for auxiliary plug
            @RI(18)=31                                   ;dynamic text for auxiliary plug printout
          #BLOCK_END
        #CASE_END

        @RX(18) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'EAUX"                       ;and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ18 = LIST(-
              IX = 121,-                                 ;index = 121
              PT = 3,-                                   ;process object type = BI
              DX = %DX(18),-                             ;directive text
              BI = 0,-                                   ;object value
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(18),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 2,-                                   ;switch state = auto
              EE = 0,-                                   ;event enable = no
              HE = 1,-                                   ;history enable = yes
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "FORM5SAGR1",-                        ;physical format for printout
              RI = %RI(18),-                             ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = BIT_MASK(1),-                         ;listing device
              RX = %RX(18)))                             ;data acquisition unit and group information

      #BLOCK_END                                         ;auxialiry plug

      ;position indication other than double indication
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE

        ;event recording object for position indication of the analog input (AI) type
        #WHEN "AI" #BLOCK
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "RTU" #BLOCK
              @DX(19)   ="I11"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(19)   ="R11"      
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(19)   ="D9"      
            #BLOCK_END
          #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(19)=FPI_SSW:VCB_POS_IND                ;signal text for position indication
              @RI(19)=3                                  ;dynamic text for position indication printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(19)=FPI_SSW:VDC_POS_IND                ;signal text position indication
              @RI(19)=4                                  ;dynamic text for position indication printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(19)=FPI_SSW:VES_POS_IND                ;signal text position indication
              @RI(19)=5                                  ;dynamic text for position indication printout
            #BLOCK_END
          #CASE_END

          @RX(19) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -     ;function block or channel number, data acquisition unit
                    "FP'XX''YY'EPOS"                     ;and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ19 = LIST(-
                IX = 210,-                               ;index = 210
                PT = 9,-                                 ;process object type = AI
                DX = %DX(19),-                           ;directive text
                AI = 1,-                                 ;object value = 1
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(19),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                HI = 0,-                                 ;upper alarm limit = 0
                HW = 0,-                                 ;upper warning limit = 0
                LW = 0,-                                 ;lower warning limit = 0
                LI = 0,-                                 ;lower alarm limit = 0
                ST = "POS",-                             ;unit of value
                SN = "1_1",-                             ;scale name
                SZ = 1,-                                 ;zone supervision = SCADA
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(19),-                           ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(19)))                           ;data acquisition unit and group information

        #BLOCK_END                                       ;analog input

        ;event recording object for position indication of the single binary input (BI) type
        #WHEN "BI" #BLOCK
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "RTU" #BLOCK
              @DX(19)   ="I10S"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(19)   ="R10S"         
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(19)   ="D3"         
            #BLOCK_END
          #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(19)=FPI_SSW:VCB_POS_IND                ;signal text for position indication
              @RI(19)=5                                  ;dynamic text for position indication printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(19)=FPI_SSW:VDC_POS_IND                ;signal text position indication
              @RI(19)=10                                 ;dynamic text for position indication printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(19)=FPI_SSW:VES_POS_IND                ;signal text position indication
              @RI(19)=15                                 ;dynamic text for position indication printout
            #BLOCK_END
          #CASE_END

          @RX(19) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -     ;function block or channel number, data acquisition unit
                    "FP'XX''YY'EPOS"                     ;and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ19 = LIST(-
                IX = 210,-                               ;index = 210
                PT = 3,-                                 ;process object type = BI
                DX = %DX(19),-                           ;directive text
                BI = 0,-                                 ;object value
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(19),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(19),-                           ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(19)))                           ;data acquisition unit and group information

        #BLOCK_END                                       ;binary input

        ;event recording object for position indication of two binary inputs (2xBI) type
        #WHEN "2BI" #BLOCK
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "RTU" #BLOCK
              @DX(19..20)   ="I10S"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK         
              @DX(19..20)   ="R10S"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK         
              @DX(19..20)   ="D3"
            #BLOCK_END
          #CASE_END

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(19)=FPI_SSW:VCB_OPEN_IND               ;signal text for open indication
              @OX(20)=FPI_SSW:VCB_CLOSE_IND              ;signal text for close indication
              @RI(19)=6                                  ;dynamic text for open position indication printout
              @RI(20)=7                                  ;dynamic text for close position indication printout
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(19)=FPI_SSW:VDC_OPEN_IND               ;signal text for open indication
              @OX(20)=FPI_SSW:VDC_CLOSE_IND              ;signal text for close indication
              @RI(19)=11                                 ;dynamic text for open position indication printout
              @RI(20)=12                                 ;dynamic text for close position indication printout
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(19)=FPI_SSW:VES_OPEN_IND               ;signal text for open indication
              @OX(20)=FPI_SSW:VES_CLOSE_IND              ;signal text for close indication
              @RI(19)=16                                 ;dynamic text for open position indication printout
              @RI(20)=17                                 ;dynamic text for close position indication printout
            #BLOCK_END
          #CASE_END

          @RX(19..20) = %ADDITIONAL_IDENT+%UNIT_IDENT+ - ;function block or channel number, data acquisition unit
                        "FP'XX''YY'EPOS"                 ;and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ19 = LIST(-
                IX = 210,-                               ;index = 210
                PT = 3,-                                 ;process object type = BI
                DX = %DX(19),-                           ;directive text
                BI = 0,-                                 ;object value = 0
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(19),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(19),-                           ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(19)))                           ;data acquisition unit and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ20 = LIST(-
                IX = 208,-                               ;index = 208
                PT = 3,-                                 ;process object type = BI
                DX = %DX(20),-                           ;directive text
                BI = 1,-                                 ;object value = 1
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(20),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(20),-                           ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(20)))                           ;data acquisition unit and group information
        #BLOCK_END                                       ;two binary inputs
      #CASE_END                                          ;indication type
    #BLOCK_END                                           ;event recording

    ;command termination
    #IF ('ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="IEC101" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="IEC103" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30") AND 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

      ;control type
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VCONTROL_TYPE

        ;secured control with four binary outputs
        #WHEN "SEC-4BO" #BLOCK
          ;indexing
          @START_INDEX = 15
          @STOP_INDEX  = 18
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(15)=FPI_SSW:VCB_OPEN_SEL               ;signal text for open select
              @OX(16)=FPI_SSW:VCB_CLOSE_SEL              ;signal text for close select
              @OX(17)=FPI_SSW:VCB_EXEC_CMD               ;signal text for execute
              @OX(18)=FPI_SSW:VCB_CANCEL_CMD             ;signal text for cancel
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(15)=FPI_SSW:VDC_OPEN_SEL               ;signal text for open select
              @OX(16)=FPI_SSW:VDC_CLOSE_SEL              ;signal text for close select
              @OX(17)=FPI_SSW:VDC_EXEC_CMD               ;signal text for execute
              @OX(18)=FPI_SSW:VDC_CANCEL_CMD             ;signal text for cancel
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(15)=FPI_SSW:VES_OPEN_SEL               ;signal text for open select
              @OX(16)=FPI_SSW:VES_CLOSE_SEL              ;signal text for close select
              @OX(17)=FPI_SSW:VES_EXEC_CMD               ;signal text for execute
              @OX(18)=FPI_SSW:VES_CANCEL_CMD             ;signal text for cancel
            #BLOCK_END
          #CASE_END
        #BLOCK_END

        ;secured control with two binary or digital outputs
        #WHEN "SEC-2BO","SEC-2DO" #BLOCK
          ;indexing
          @START_INDEX = 15
          @STOP_INDEX  = 16
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(15)=FPI_SSW:VCB_OPEN_EXEC              ;signal text for open execute
              @OX(16)=FPI_SSW:VCB_CLOSE_EXEC             ;signal text for close execute
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(15)=FPI_SSW:VDC_OPEN_EXEC              ;signal text for open execute
              @OX(16)=FPI_SSW:VDC_CLOSE_EXEC             ;signal text for close execute
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(15)=FPI_SSW:VES_OPEN_EXEC              ;signal text for open execute
              @OX(16)=FPI_SSW:VES_CLOSE_EXEC             ;signal text for close execute
            #BLOCK_END
          #CASE_END
        #BLOCK_END

        ;secured control with a single binary or analog output/direct control with a single binary output  
        #WHEN "SEC-BO","AO","DIR-BO" #BLOCK
          ;indexing
          @START_INDEX = 17
          @STOP_INDEX  = 17
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
            #WHEN "QB","QS","QI" #BLOCK                  ;circuit breaker
              @OX(17)=FPI_SSW:VCB_OBJ_CMD                ;signal text for control object
            #BLOCK_END
            #WHEN "QD","QF","QL" #BLOCK                  ;disconnector
              @OX(17)=FPI_SSW:VDC_OBJ_CMD                ;signal text for control object
            #BLOCK_END
            #WHEN "QE","QM" #BLOCK                       ;earth switch
              @OX(17)=FPI_SSW:VES_OBJ_CMD                ;signal text for control object
            #BLOCK_END
          #CASE_END
        #BLOCK_END
      #CASE_END                                          ;control type

      @RX(%START_INDEX..%STOP_INDEX) = %ADDITIONAL_IDENT+ -  ;function block or channel number, data acquisition unit
          %UNIT_IDENT+"FP'XX''YY'TOBC"                   ;and group information
      
      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30" #THEN @TMP_DX = "D9E"
      #ELSE @TMP_DX = "C9E"

      #LOOP_WITH I=%START_INDEX..%STOP_INDEX
        #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
              IX = %I+96,-                               ;index = (111, 112,) 113 (,114)
              PT = 9,-                                   ;process object type = AI
              DX = %TMP_DX,-                             ;directive text
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX('I'),-                            ;object text
              IU = 1,-                                   ;in use = yes
              SS = 2,-                                   ;switch state = auto
              EE = 1,-                                   ;event enable = yes
              HE = 1,-                                   ;history enable
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "cmd status",-                        ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "FORM5SAGR1",-                        ;physical format for printout
              RI = 10,-                                  ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = BIT_MASK(1),-                         ;listing device
              RX = %RX('I')))                            ;data acquisition unit and group information

      #LOOP_END
    #BLOCK_END                                           ;IEC 870-5-101/103 and motorized

    ;if motorized switching device
    #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

      ;interlocking cause (calculated by topological interlocking)
      #IF 'ID'_PICTURE_FUNCTION_CONF:VCREATE_TOPO_INTL_CAUSE #THEN #BLOCK

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(21)   ="N6"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(21)   ="X6"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(21)   ="C9"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(21)   ="9"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(21)   ="O2"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(21)   ="I6"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(21)   ="R6"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(21)   ="D9"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(21)   ="I6"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(21)   ="E6"
          #BLOCK_END

        #CASE_END

        @RX(21) = "                    FP'XX''YY'IINH"   ;group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ21 = LIST(-
              IX = 252,-                                 ;index = 252
              PT = 9,-                                   ;process object type = AI
              DX = %DX(21),-                             ;directive text
              AI = 0,-                                   ;object value = 0
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VINTL_CAUSE,-                 ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = auto
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "Cause",-                             ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = 0,-                                   ;listing device = none
              RX = %RX(21)))                             ;group information

      #BLOCK_END                                         ;topological interlocking
    #BLOCK_END                                           ;motorized
  #BLOCK_END                                             ;circuit breaker, disconnector and earth switch

  ;=====================================================================================================;
  ;truck                                                                                                ;
  ;=====================================================================================================;
  #WHEN "QT" #BLOCK

    ;initialize variables
    @DX
    @OX
    @HE
    @PF
    @RI
    @RX
    @LD
    @P_OBJ01
    @P_OBJ02
    @P_OBJ03
    @P_OBJ04
    @P_OBJ05
    @P_OBJ06
    @P_OBJ07
    @P_OBJ08
    @P_OBJ09
    @P_OBJ10
    @P_OBJ11
    @P_OBJ12
    @P_OBJ13
    @P_OBJ14
    @P_OBJ15
    @P_OBJ16
    @P_OBJ17
    @P_OBJ18
    @P_OBJ19
    @P_OBJ49              ;HoDa 16.11.2008 added for Tagout repr/symbol handling
    @P_OBJ50              ;HoDa 16.11.2008 added for Tagout event/log handling 
    @P_OBJECTS = LIST()

    ;define object to be created

    ;double binary indication for truck
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
      #WHEN "SPA" #BLOCK
        @DX(1)    ="N7D"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "LON","LONMARK" #BLOCK
        @DX(1)    ="X7D"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "IEC101","IEC103", "ICCP" #BLOCK
        @DX(1)    ="C12"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "ANSI" #BLOCK
        @DX(1)    ="12"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "PROC" #BLOCK
        @DX(1)    ="12"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "RTU" #BLOCK
        #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
          @DX(1)  ="I7D"
          @HE(1)  = 0                                    ;history enable = no
          @PF(1)  = "DUMMY"                              ;physical format for printout
          @LD(1)  = 0                                    ;listing device = none
        #BLOCK_END

        #ELSE #BLOCK
          @DX(1)  ="I7D"
          @HE(1)  = 1                                    ;history enable = yes
          @PF(1)  = "FORM5SAGR1"                         ;physical format for printout
          @LD(1)  = BIT_MASK(1)                          ;listing device = 1
        #BLOCK_END
      #BLOCK_END

      #WHEN "RTU_E" #BLOCK
        #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
          @DX(1)  ="R7D"
          @HE(1)  = 0                                    ;history enable = no
          @PF(1)  = "DUMMY"                              ;physical format for printout
          @LD(1)  = 0                                    ;listing device = none
        #BLOCK_END

        #ELSE #BLOCK
          @DX(1)  ="R7D"
          @HE(1)  = 1                                    ;history enable = yes
          @PF(1)  = "FORM5SAGR1"                         ;physical format for printout
          @LD(1)  = BIT_MASK(1)                          ;listing device = 1
        #BLOCK_END
      #BLOCK_END

      #WHEN "DNP_30" #BLOCK
        #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
          @DX(1)  ="D12"
          @HE(1)  = 0                                    ;history enable = yes
          @PF(1)  = "DUMMY"                              ;physical format for printout
          @LD(1)  = 0                                    ;listing device = 1
        #BLOCK_END

         #ELSE #BLOCK
          @DX(1)  ="D12"
          @HE(1)  = 1                                    ;history enable = yes
          @PF(1)  = "FORM5SAGR1"                         ;physical format for printout
          @LD(1)  = BIT_MASK(1)                          ;listing device = 1
         #BLOCK_END
      #BLOCK_END

      #WHEN "MODBUS_RTU" #BLOCK
          @DX(1)  ="I7D"
          @HE(1)  = 1                                    ;history enable = yes
          @PF(1)  = "FORM5SAGR1"                         ;physical format for printout
          @LD(1)  = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END

      #WHEN "IEC61850" #BLOCK
        @DX(1)    ="E7D"
        @HE(1)    = 1                                    ;history enable = yes
        @PF(1)    = "FORM5SAGR1"                         ;physical format for printout
        @LD(1)    = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END
    #CASE_END

    @RX(1) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -            ;function block or channel number, data acquisition unit
             "FP'XX''YY'IPOS"                            ;and group information

     #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
      @RX(1) = SUBSTR(%RX(1),1,35) + "CSWI.Pos.stVal"
        #IF %b_Fill_IN #THEN @IN(1) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Pos.stVal"
        #ELSE @IN(1) = ""
        @RI(1) = 20
     #BLOCK_END
     #ELSE @RI(1) = 6

     #MODIFY P_OBJECTS:V = LIST(P_OBJ01 = LIST(-
          IX = 30,-                                      ;index = 30
          PT = 12,-                                      ;process object type = DB
          DX = %DX(1),-                                  ;directive text
          DB = 1,-                                       ;object value = 1
          NV = 4,-                                       ;normal value = none
          OI = %OBJ_IDENT,-                              ;substation & bay name
          OX = FPI_SSW:VTR_POS_IND,-                     ;object text
          IU = 1,-                                       ;in use = yes
          SS = 1,-                                       ;switch state = manual
          EE = 1,-                                       ;event enable = yes
          HE = %HE(1),-                                  ;history enable
          HA = 1,-                                       ;history activation = new value
          HF = 0,-                                       ;history at first update = no
          HL = BIT_MASK(15),-                            ;history log number = 15
          RC = 1,-                                       ;receipt = acknowledgement required
          AB = 0,-                                       ;alarm blocking = no
          AC = 1,-                                       ;alarm class = 1
          LA = 9,-                                       ;alarm activation = intermediate & faulty alarming
          AD = 0,-                                       ;alarm delay = 0
          PD = 0,-                                       ;picture device = none
          PI = "",-                                      ;alarm picture
          PF = %PF(1),-                                  ;physical format for printout
          RI = %RI(1),-                                  ;dynamic texts for printout
          PA = 1,-                                       ;printout activation = new value
          PU = 0,-                                       ;picture/ printout at first update = no
          LD = %LD(1),-                                  ;listing device
          IN = %IN(1),-                                  ;
          RX = %RX(1)))                                  ;data acquisition unit and group information

    ;if motorized truck                           
    #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

      ;control objects
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VCONTROL_TYPE

      #WHEN "SEC-5AO" #BLOCK

          ;output objects for control commands (open/close/execute open/execute close/cancel)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(2..6) ="N4"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..6) ="X4"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..6) ="C11"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..6) ="11"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..6) ="O5"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..6) ="I4"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..6) ="R4"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
               @DX(2..6) ="D11"
               #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..205)="D9T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
               @DX(2..6) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
               @DX(2..6) ="E4"
            #BLOCK_END

          #CASE_END

          @OX(2)=FPI_SSW:VTR_OPEN_SEL                    ;signal text for open select
          @OX(3)=FPI_SSW:VTR_CLOSE_SEL                   ;signal text for close select
          @OX(4)=FPI_SSW:VTR_OPEN_EXEC                   ;signal text for execute
          @OX(5)=FPI_SSW:VTR_CLOSE_EXEC                  ;signal text for execute
          @OX(6)=FPI_SSW:VTR_CANCEL_CMD                  ;signal text for cancel
          @RI(2)=21                                      ;dynamic text for open select printout
          @RI(3)=21                                      ;dynamic text for close select printout
          @RI(4)=22                                      ;dynamic text for execute printout
          @RI(5)=22                                      ;dynamic text for cancel printout
          @RI(6)=23                                      ;dynamic text for cancel printout


          @RX(2..6) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          @v_61850_Ident = ("CSWI.Pos.ctlSelOff", "CSWI.Pos.ctlSelOn", "CSWI.Pos.ctlOperOff", "CSWI.Pos.ctlOperOn", "CSWI.Pos.ctlCan")

          #LOOP_WITH I=2..6
            #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
              @RX(%i) = SUBSTR(%RX(%i),1,35) + %v_61850_Ident(%i-1)
              @IN(2..6) = ""
              #IF %b_Fill_IN #THEN @IN(%i) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + substr(%v_61850_Ident(%i-1), 5 , 0)
            #BLOCK_END
            #if %i == 6 #then #block
               @i_tmp_count = %i + 100
               @i_Tmp_IX = 16
            #block_end
            #else #block
               @i_tmp_count = %i
               @i_Tmp_IX = %i
            #block_end                
                  
             @P_OBJ0'i_tmp_count'_LIST = LIST(-
                IX = 29+%i_Tmp_IX,-                       ;index = 13
                PT = 11,-                                ;process object type = AO
                DX = %DX(%I),-                           ;directive text
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(%I),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                HO = 0,-                                 ;high alarm limit = 0
                LO = 0,-                                 ;low alarm limit = 0
                ST = "Command",-                         ;unit of value
                SN = "1_1",-                             ;scale name
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(%I),-                           ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device = 1
                IN = %IN(%I),-
                RX = %RX(%I))                            ;data acquisition unit and group information
    
            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
 
              @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                              ;data acquisition unit and group information

                  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END               
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'i_tmp_count'=%P_OBJ0'i_tmp_count'_LIST)
          #LOOP_END
        #BLOCK_END

        ;secured control with four binary outputs
        #WHEN "SEC-5BO" #BLOCK

          ;output objects for control commands (open/close/execute/cancel)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(2..6) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..5) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..6) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..6) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..6) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..6) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..6) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(2..6) ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..205)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(2..6) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(2..6) ="E1"
            #BLOCK_END
          #CASE_END

          @OX(2)=FPI_SSW:VTR_OPEN_SEL                    ;signal text for open select
          @OX(3)=FPI_SSW:VTR_CLOSE_SEL                   ;signal text for close select
          @OX(4)=FPI_SSW:VTR_OPEN_EXEC                   ;signal text for execute
          @OX(5)=FPI_SSW:VTR_CLOSE_EXEC                  ;signal text for execute
          @OX(6)=FPI_SSW:VTR_CANCEL_CMD                  ;signal text for cancel
          @RI(2)=25                                      ;dynamic text for open select printout
          @RI(3)=26                                      ;dynamic text for close select printout
          @RI(4)=27                                      ;dynamic text for execute printout
          @RI(5)=27                                      ;dynamic text for cancel printout
          @RI(6)=28                                      ;dynamic text for cancel printout
          @RX(2..6) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          @v_61850_Ident = ("CSWI.Pos.ctlSelOff", "CSWI.Pos.ctlSelOn", "CSWI.Pos.ctlOperOff", "CSWI.Pos.ctlOperOn", "CSWI.Pos.ctlCan")

          #LOOP_WITH I=2..6

            #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
             @RX(%i) = SUBSTR(%RX(%i),1,35) + %v_61850_Ident(%i-1)
               @IN(2..6) = ""
               #IF %b_Fill_IN #THEN @IN(%i) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + substr(%v_61850_Ident(%i-1), 5 , 0)
            #BLOCK_END
            #if %i == 6 #then #block
               @i_tmp_count = %i + 100
               @i_Tmp_IX = 16
            #block_end
            #else #block
               @i_tmp_count = %i
               @i_Tmp_IX = %i
            #block_end
            @P_OBJ0'i_tmp_count'_LIST = LIST(-
                  IX = 29+%i_Tmp_IX,-                    ;index = 31,32,33,34
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  IN = %IN(%I),-                         ;
                  RX = %RX('I'))                         ;data acquisition unit and group information
   
            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK 
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
              @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 229+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information
             #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'i_tmp_count'=%P_OBJ0'i_tmp_count'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 4 x binary outputs

        ;secured control with four binary outputs
        #WHEN "SEC-4BO" #BLOCK

          ;output objects for control commands (open/close/execute/cancel)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(2..5) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..5) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..5) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..5) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..5) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..5) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..5) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(2..5) ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..205)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(2..5) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(2..5) ="E1"
            #BLOCK_END
          #CASE_END

          @OX(2)=FPI_SSW:VTR_OPEN_SEL                    ;signal text for open select
          @OX(3)=FPI_SSW:VTR_CLOSE_SEL                   ;signal text for close select
          @OX(4)=FPI_SSW:VTR_EXEC_CMD                    ;signal text for execute
          @OX(5)=FPI_SSW:VTR_CANCEL_CMD                  ;signal text for cancel
          @RI(2)=25                                      ;dynamic text for open select printout
          @RI(3)=26                                      ;dynamic text for close select printout
          @RI(4)=27                                      ;dynamic text for execute printout
          @RI(5)=28                                      ;dynamic text for cancel printout
          @RX(2..5) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=2..5
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 29+%I,-                           ;index = 31,32,33,34
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information
   
            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK 
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
              @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 229+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information
             #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 4 x binary outputs

        ;secured control with two binary outputs
        #WHEN "SEC-2BO" #BLOCK

          ;output objects for control commands (open execute/close execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(2..3) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..3) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..3) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..3) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..3) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..3) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..3) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(2..3) ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..203)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(2..3) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(2..5) ="E1"
            #BLOCK_END

          #CASE_END

          @OX(2)=FPI_SSW:VTR_OPEN_EXEC                   ;signal text for open execute
          @OX(3)=FPI_SSW:VTR_CLOSE_EXEC                  ;signal text for close execute
          @RI(2)=30                                      ;dynamic text for open execute printout
          @RI(3)=31                                      ;dynamic text for close execute printout
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK
            @RI(2..3)=29                                 ;dynamic text for open/close execute printout
          #BLOCK_END
          #ELSE #BLOCK
            @RI(2)=30                                     ;dynamic text for open execute printout
            @RI(3)=31                                     ;dynamic text for close execute printout
          #BLOCK_END
          @RX(2..3) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=2..3
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 29+%I,-                           ;index = 31,32
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
                  @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 229+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information
             #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
             #BLOCK_END
             #BLOCK_END
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 2 x binary outputs

        ;secured control with two digital outputs
        #WHEN "SEC-2DO" #BLOCK

          ;output objects for control commands (open execute/close execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(2..3) ="N3"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(2..3) ="X3"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(2..3) ="C7"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(2..3) ="7"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(2..3) ="O7"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(2..3) ="I3"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(2..3) ="R3"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(2..3) ="I3"            
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(2..3) ="E3"
            #BLOCK_END

          #CASE_END

          @OX(2)=FPI_SSW:VTR_OPEN_EXEC                   ;signal text for open execute
          @OX(3)=FPI_SSW:VTR_CLOSE_EXEC                  ;signal text for close execute
          @RI(2)=7                                       ;dynamic text for open execute printout
          @RI(3)=8                                       ;dynamic text for close execute printout
          @RX(2..3) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=2..3
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 29+%I,-                           ;index = 31,32
                  PT = 7,-                               ;process object type = DO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 50)                               ;type identification (ASDU) 50 = set point command, short floating point
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 2 x digital outputs

        ;secured control with a single binary output
        #WHEN "SEC-BO" #BLOCK

          ;output object for control commands (select & execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(4)    ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(4)    ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(4)    ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(4)    ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(4)    ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(4)    ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(4)    ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(4)    ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(104)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(4)    ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(4)    ="E1"
            #BLOCK_END

          #CASE_END

          @RX(4) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -      ;function block or channel number, data acquisition unit
                   "FP'XX''YY'COBC"                      ;and group information

          @P_OBJ04_LIST = LIST(-
                IX = 33,-                                ;index = 33
                PT = 5,-                                 ;process object type = BO
                DX = %DX(4),-                            ;directive text
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = FPI_SSW:VTR_OBJ_CMD,-               ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 29,-                                ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device = 1
                RX = %RX(4))                             ;data acquisition unit and group information

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "IEC101", "ICCP" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 46)                                 ;type identification (ASDU) 45 = single command, 46 = double command
            #WHEN "IEC103" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 0)                                 ;type identification (ASDU) 20 = general command
            #WHEN "DNP_30" #BLOCK
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
                 @TMP_INDEX = 204
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 233,-                                 ;index = 111,112,113,114
              PT = 3,-                                   ;process object type = AI
              DX = "D3T",-                               ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VTR_OBJ_CMD,-                 ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(4))                             ;data acquisition unit and group information
             #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
            #BLOCK_END
          #CASE_END
          #MODIFY P_OBJECTS:V = LIST(P_OBJ04=%P_OBJ04_LIST)
        #BLOCK_END                                       ;secured control/ a single binary output

        ;direct control with a single binary output
        #WHEN "DIR-BO" #BLOCK

          ;output object for control commands (open & close)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(4)    ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(4)    ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(4)    ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(4)    ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(4)    ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(4)    ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(4)    ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(4)    ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(104)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(4)    ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(4)    ="E1"
            #BLOCK_END

          #CASE_END

          @RX(4) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -      ;function block or channel number, data acquisition unit
                   "FP'XX''YY'COBC"                      ;and group information

          @P_OBJ04_LIST = LIST(-
                IX = 33,-                                ;index = 33
                PT = 5,-                                 ;process object type = BO
                DX = %DX(4),-                            ;directive text
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = FPI_SSW:VTR_OBJ_CMD,-               ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 29,-                                ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device = 1
                RX = %RX(4))                             ;data acquisition unit and group information

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "IEC101", "ICCP" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 45)                                 ;type identification (ASDU) 45 = single command, 46 = double command
            #WHEN "IEC103" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 0)                                 ;type identification (ASDU) 20 = general command
            #WHEN "DNP_30" #BLOCK
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
                 @TMP_INDEX = 104
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 233,-                                 ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = "D3T",-                               ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VTR_OBJ_CMD,-                 ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(4))                               ;data acquisition unit and group information
             #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
            #BLOCK_END
          #CASE_END
          #MODIFY P_OBJECTS:V = LIST(P_OBJ04=%P_OBJ04_LIST)
        #BLOCK_END                                       ;direct control/ a single binary output

        ;control with a single analog output
        #WHEN "AO" #BLOCK

          ;output object for control commands (select open/close and execute/cancel or open/close execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(4)    ="N4"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(4)    ="X4"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(4)    ="C11"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(4)    ="11"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(4)    ="O5"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(4)    ="I4"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(4)    ="R4"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(4)    ="D11"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(4)    ="I4"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(4)    ="E4"
            #BLOCK_END

          #CASE_END

          @RX(4) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -      ;function block or channel number, data acquisition unit
                   "FP'XX''YY'COBC"                      ;and group information

          @P_OBJ04_LIST = LIST(-
                IX = 33,-                                ;index = 33
                PT = 11,-                                ;process object type = AO
                DX = %DX(4),-                            ;directive text
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = FPI_SSW:VTR_OBJ_CMD,-               ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                HO = 0,-                                 ;high alarm limit = 0
                LO = 0,-                                 ;low alarm limit = 0
                ST = "Command",-                         ;unit of value
                SN = "1_1",-                             ;scale name
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 4,-                                 ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device = 1
                RX = %RX(4))                             ;data acquisition unit and group information

          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "IEC101", "ICCP" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 50)                                 ;type identification (ASDU) 48 = set point cmd, normalized value, 49 = set point cmd, scaled valueed value, 50 = set point cmd, short floating point number
            #WHEN "IEC103" #MODIFY P_OBJ04_LIST:V = LIST(-
                TY = 0)                                 ;type identification (ASDU) 20 = general command
          #CASE_END
          #MODIFY P_OBJECTS:V = LIST(P_OBJ04=%P_OBJ04_LIST)
        #BLOCK_END                                       ;control/ a single analog output
      #CASE_END                                          ;control type

      ;input objects for external control blocking and open/close interlocking 
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(6..8)   ="N7S"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(6..8)   ="X7S"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(6..8)   ="C3"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(6..8)   ="3"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(6..8)   ="O1"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(6..8) ="I7S" 
            @HE(6..8) = 0                                ;history enable = no
            @PF(6..8) = "DUMMY"                          ;physical format for printout
            @LD(6..8) = 0                                ;listing device = none
          #BLOCK_END

          #ELSE #BLOCK
            @DX(6..8) ="I7S" 
            @HE(6..8) = 1                                ;history enable = yes
            @PF(6..8) = "FORM5SAGR1"                     ;physical format for printout
            @LD(6..8) = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(6..8) ="R7S"
            @HE(6..8) = 0                                ;history enable = no
            @PF(6..8) = "DUMMY"                          ;physical format for printout
            @LD(6..8) = 0                                ;listing device = none
          #BLOCK_END

          #ELSE #BLOCK
            @DX(6..8) ="R7S"
            @HE(6..8) = 1                                ;history enable = yes
            @PF(6..8) = "FORM5SAGR1"                     ;physical format for printout
            @LD(6..8) = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(6..8) ="D3" 
            @HE(6..8) = 0                                ;history enable = yes
            @PF(6..8) = "DUMMY"                          ;physical format for printout
            @LD(6..8) = 0                                ;listing device = 1
          #BLOCK_END

          #ELSE #BLOCK
            @DX(6..8) ="D3" 
            @HE(6..8) = 1                                ;history enable = yes
            @PF(6..8) = "FORM5SAGR1"                     ;physical format for printout
            @LD(6..8) = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "MODBUS_RTU" #BLOCK
            @DX(6..8) ="I7S" 
            @HE(6..8) = 1                                ;history enable = yes
            @PF(6..8) = "FORM5SAGR1"                     ;physical format for printout
            @LD(6..8) = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

       #WHEN "IEC61850" #BLOCK
          @DX(6)      ="E6"
          @DX(7..8)   ="E7S"
          @HE(6..8)   = 1                                ;history enable = yes
          @PF(6)      = "FORM5SAGR1"                     ;physical format for printout
          @PF(7..8)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(6..8)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END
      #CASE_END

      @OX(6)=FPI_SSW:VTR_EXT_CNTR_BLK                    ;signal text for external interlocking
      @OX(7)=FPI_SSW:VTR_OPEN_ILOCKED                    ;signal text for open interlocked
      @OX(8)=FPI_SSW:VTR_CLOSE_ILOCKED                   ;signal text for close interlocked
      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
         @RI(7..8)=43
      #BLOCK_END
      #ELSE @RI(6..8)=18                                 ;dynamic text for object printout
      @RX(6)    = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'IBLK"                       ;and group information
      @RX(7..8) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'IINH"                       ;and group information

      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
       
        @RX(6) = SUBSTR(%RX(6),1,35) + "CSWI.Beh.stVal"
        #IF %b_Fill_IN #THEN @IN(1) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Beh.stVal"
        #ELSE @IN(1) = ""

        #MODIFY P_OBJECTS:V = LIST(P_OBJ06 = LIST(-
          IX = 35,-                                      ;index = 15
          PT = 9,-                                       ;process object type = AI
          DX = %DX(6),-                                  ;directive text
          AI = 1,-                                       ;object value = 0
          OI = %OBJ_IDENT,-                              ;substation & bay name
          OX = %OX(6),-                                  ;object text
          IU = 1,-                                       ;in use = yes
          SS = 1,-                                       ;switch state = auto
          EE = 1,-                                       ;event enable = yes
          HE = 1,-                                       ;history enable = no
          HA = 1,-                                       ;history activation = update
          HF = 0,-                                       ;history at first update = yes
          HL = BIT_MASK(15),-                            ;history log number = 15
          HI = 0,-                                       ;upper alarm limit = 0
          HW = 0,-                                       ;upper warning limit = 0
          LW = 0,-                                       ;lower warning limit = 0
          LI = 0,-                                       ;lower alarm limit = 0
          ST = "Blocking",-                              ;unit of value
          SN = "1_1",-                                   ;scale name
          SZ = 1,-                                       ;zone supervision = SCADA
          RC = 0,-                                       ;receipt = acknowledgement not required
          AB = 0,-                                       ;alarm blocking = no
          AC = 0,-                                       ;alarm class = disabled
          AD = 0,-                                       ;alarm delay = 0
          PD = 0,-                                       ;picture device = none
          PI = "",-                                      ;alarm picture
          PF = %PF(6),-                                  ;physical format for printout
          RI = 16,-                                      ;dynamic texts for printout
          PA = 1,-                                       ;printout activation = update
          PU = 0,-                                       ;picture/ printout at first update = yes
          LD = 0,-                                       ;listing device = none
          IN = %IN(1),-                                  ;
          RX = %RX(6)))                                  ;group information

       #BLOCK_END

      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
         @I_LOOP_START = 7
         @RX(7) = SUBSTR(%RX(7),1,35) + "CILO.EnaOpn.stVal"
         @RX(8) = SUBSTR(%RX(8),1,35) + "CILO.EnaCls.stVal"
         #IF %b_Fill_IN #THEN #BLOCK
            @IN(7) = %t_OPC_Prefix + "." + %v_CILO_Instance(1) + ".EnaOpn.stVal"
            @IN(8) = %t_OPC_Prefix + "." + %v_CILO_Instance(1) + ".EnaCls.stVal"
         #BLOCK_END
         #ELSE @IN(7..8) = ""
         @i_Default_OV = 1
      #BLOCK_END
      #ELSE #BLOCK
         @I_LOOP_START = 6
         @i_Default_OV = 0
         @IN(7..8) = ""
      #BLOCK_END

      #LOOP_WITH I=%I_LOOP_START..8
        #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I' = LIST(-
              IX = 29+%I,-                               ;index = 35,36,37
              PT = 3,-                                   ;process object type = BI
              DX = %DX('I'),-                            ;directive text
              BI = %i_Default_OV,-                       ;object value
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX('I'),-                            ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = %HE('I'),-                            ;history enable
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 1,-                                   ;receipt = acknowledgement required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class 
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = %PF('I'),-                            ;physical format for printout
              RI = %RI('I'),-                            ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = %LD('I'),-                            ;listing device
              IN = %IN(%I),-
              RX = %RX('I')))                            ;group information
      #LOOP_END

      ;external interlocking cause
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(9)   ="N6"
        #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(9)   ="X6"
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(9)   ="C9"
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(9)   ="9"
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(9)   ="O2"
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          @DX(9)   ="I6"
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          @DX(9)   ="R6"
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
          @DX(9)   ="D9"
        #BLOCK_END

        #WHEN "MODBUS_RTU" #BLOCK
          @DX(9)   ="I6"
        #BLOCK_END

        #WHEN "IEC61850" #BLOCK
          @DX(9)   ="E6"
        #BLOCK_END
      #CASE_END

      @RX(9) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -          ;function block or channel number, data acquisition unit
               "FP'XX''YY'IINH"                          ;and group information

      #MODIFY P_OBJECTS:V = LIST(P_OBJ09 = LIST(-
            IX = 38,-                                    ;index = 38
            PT = 9,-                                     ;process object type = AI
            DX = %DX(9),-                                ;directive text
            AI = 0,-                                     ;object value = 0
            OI = %OBJ_IDENT,-                            ;substation & bay name
            OX = FPI_SSW:VTR_ILOCK_CAUSE,-               ;object text
            IU = 1,-                                     ;in use = yes
            SS = 2,-                                     ;switch state = auto
            EE = 1,-                                     ;event enable = yes
            HE = 0,-                                     ;history enable = no
            HA = 2,-                                     ;history activation = update
            HF = 1,-                                     ;history at first update = yes
            HL = BIT_MASK(15),-                          ;history log number = 15
            HI = 0,-                                     ;upper alarm limit = 0
            HW = 0,-                                     ;upper warning limit = 0
            LW = 0,-                                     ;lower warning limit = 0
            LI = 0,-                                     ;lower alarm limit = 0
            ST = "Cause",-                               ;unit of value
            SN = "1_1",-                                 ;scale name
            SZ = 1,-                                     ;zone supervision = SCADA
            RC = 0,-                                     ;receipt = acknowledgement not required
            AB = 0,-                                     ;alarm blocking = no
            AC = 0,-                                     ;alarm class = disabled
            AD = 0,-                                     ;alarm delay = 0
            PD = 0,-                                     ;picture device = none
            PI = "",-                                    ;alarm picture
            PF = "",-                                    ;physical format for printout
            RI = 0,-                                     ;dynamic texts for printout
            PA = 2,-                                     ;printout activation = update
            PU = 1,-                                     ;picture/ printout at first update = yes
            LD = 0,-                                     ;listing device = none
            RX = %RX(9)))                                ;data acquisition unit and group information

    #BLOCK_END                                           ;motorized

    ;selection on monitor
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
      #WHEN "SPA" #BLOCK
        @DX(10)   ="N6"
      #BLOCK_END

      #WHEN "LON","LONMARK" #BLOCK
        @DX(10)   ="X6"
      #BLOCK_END

      #WHEN "IEC101","IEC103", "ICCP" #BLOCK
        @DX(10)   ="C9"
      #BLOCK_END

      #WHEN "ANSI" #BLOCK
        @DX(10)   ="9"
      #BLOCK_END

      #WHEN "PROC" #BLOCK
        @DX(10)   ="O2"
      #BLOCK_END

      #WHEN "RTU" #BLOCK
        @DX(10)   ="I6"
      #BLOCK_END

      #WHEN "RTU_E" #BLOCK
        @DX(10)   ="R6"
      #BLOCK_END

      #WHEN "DNP_30" #BLOCK
        @DX(10)   ="D9"
      #BLOCK_END

      #WHEN "MODBUS_RTU" #BLOCK
        @DX(10)   ="I6"
      #BLOCK_END

      #WHEN "IEC61850" #BLOCK
        @DX(10)   ="E6"
      #BLOCK_END

    #CASE_END

    @RX(10) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -           ;function block or channel number, data acquisition unit
              "FP'XX''YY'XMEV"                           ;and group information

    #MODIFY P_OBJECTS:V = LIST(P_OBJ10 = LIST(-
          IX = 39,-                                      ;index = 39
          PT = 9,-                                       ;process object type = AI
          DX = %DX(10),-                                 ;directive text
          AI = 0,-                                       ;object value = 0
          OI = %OBJ_IDENT,-                              ;substation & bay name
          OX = FPI_SSW:VTR_SEL_ON_MON,-                  ;object text
          IU = 1,-                                       ;in use = yes
          SS = 2,-                                       ;switch state = auto
          EE = 1,-                                       ;event enable = yes
          HE = 0,-                                       ;history enable = no
          HA = 2,-                                       ;history activation = update
          HF = 1,-                                       ;history at first update = yes
          HL = BIT_MASK(15),-                            ;history log number = 15
          HI = 0,-                                       ;upper alarm limit = 0
          HW = 0,-                                       ;upper warning limit = 0
          LW = 0,-                                       ;lower warning limit = 0
          LI = 0,-                                       ;lower alarm limit = 0
          ST = "Sessions",-                              ;unit of value
          SN = "1_1",-                                   ;scale name
          SZ = 1,-                                       ;zone supervision = SCADA
          RC = 0,-                                       ;receipt = acknowledgement not required
          AB = 0,-                                       ;alarm blocking = no
          AC = 0,-                                       ;alarm class = disabled
          AD = 0,-                                       ;alarm delay = 0
          PD = 0,-                                       ;picture device = none
          PI = "",-                                      ;alarm picture
          PF = "",-                                      ;physical format for printout
          RI = 0,-                                       ;dynamic texts for printout
          PA = 2,-                                       ;printout activation = update
          PU = 1,-                                       ;picture/ printout at first update = yes
          LD = 0,-                                       ;listing device = none
          RX = %RX(10)))                                 ;group information

    ;if motorized truck
    #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK
 
      ;input object for command event
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(11)    ="N7S"
          @HE(11)    = 0                                 ;history enable = yes
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
         #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(11)    ="X7S"
          @HE(11)    = 0                                 ;history enable = yes
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(11)    ="C3"
          @HE(11)    = 0                                 ;history enable = yes
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(11)    ="3"
          @HE(11)    = 0                                 ;history enable = yes
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(11)    ="O1"
          @HE(11)    = 0                                 ;history enable = yes
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(11)  ="I7S" 
            @HE(11)  = 0                                 ;history enable = no
            @PF(11)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(11)  ="I7S" 
            @HE(11)  = 1                                 ;history enable = yes
            @PF(11)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(11)  ="R7S"
            @HE(11)  = 0                                 ;history enable = no
            @PF(11)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(11)  ="R7S"
            @HE(11)  = 1                                 ;history enable = yes
            @PF(11)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(11)  ="D3" 
            @HE(11)  = 0                                 ;history enable = yes
            @PF(11)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

           #ELSE #BLOCK
            @DX(11)  ="D3" 
            @HE(11)  = 1                                 ;history enable = yes
            @PF(11)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "MODBUS_RTU" #BLOCK
            @DX(11)  ="I7S" 
            @HE(11)  = 1                                 ;history enable = yes
            @PF(11)  = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "IEC61850" #BLOCK
          @DX(11)    ="E7S"
          @HE(11)    = 0                                 ;history enable = yes
          @PF(11)    = "FORM5SAGR1"                      ;physical format for printout
         #BLOCK_END
      #CASE_END

      @RX(11) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -         ;function block or channel number, data acquisition unit
                "FP'XX''YY'ICEV"                         ;and group information

      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
         @RX(11) = SUBSTR(%RX(11),1,35) + "CSWI.Pos.stSeld"
         #IF %b_Fill_IN #THEN @IN(1) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Pos.stSeld"
         #ELSE @IN(1) = ""
      #BLOCK_END

      #MODIFY P_OBJECTS:V = LIST(P_OBJ11 = LIST(-
            IX = 40,-                                    ;index = 40
            PT = 3,-                                     ;process object type = BI
            DX = %DX(11),-                               ;directive text
            BI = 0,-                                     ;object value
            OI = %OBJ_IDENT,-                            ;substation & bay name
            OX = FPI_SSW:VTR_CMD_EVENT,-                 ;object text
            IU = 1,-                                     ;in use = yes
            SS = 2,-                                     ;switch state = auto
            EE = 1,-                                     ;event enable = yes
            HE = %HE(11),-                               ;history enable
            HA = 1,-                                     ;history activation = new value
            HF = 0,-                                     ;history at first update = no
            HL = BIT_MASK(15),-                          ;history log number = 15
            RC = 1,-                                     ;receipt = acknowledgement required
            AB = 0,-                                     ;alarm blocking = no
            AC = 0,-                                     ;alarm class 
            AG = 0,-                                     ;alarming value = 0
            AD = 0,-                                     ;alarm delay = disabled
            PD = 0,-                                     ;picture device = none
            PI = "",-                                    ;alarm picture
            PF = %PF(11),-                               ;physical format for printout
            RI = 19,-                                    ;dynamic texts for printout
            PA = 1,-                                     ;printout activation = new value
            PU = 0,-                                     ;picture/ printout at first update = no
            LD = 0,-                                     ;listing device = none
            IN = %IN(1),-
            RX = %RX(11)))                               ;data acquisition unit and group information
 
    #BLOCK_END                                           ;motorized

    ;position indication other than double indication
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE

      ;analog input
      #WHEN "AI" #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(12)   ="N6"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(12)   ="X6"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(12)   ="C9"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(12)   ="9"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(12)   ="O2"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(12)   ="I6"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(12)   ="R6"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(12)   ="D9"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(12)   ="I6"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(12)   ="E6"
          #BLOCK_END
        #CASE_END

        @RX(12) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'EPOS"                       ;and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ12 = LIST(-
              IX = 130,-                                 ;index = 130
              PT = 9,-                                   ;process object type = AI
              DX = %DX(12),-                             ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VTR_POS_IND,-                 ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "POS",-                               ;unit of value
              SN = "BGU_1_1000",-                        ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              AN = "BGU_AI2DB",-                         ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(12)))                             ;data acquisition unit and group information

      #BLOCK_END                                         ;analog input

      ;binary input
      #WHEN "BI" #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(12)   ="N7S"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(12)   ="X7S"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(12)   ="C3"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(12)   ="3"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(12)   ="O1"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(12)   ="I7S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(12)   ="R7S"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(12)   ="D3"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(12)   ="I7S"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(12)   ="E7S"
          #BLOCK_END

        #CASE_END

        @RX(12) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'EPOS"                       ;and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ12 = LIST(-
              IX = 130,-                                 ;index = 130
              PT = 3,-                                   ;process object type = BI
              DX = %DX(12),-                             ;directive text
              BI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VTR_POS_IND,-                 ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_BI2DB",-                         ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(12)))                             ;data acquisition unit and group information

      #BLOCK_END                                         ;binary input

      ;two binary inputs
      #WHEN "2BI" #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(12..13)   ="N7S"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(12..13)   ="X7S"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(12..13)   ="C3"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(12..13)   ="3"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(12..13)   ="O1"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(12..13)   ="I7S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(12..13)   ="R7S"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(12..13)   ="D3"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(12..13)   ="I7S"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(12..13)   ="E7S"
          #BLOCK_END

        #CASE_END

        @OX(12)=FPI_SSW:VTR_OPEN_IND                     ;signal text for open indication
        @OX(13)=FPI_SSW:VTR_CLOSE_IND                    ;signal text for close indication
        @RX(12..13) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EPOS"                   ;and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ12 = LIST(-
              IX = 130,-                                 ;index = 130
              PT = 3,-                                   ;process object type = BI
              DX = %DX(12),-                             ;directive text
              BI = 0,-                                   ;object value = 0
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(12),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_2BI2DB",-                        ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(12)))                             ;data acquisition unit and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ13 = LIST(-
              IX = 128,-                                 ;index = 128
              PT = 3,-                                   ;process object type = BI
              DX = %DX(13),-                             ;directive text
              BI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(13),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_2BI2DB",-                        ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(13)))                             ;data acquisition unit and group information
      #BLOCK_END                                         ;two binary inputs
    #CASE_END                                            ;indication type

 ;** TiLi 07.01.2004 additional faulty indication for DNP 3.0 and MODBUS
    #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK

       #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "DNP_30" #BLOCK
            @DX(24)   ="D3"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(24)   ="I7S"
          #BLOCK_END
        #CASE_END

        @OX(24)=FPI_SSW:VTR_FAULTY_IND               ;signal text for close indication

       @RX(24) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EPOS"                   ;and group information

       #MODIFY P_OBJECTS:V = LIST(P_OBJ24 = LIST(-
              IX = 126,-                                 ;index = 126
              PT = 3,-                                   ;process object type = BI
              DX = %DX(24),-                             ;directive text
              BI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(24),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_1TO3",-                          ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(24)))                             ;data acquisition unit and group information
    #BLOCK_END
    ;** TiLi END

    ;event recording objects
    #IF ('ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="RTU" OR -
        'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="RTU_E" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30") AND -
        'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK

      ;event recording object for position indication (DB)
      #IF 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE=="DB" #THEN #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "RTU" #BLOCK
            @DX(12)    ="I10D"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(12)    ="R10D"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(12)    ="D12"
          #BLOCK_END
        #CASE_END

        @RX(12) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'EPOS"                       ;and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ12 = LIST(-
              IX = 130,-                                 ;index = 130
              PT = 12,-                                  ;process object type = DB
              DX = %DX(12),-                             ;directive text
              NV = 4,-                                   ;normal value = none
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VTR_POS_IND,-                 ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 1,-                                   ;history enable = yes
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              LA = 0,-                                   ;alarm activation = none
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "FORM5SAGR1",-                        ;physical format for printout
              RI = 6,-                                   ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = BIT_MASK(1),-                         ;listing device = 1
              RX = %RX(12)))                             ;data acquisition unit and group information

      #BLOCK_END                                         ;double binary

      ;if motorized truck
      #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

        ;event recording objects for external control blocking and open/close interlocking 
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "RTU" #BLOCK
            @DX(14..16)    ="I10S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(14..16)    ="R10S"
          #BLOCK_END

           #WHEN "DNP_30" #BLOCK
            @DX(14..16)    ="D3"
          #BLOCK_END
        #CASE_END

        @OX(14)=FPI_SSW:VTR_EXT_CNTR_BLK                 ;signal text for external interlocking
        @OX(15)=FPI_SSW:VTR_OPEN_ILOCKED                 ;signal text for open interlocked
        @OX(16)=FPI_SSW:VTR_CLOSE_ILOCKED                ;signal text for close interlocked
        @RI(14..16)=18                                   ;dynamic text for object printout

        @RX(14)     = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EBLK"                   ;and group information
        @RX(15..16) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EINH"                   ;and group information

        #LOOP_WITH I=14..16
          #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
                IX = 121+%I,-                            ;index = 135,136,137
                PT = 3,-                                 ;process object type = BI
                DX = %DX('I'),-                          ;directive text
                BI = 0,-                                 ;object value
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX('I'),-                          ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class 
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI('I'),-                          ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX('I')))                          ;data acquisition unit and group information
        #LOOP_END

      #BLOCK_END                                         ;motorized

      ;position indication other than double indication
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE

        ;event recording object for position indication of the analog input (AI) type
        #WHEN "AI" #BLOCK
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "RTU" #BLOCK
              @DX(17)   ="I11"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(17)   ="R11"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(17)   ="D9"
            #BLOCK_END
          #CASE_END

          @RX(17) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -     ;function block or channel number, data acquisition unit
                    "FP'XX''YY'EPOS"                     ;and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ17 = LIST(-
                IX = 230,-                               ;index = 230
                PT = 9,-                                 ;process object type = AI
                DX = %DX(17),-                           ;directive text
                AI = 1,-                                 ;object value = 1
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = FPI_SSW:VTR_POS_IND,-               ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                HI = 0,-                                 ;upper alarm limit = 0
                HW = 0,-                                 ;upper warning limit = 0
                LW = 0,-                                 ;lower warning limit = 0
                LI = 0,-                                 ;lower alarm limit = 0
                ST = "POS",-                             ;unit of value
                SN = "1_1",-                             ;scale name
                SZ = 1,-                                 ;zone supervision = SCADA
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 6,-                                 ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(17)))                           ;data acquisition unit and group information

        #BLOCK_END                                       ;analog input

        ;event recording object for position indication of the single binary input (BI) type
        #WHEN "BI" #BLOCK
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "RTU" #BLOCK
              @DX(17)   ="I10S"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(17)   ="R10S"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(17)   ="D3"
            #BLOCK_END
          #CASE_END

          @RX(17) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -     ;function block or channel number, data acquisition unit
                    "FP'XX''YY'EPOS"                     ;and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ17 = LIST(-
                IX = 230,-                               ;index = 230
                PT = 3,-                                 ;process object type = BI
                DX = %DX(17),-                           ;directive text
                BI = 0,-                                 ;object value
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = FPI_SSW:VTR_POS_IND,-               ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 20,-                                ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(17)))                           ;data acquisition unit and group information

        #BLOCK_END                                       ;binary input

        ;event recording object for position indication of two binary inputs (2xBI) type
        #WHEN "2BI" #BLOCK
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "RTU" #BLOCK
              @DX(17..18)   ="I10S"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(17..18)   ="R10S"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(17..18)   ="D3"
            #BLOCK_END
          #CASE_END

          @OX(17)=FPI_SSW:VTR_OPEN_IND                   ;signal text for open indication
          @OX(18)=FPI_SSW:VTR_CLOSE_IND                  ;signal text for close indication
          @RX(17..18) = %ADDITIONAL_IDENT+%UNIT_IDENT+ - ;function block or channel number, data acquisition unit
                        "FP'XX''YY'EPOS"                 ;and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ17 = LIST(-
                IX = 230,-                               ;index = 230
                PT = 3,-                                 ;process object type = BI
                DX = %DX(17),-                           ;directive text
                BI = 0,-                                 ;object value = 0
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(17),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 21,-                                ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(17)))                           ;data acquisition unit and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ18 = LIST(-
                IX = 228,-                               ;index = 228
                PT = 3,-                                 ;process object type = BI
                DX = %DX(18),-                           ;directive text
                BI = 1,-                                 ;object value = 1
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(18),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 22,-                                ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(18)))                           ;data acquisition unit and group information
        #BLOCK_END                                       ;two binary inputs
      #CASE_END                                          ;indication type
    #BLOCK_END                                           ;event recording

    ;command termination
    #IF ('ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="IEC101" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="IEC103" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30") AND 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

      ;control type
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VCONTROL_TYPE

        ;secured control with four binary outputs
        #WHEN "SEC-4BO" #BLOCK
          ;indexing
          @START_INDEX = 14
          @STOP_INDEX  = 17
          @OX(14)=FPI_SSW:VTR_OPEN_SEL                   ;signal text for open select
          @OX(15)=FPI_SSW:VTR_CLOSE_SEL                  ;signal text for close select
          @OX(16)=FPI_SSW:VTR_EXEC_CMD                   ;signal text for execute
          @OX(17)=FPI_SSW:VTR_CANCEL_CMD                 ;signal text for cancel
        #BLOCK_END

        ;secured control with two binary or digital outputs
        #WHEN "SEC-2BO","SEC-2DO" #BLOCK
          ;indexing
          @START_INDEX = 14
          @STOP_INDEX  = 15
          @OX(14)=FPI_SSW:VTR_OPEN_EXEC                  ;signal text for open execute
          @OX(15)=FPI_SSW:VTR_CLOSE_EXEC                 ;signal text for close execute
        #BLOCK_END

        ;secured control with a single binary or analog output/direct control with a single binary output  
        #WHEN "SEC-BO","AO","DIR-BO" #BLOCK
          ;indexing
          @START_INDEX = 16
          @STOP_INDEX  = 16
          @OX(16)=FPI_SSW:VTR_OBJ_CMD                    ;signal text for control object
        #BLOCK_END
      #CASE_END                                          ;control type

      @RX(%START_INDEX..%STOP_INDEX) = %ADDITIONAL_IDENT+ -  ;function block or channel number, data acquisition unit
          %UNIT_IDENT+"FP'XX''YY'TOBC"                   ;and group information

      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30" #THEN @TMP_DX = "D9E"
      #ELSE @TMP_DX = "C9E"

      #LOOP_WITH I=%START_INDEX..%STOP_INDEX
        #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
              IX = %I+117,-                              ;index = (131, 132,) 133 (,134)
              PT = 9,-                                   ;process object type = AI
              DX = %TMP_DX,-                             ;directive text
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX('I'),-                            ;object text
              IU = 1,-                                   ;in use = yes
              SS = 2,-                                   ;switch state = auto
              EE = 1,-                                   ;event enable = yes
              HE = 1,-                                   ;history enable
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "cmd status",-                        ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "FORM5SAGR1",-                        ;physical format for printout
              RI = 10,-                                  ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = BIT_MASK(1),-                         ;listing device
              RX = %RX('I')))                            ;data acquisition unit and group information

      #LOOP_END
    #BLOCK_END                                           ;IEC 870-5-101/103 and motorized

    ;if motorized truck
    #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

      ;interlocking cause (calculated by topological interlocking)
      #IF 'ID'_PICTURE_FUNCTION_CONF:VCREATE_TOPO_INTL_CAUSE #THEN #BLOCK

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(19)   ="N6"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(19)   ="X6"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(19)   ="C9"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(19)   ="9"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(19)   ="O2"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(19)   ="I6"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(19)   ="R6"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(19)   ="D9"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(19)   ="I6"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(19)   ="E6"
          #BLOCK_END

        #CASE_END

        @RX(19) = "                    FP'XX''YY'IINH"   ;group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ19 = LIST(-
              IX = 251,-                                 ;index = 251
              PT = 9,-                                   ;process object type = AI
              DX = %DX(19),-                             ;directive text
              AI = 0,-                                   ;object value = 0
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VINTL_CAUSE,-                 ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = auto
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "Cause",-                             ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = 0,-                                   ;listing device = none
              RX = %RX(19)))                             ;group information

      #BLOCK_END                                         ;topological interlocking
    #BLOCK_END                                           ;motorized
  #BLOCK_END                                             ;truck

  ;=====================================================================================================;
  ;three-state switch                                                                                   ;
  ;=====================================================================================================;
  #WHEN "Q3" #BLOCK
    ;initialize variables
    @DX
    @OX
    @HE
    @PF
    @RI
    @RX
    @LD
    @P_OBJ01
    @P_OBJ02
    @P_OBJ03
    @P_OBJ04
    @P_OBJ05
    @P_OBJ06
    @P_OBJ07
    @P_OBJ08
    @P_OBJ09
    @P_OBJ10
    @P_OBJ11
    @P_OBJ12
    @P_OBJ13
    @P_OBJ14
    @P_OBJ15
    @P_OBJ16
    @P_OBJ17
    @P_OBJ18
    @P_OBJ19
    @P_OBJ20
    @P_OBJ21
    @P_OBJ22
    @P_OBJ23
    @P_OBJ24
    @P_OBJ25
    @P_OBJ26
    @P_OBJ27
    @P_OBJ28
    @P_OBJ29
    @P_OBJ30
    @P_OBJ31
    @P_OBJ32
    @P_OBJ49              ;HoDa 16.11.2008 added for Tagout repr/symbol handling
    @P_OBJ50              ;HoDa 16.11.2008 added for Tagout event/log handling 
    @P_OBJECTS = LIST()

    ;define object to be created

    ;double binary for disconnector and earth switch position indication
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
      #WHEN "SPA" #BLOCK
        @DX(1..2)    ="N7D"
        @HE(1..2)    = 1                                 ;history enable = yes
        @PF(1..2)    = "FORM5SAGR1"                      ;physical format for printout
        @LD(1..2)    = BIT_MASK(1)                       ;listing device = 1
      #BLOCK_END

      #WHEN "LON","LONMARK" #BLOCK
        @DX(1..2)    ="X7D"
        @HE(1..2)    = 1                                 ;history enable = yes
        @PF(1..2)    = "FORM5SAGR1"                      ;physical format for printout
        @LD(1..2)    = BIT_MASK(1)                       ;listing device = 1
      #BLOCK_END

      #WHEN "IEC101","IEC103", "ICCP" #BLOCK
        @DX(1..2)    ="C12"
        @HE(1..2)    = 1                                 ;history enable = yes
        @PF(1..2)    = "FORM5SAGR1"                      ;physical format for printout
        @LD(1..2)    = BIT_MASK(1)                       ;listing device = 1
      #BLOCK_END

      #WHEN "ANSI" #BLOCK
        @DX(1..2)    ="12"
        @HE(1..2)    = 1                                 ;history enable = yes
        @PF(1..2)    = "FORM5SAGR1"                      ;physical format for printout
        @LD(1..2)    = BIT_MASK(1)                       ;listing device = 1
      #BLOCK_END

      #WHEN "PROC" #BLOCK
        @DX(1..2)    ="12"
        @HE(1..2)    = 1                                 ;history enable = yes
        @PF(1..2)    = "FORM5SAGR1"                      ;physical format for printout
        @LD(1..2)    = BIT_MASK(1)                       ;listing device = 1
      #BLOCK_END

      #WHEN "RTU" #BLOCK
        #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
          @DX(1..2)  ="I7D"
          @HE(1..2)  = 0                                 ;history enable = no
          @PF(1..2)  = "DUMMY"                           ;physical format for printout
          @LD(1..2)  = 0                                 ;listing device = none
        #BLOCK_END

        #ELSE #BLOCK
          @DX(1..2)  ="I7D"
          @HE(1..2)  = 1                                 ;history enable = yes
          @PF(1..2)  = "FORM5SAGR1"                      ;physical format for printout
          @LD(1..2)  = BIT_MASK(1)                       ;listing device = 1
        #BLOCK_END
      #BLOCK_END

      #WHEN "RTU_E" #BLOCK
        #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
          @DX(1..2)  ="R7D"
          @HE(1..2)  = 0                                 ;history enable = no
          @PF(1..2)  = "DUMMY"                           ;physical format for printout
          @LD(1..2)  = 0                                 ;listing device = none
        #BLOCK_END

        #ELSE #BLOCK
          @DX(1..2)  ="R7D"
          @HE(1..2)  = 1                                 ;history enable = yes
          @PF(1..2)  = "FORM5SAGR1"                      ;physical format for printout
          @LD(1..2)  = BIT_MASK(1)                       ;listing device = 1
        #BLOCK_END
      #BLOCK_END

      #WHEN "DNP_30" #BLOCK
        #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
          @DX(1..2)  ="D12"
          @HE(1..2)  = 0                                 ;history enable = yes
          @PF(1..2)  = "DUMMY"                           ;physical format for printout
          @LD(1..2)  = 0                                 ;listing device = 1
        #BLOCK_END

        #ELSE #BLOCK
          @DX(1..2)  ="D12"
          @HE(1..2)  = 1                                 ;history enable = yes
          @PF(1..2)  = "FORM5SAGR1"                      ;physical format for printout
          @LD(1..2)  = BIT_MASK(1)                       ;listing device = 1
        #BLOCK_END
      #BLOCK_END

      #WHEN "MODBUS_RTU" #BLOCK
          @DX(1..2)  ="I7D"
          @HE(1..2)  = 1                                 ;history enable = yes
          @PF(1..2)  = "FORM5SAGR1"                      ;physical format for printout
          @LD(1..2)  = BIT_MASK(1)                       ;listing device = 1
      #BLOCK_END

      #WHEN "IEC61850" #BLOCK
        @DX(1..2)    ="E7D"
        @HE(1..2)    = 1                                 ;history enable = yes
        @PF(1..2)    = "FORM5SAGR1"                      ;physical format for printout
        @LD(1..2)    = BIT_MASK(1)                       ;listing device = 1
      #BLOCK_END
    #CASE_END
    
    @RX(1..2) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -         ;function block or channel number, data acquisition unit
                "FP'XX''YY'IPOS"                         ;and group information
    @RX(1..2) = SUBSTR(%RX(1),1,35) + "CSWI.Pos.stVal"

    #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
       @RI(1)=21                                             ;dynamic text for disconnector section position indication printout
       @RI(2)=22                                             ;dynamic text for earth switch section position indication printout
      
       #if length(%v_CSWI_Instance) > 1 #then @RX(2) = SUBSTR(%RX(1),1,35) + "CSWI.Pos.stVal"
       #IF %b_Fill_IN #THEN #BLOCK
          @IN(1) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Pos.stVal"
          #if length(%v_CSWI_Instance) > 1 #then @IN(2) = %t_OPC_Prefix + "." + %v_CSWI_Instance(2) + ".Pos.stVal"
       #BLOCK_END
       #ELSE @IN(1..2) = ""
       
   #BLOCK_END
   #ELSE #BLOCK
       @RI(1)=7                                             ;dynamic text for disconnector section position indication printout
       @RI(2)=8                                             ;dynamic text for earth switch section position indication printout
       @IN(1..2) = ""
    #BLOCK_END
  
    #LOOP_WITH I=1..2

     #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I' = LIST(-
            IX = 9+%I,-                                  ;index = 10,11
            PT = 12,-                                    ;process object type = DB
            DX = %DX('I'),-                              ;directive text
            DB = %I,-                                    ;object value = 1, 2
            NV = 4,-                                     ;normal value = none
            OI = %OBJ_IDENT,-                            ;substation & bay name
            OX = FPI_SSW:VTSS_POS_IND,-                  ;object text
            IU = 1,-                                     ;in use = yes
            SS = 1,-                                     ;switch state = manual
            EE = 1,-                                     ;event enable = yes
            HE = %HE('I'),-                              ;history enable
            HA = 1,-                                     ;history activation = new value
            HF = 0,-                                     ;history at first update = no
            HL = BIT_MASK(15),-                          ;history log number = 15
            RC = 1,-                                     ;receipt = acknowledgement required
            AB = 0,-                                     ;alarm blocking = no
            AC = 1,-                                     ;alarm class = 1
            LA = 9,-                                     ;alarm activation = intermediate & faulty alarming
            AD = 0,-                                     ;alarm delay = 0
            PD = 0,-                                     ;picture device = none
            PI = "",-                                    ;alarm picture
            PF = %PF('I'),-                              ;physical format for printout
            RI = %RI('I'),-                              ;dynamic texts for printout
            PA = 1,-                                     ;printout activation = new value
            PU = 0,-                                     ;picture/ printout at first update = no
            LD = %LD('I'),-                              ;listing device
            IN = %IN(%I),-
            RX = %RX('I')))                              ;data acquisition unit and group information
    #LOOP_END

    ;if motorized three-state switch                  
    #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

      ;control objects
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VCONTROL_TYPE

        ;secured control with six binary outputs
        #WHEN "SEC-5AO" #BLOCK

          ;output objects for control commands (open/close/execute open/execute close/cancel)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX ="N4"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX ="X4"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX ="C11"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX ="11"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX ="O5"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX ="I4"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX ="R4"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
               @DX ="D11"
               ;#IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..205)="D9T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
               @DX ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
               @DX ="E4"
            #BLOCK_END

          #CASE_END

          @OX(3)=FPI_SSW:VTSS_OPEN_SEL                   ;signal text for open select
          @OX(4)=FPI_SSW:VTSS_CLOSE_SEL                  ;signal text for close select
          @OX(5)=FPI_SSW:VTSS_OPEN_EXEC                  ;signal text for open execute
          @OX(6)=FPI_SSW:VTSS_CLOSE_EXEC                 ;signal text for close execute
          @OX(7)=FPI_SSW:VTSS_CANCEL_CMD                 ;signal text for cancel
        
          @OX(8)=FPI_SSW:VTSS_FREE_SEL                   ;signal text for free select
          @OX(9)=FPI_SSW:VTSS_EARTH_SEL                  ;signal text for earth select
          @OX(10)=FPI_SSW:VTSS_FREE_EXEC                 ;signal text for free execute
          @OX(11)=FPI_SSW:VTSS_EARTH_EXEC                ;signal text for earth execute
          @OX(12)=FPI_SSW:VTSS_CANCEL_CMD                ;signal text for cancel

          @RI(3)=15                                      ;dynamic text for open select printout
          @RI(4)=15                                      ;dynamic text for close select printout
          @RI(5)=16                                      ;dynamic text for free select printout
          @RI(6)=16                                      ;dynamic text for earth select printout
          @RI(7)=17                                      ;dynamic text for execute printout

          @RI(8)=15                                      ;dynamic text for open select printout
          @RI(9)=15                                      ;dynamic text for close select printout
          @RI(10)=16                                     ;dynamic text for free select printout
          @RI(11)=16                                     ;dynamic text for earth select printout
          @RI(12)=17                                     ;dynamic text for execute printout

          @RX(3..12) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information
          @RI(9..12) = 0
          @IN(3..12) = ""

    @v_61850_Ident(1..5) = ("Pos.ctlSelOff", "Pos.ctlSelOn", "Pos.ctlOperOff", "Pos.ctlOperOn", "Pos.ctlCan")
          @v_61850_Ident(6..10) = ("Pos.ctlSelOff", "Pos.ctlSelOn", "Pos.ctlOperOff", "Pos.ctlOperOn", "Pos.ctlCan")

          #LOOP_WITH I=3..12

            #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK    

             @RX(%i) = SUBSTR(%RX(%i),1,35) + "CSWI.Pos" + %v_61850_Ident(%i-2)
              @IN(2..6) = ""
              #IF %b_Fill_IN #then #block
          #if %i-2 < 6 #then @IN(%i) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + "." + %v_61850_Ident(%i-2)
                #else #block
                  #if length(%v_CSWI_Instance) > 1 #then @IN(%i) = %t_OPC_Prefix + "." + %v_CSWI_Instance(2) + "." + %v_61850_Ident(%i-2)
                #block_end
              #block_end
            #BLOCK_END
            #if %i > 7 #then #block
               @i_tmp_count = %i + 100
               ;#if %i == 7 #then @i_Tmp_IX = 16
               ;#else @i_Tmp_IX = %i + 10
               @i_Tmp_IX = %i + 10
            #block_end
            #else #block
               @i_tmp_count = %i
               @i_Tmp_IX = %i
            #block_end
   
            @P_OBJ0'i_tmp_count'_LIST = LIST(-
                IX = 9+%i_Tmp_IX,-                       ;index = 13
                PT = 11,-                                ;process object type = AO
                DX = %DX,-                               ;directive text
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(%I),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                HO = 0,-                                 ;high alarm limit = 0
                LO = 0,-                                 ;low alarm limit = 0
                ST = "Command",-                         ;unit of value
                SN = "1_1",-                             ;scale name
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI(%I),-                           ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device = 1
                IN = %IN(%I),-                           ;IEC 61850 instance name
                RX = %RX(%I))                            ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
         #WHEN "DNP_30" #BLOCK 
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
                  @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information

                  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'i_tmp_count'=%P_OBJ0'i_tmp_count'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 6 x binary outputs

        ;secured control with six binary outputs
        #WHEN "SEC-4BO" #BLOCK

          ;output objects for control commands (open/close/free/earth/execute/cancel)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(3..8) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(3..8) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(3..8) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(3..8) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(3..8) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(3..8) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(3..8) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(3..8) ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(202..208)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK            
              @DX(3..8) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(3..8) ="E1"
            #BLOCK_END

          #CASE_END

          @OX(3)=FPI_SSW:VTSS_OPEN_SEL                   ;signal text for open select
          @OX(4)=FPI_SSW:VTSS_CLOSE_SEL                  ;signal text for close select
          @OX(5)=FPI_SSW:VTSS_FREE_SEL                   ;signal text for free select
          @OX(6)=FPI_SSW:VTSS_EARTH_SEL                  ;signal text for earth select
          @OX(7)=FPI_SSW:VTSS_EXEC_CMD                   ;signal text for execute
          @OX(8)=FPI_SSW:VTSS_CANCEL_CMD                 ;signal text for cancel
          @RI(3)=32                                      ;dynamic text for open select printout
          @RI(4)=33                                      ;dynamic text for close select printout
          @RI(5)=34                                      ;dynamic text for free select printout
          @RI(6)=35                                      ;dynamic text for earth select printout
          @RI(7)=36                                      ;dynamic text for execute printout
          @RI(8)=37                                      ;dynamic text for cancel printout
          @RX(3..8) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=3..8
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 9+%I,-                            ;index = 12,13,14,15,16,17
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
         #WHEN "DNP_30" #BLOCK 
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
                  @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information

                  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
         #BLOCK_END                              
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 6 x binary outputs

        ;secured control with four binary outputs
        #WHEN "SEC-2BO" #BLOCK

          ;output objects for control commands (open execute/close execute/free execute/earth execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(3..6) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(3..6) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(3..6) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(3..6) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(3..6) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(3..6) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(3..6) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(3..6) ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(203..206)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(3..6) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(3..8) ="E1"
            #BLOCK_END

          #CASE_END

          @OX(3)=FPI_SSW:VTSS_OPEN_EXEC                  ;signal text for open execute
          @OX(4)=FPI_SSW:VTSS_CLOSE_EXEC                 ;signal text for close execute
          @OX(5)=FPI_SSW:VTSS_FREE_EXEC                  ;signal text for free execute
          @OX(6)=FPI_SSW:VTSS_EARTH_EXEC                 ;signal text for earth execute
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK
            @RI(3..4) = 38
            @RI(5..6) = 39
          #BLOCK_END
          #ELSE #BLOCK
            @RI(3)=40                                      ;dynamic text for open execute printout
            @RI(4)=41                                      ;dynamic text for close execute printout
            @RI(5)=42                                      ;dynamic text for free execute printout
            @RI(6)=43                                      ;dynamic text for earth execute printout
          #BLOCK_END
          @RX(3..6) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=3..6
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 9+%I,-                            ;index = 12,13,14,15
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK 
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
                   @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 9,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information

                  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
               #BLOCK_END
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 4 x binary outputs

        ;secured control with four digital outputs
        #WHEN "SEC-2DO" #BLOCK

          ;output objects for control commands (open execute/close execute/free execute/earth execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(3..6) ="N7"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(3..6) ="X7"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(3..6) ="C7"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(3..6) ="7"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(3..6) ="O7"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(3..6) ="I7"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(3..6) ="R7"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(3..6) ="I7"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(3..6) ="E7"
            #BLOCK_END

          #CASE_END

          @OX(3)=FPI_SSW:VTSS_OPEN_EXEC                  ;signal text for open execute
          @OX(4)=FPI_SSW:VTSS_CLOSE_EXEC                 ;signal text for close execute
          @OX(5)=FPI_SSW:VTSS_FREE_EXEC                  ;signal text for free execute
          @OX(6)=FPI_SSW:VTSS_EARTH_EXEC                 ;signal text for earth execute
          @RI(3)=9                                       ;dynamic text for open execute printout
          @RI(4)=10                                      ;dynamic text for close execute printout
          @RI(5)=11                                      ;dynamic text for free execute printout
          @RI(6)=12                                      ;dynamic text for earth execute printout
          @RX(3..6) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=3..6
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 9+%I,-                            ;index = 12,13,14,15
                  PT = 7,-                               ;process object type = DO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 50)                               ;type identification (ASDU) 50 = set point command, short floating point
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 4 x digital outputs

        ;secured control with two binary outputs
        #WHEN "SEC-BO" #BLOCK

          ;output objects for control commands (select & execute disc. section/select & execute earth switch section)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(7..8) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(7..8) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(7..8) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(7..8) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(7..8) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(7..8) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(7..8) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(7..8) ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(207..208)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(7..8) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(7..8) ="E1"
            #BLOCK_END
          #CASE_END

          @OX(7..8)=FPI_SSW:VTSS_OBJ_CMD                 ;signal text for control object
          @RI(7)=38                                      ;dynamic text for control object printout
          @RI(8)=39                                      ;dynamic text for control object printout
          @RX(7..8) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=7..8
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 9+%I,-                            ;index = 16,17
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 46)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK 
                 #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
                   @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 3,-                                   ;process object type = AI
              DX = %DX(%I+200),-                         ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information

                  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
              #BLOCK_END
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;secured control/ 2 x binary outputs

        ;direct control with two binary outputs
        #WHEN "DIR-BO" #BLOCK

          ;output objects for control commands (select & execute disc. section/select & execute earth switch section)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(7..8) ="N1"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(7..8) ="X1"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(7..8) ="C5"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(7..8) ="5"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(7..8) ="O8"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(7..8) ="I1"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(7..8) ="R1"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(7..8) ="D5"
              #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(207..208)="D3T"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(7..8) ="I1"
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(7..8) ="E1"
            #BLOCK_END
          #CASE_END

          @OX(7..8)=FPI_SSW:VTSS_OBJ_CMD                 ;signal text for control object
          @RI(7)=38                                      ;dynamic text for control object printout
          @RI(8)=39                                      ;dynamic text for control object printout
          @RX(7..8) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=7..8
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 9+%I,-                            ;index = 16,17
                  PT = 5,-                               ;process object type = BO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 45)                               ;type identification (ASDU) 45 = single command, 46 = double command
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
              #WHEN "DNP_30" #BLOCK
             #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
                  @TMP_INDEX = %I + 100 
              @P_OBJ0'TMP_INDEX'_LIST = LIST(-
              IX = 209+%I,-                              ;index = 111,112,113,114
              PT = 3,-                                   ;process object type = AI
              DX = "D3T",-                               ;directive text
              AI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 0,-                                   ;history activation = alarm
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "",-                                  ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 0,-                                   ;printout activation = alarm
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device = none
              RX = %RX(%I))                             ;data acquisition unit and group information

                  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
                #BLOCK_END
              #BLOCK_END
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;direct control/ 2 x binary outputs

        ;control with two analog outputs
        #WHEN "AO" #BLOCK

          ;output objects for control commands (select open/close and execute/cancel or open/close execute)
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "SPA" #BLOCK
              @DX(7..8) ="N4"
            #BLOCK_END

            #WHEN "LON","LONMARK" #BLOCK
              @DX(7..8) ="X4"
            #BLOCK_END

            #WHEN "IEC101","IEC103", "ICCP" #BLOCK
              @DX(7..8) ="C11"
            #BLOCK_END

            #WHEN "ANSI" #BLOCK
              @DX(7..8) ="11"
            #BLOCK_END

            #WHEN "PROC" #BLOCK
              @DX(7..8) ="O5"
            #BLOCK_END

            #WHEN "RTU" #BLOCK
              @DX(7..8) ="I4"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(7..8) ="R4"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(7..8) ="D11"
            #BLOCK_END

            #WHEN "MODBUS_RTU" #BLOCK
              @DX(7..8) ="I4"            
            #BLOCK_END

            #WHEN "IEC61850" #BLOCK
              @DX(7..8) ="E4"
            #BLOCK_END
          #CASE_END

          @OX(7..8)=FPI_SSW:VTSS_OBJ_CMD                 ;signal text for control object
          @RI(7)=5                                       ;dynamic text for control object printout
          @RI(8)=6                                       ;dynamic text for control object printout
          @RX(7..8) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'COBC"                   ;and group information

          #LOOP_WITH I=7..8
            @P_OBJ0'I'_LIST = LIST(-
                  IX = 9+%I,-                            ;index = 16,17
                  PT = 11,-                              ;process object type = AO
                  DX = %DX('I'),-                        ;directive text
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = %OX('I'),-                        ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 1,-                               ;switch state = manual
                  EE = 1,-                               ;event enable = yes
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  HO = 0,-                               ;high alarm limit = 0
                  LO = 0,-                               ;low alarm limit = 0
                  ST = "Command",-                       ;unit of value
                  SN = "1_1",-                           ;scale name
                  RC = 0,-                               ;receipt = acknowledgement not required
                  AB = 0,-                               ;alarm blocking = no
                  AC = 0,-                               ;alarm class = disabled
                  AD = 0,-                               ;alarm delay = 0
                  PD = 0,-                               ;picture device = none
                  PI = "",-                              ;alarm picture
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device = 1
                  RX = %RX('I'))                         ;data acquisition unit and group information

            #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
              #WHEN "IEC101", "ICCP" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 50)                               ;type identification (ASDU) 48 = set point cmd, normalized value, 49 = set point cmd, scaled valueed value, 50 = set point cmd, short floating point number
              #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
                  TY = 0)                               ;type identification (ASDU) 20 = general command
            #CASE_END
            #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
          #LOOP_END
        #BLOCK_END                                       ;control/ 2 x analog outputs
      #CASE_END                                          ;control type

      ;input objects for external control blocking and open/close/free/earth interlocking 
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(9..13)   ="N7S"
          @HE(9..13)   = 1                               ;history enable = yes
          @PF(9..13)   = "FORM5SAGR1"                    ;physical format for printout
          @LD(9..13)   = BIT_MASK(1)                     ;listing device = 1
        #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(9..13)   ="X7S"
          @HE(9..13)   = 1                               ;history enable = yes
          @PF(9..13)   = "FORM5SAGR1"                    ;physical format for printout
          @LD(9..13)   = BIT_MASK(1)                     ;listing device = 1
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(9..13)   ="C3"
          @HE(9..13)   = 1                               ;history enable = yes
          @PF(9..13)   = "FORM5SAGR1"                    ;physical format for printout
          @LD(9..13)   = BIT_MASK(1)                     ;listing device = 1
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(9..13)   ="3"
          @HE(9..13)   = 1                               ;history enable = yes
          @PF(9..13)   = "FORM5SAGR1"                    ;physical format for printout
          @LD(9..13)   = BIT_MASK(1)                     ;listing device = 1
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(9..13)   ="O1"
          @HE(9..13)   = 1                               ;history enable = yes
          @PF(9..13)   = "FORM5SAGR1"                    ;physical format for printout
          @LD(9..13)   = BIT_MASK(1)                     ;listing device = 1
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(9..13) ="I7S" 
            @HE(9..13) = 0                               ;history enable = no
            @PF(9..13) = "DUMMY"                         ;physical format for printout
            @LD(9..13) = 0                               ;listing device = none
          #BLOCK_END

          #ELSE #BLOCK
            @DX(9..13) ="I7S" 
            @HE(9..13) = 1                               ;history enable = yes
            @PF(9..13) = "FORM5SAGR1"                    ;physical format for printout
            @LD(9..13) = BIT_MASK(1)                     ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(9..13) ="R7S"
            @HE(9..13) = 0                               ;history enable = no
            @PF(9..13) = "DUMMY"                         ;physical format for printout
            @LD(9..13) = 0                               ;listing device = none
          #BLOCK_END

          #ELSE #BLOCK
            @DX(9..13) ="R7S"
            @HE(9..13) = 1                               ;history enable = yes
            @PF(9..13) = "FORM5SAGR1"                    ;physical format for printout
            @LD(9..13) = BIT_MASK(1)                     ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(9..13) ="D3" 
            @HE(9..13) = 0                               ;history enable = yes
            @PF(9..13) = "DUMMY"                         ;physical format for printout
            @LD(9..13) = 0                               ;listing device = 1
          #BLOCK_END

          #ELSE #BLOCK
            @DX(9..13) ="D3" 
            @HE(9..13) = 1                               ;history enable = yes
            @PF(9..13) = "FORM5SAGR1"                    ;physical format for printout
            @LD(9..13) = BIT_MASK(1)                     ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "MODBUS_RTU" #BLOCK
            @DX(9..13) ="I7S" 
            @HE(9..13) = 1                               ;history enable = yes
            @PF(9..13) = "FORM5SAGR1"                    ;physical format for printout
            @LD(9..13) = BIT_MASK(1)                     ;listing device = 1
         #BLOCK_END

         #WHEN "IEC61850" #BLOCK
          @DX(9..13)   ="E7S"
          @HE(9..13)   = 1                               ;history enable = yes
          @PF(9..13)   = "FORM5SAGR1"                    ;physical format for printout
          @LD(9..13)   = BIT_MASK(1)                     ;listing device = 1
        #BLOCK_END

      #CASE_END                  

      @OX(9) =FPI_SSW:VTSS_EXT_CNTR_BLK                  ;signal text for external interlocking
      @OX(10)=FPI_SSW:VTSS_OPEN_ILOCKED                  ;signal text for open interlocked
      @OX(11)=FPI_SSW:VTSS_CLOSE_ILOCKED                 ;signal text for close interlocked
      @OX(12)=FPI_SSW:VTSS_FREE_ILOCKED                  ;signal text for free interlocked
      @OX(13)=FPI_SSW:VTSS_EARTH_ILOCKED                 ;signal text for earth interlocked
      @RI(9..13)=23                                      ;dynamic text for object printout

      @RX(9)      = %ADDITIONAL_IDENT+%UNIT_IDENT+ -     ;function block or channel number, data acquisition unit
                    "FP'XX''YY'IBLK"                     ;and group information
      @RX(10..13) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -     ;function block or channel number, data acquisition unit
                    "FP'XX''YY'IINH"                     ;and group information

      @in(9..13) = ""
      #if 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #then #block
         #IF %b_Fill_IN #THEN #BLOCK
            @IN(9) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Beh.stVal"
            @IN(10) = %t_OPC_Prefix + "." + %v_CILO_Instance(1) + ".EnaOpn.stVal"
            @IN(11) = %t_OPC_Prefix + "." + %v_CILO_Instance(1) + ".EnaCls.stVal"
            #if length(%v_CILO_Instance) > 1 #then #block
               @IN(12) = %t_OPC_Prefix + "." + %v_CILO_Instance(2) + ".EnaOpn.stVal"
               @IN(13) = %t_OPC_Prefix + "." + %v_CILO_Instance(2) + ".EnaCls.stVal"
            #block_end
            #else @IN(12..13) = ""
         #BLOCK_END
   #ELSE @IN(9..13) = ""
      #block_end
      #ELSE @IN(9..13) = ""

      #LOOP_WITH I=9..13
        #IF %I==9 #THEN @II="09"
        #ELSE @II=%I
        #MODIFY P_OBJECTS:V = LIST(P_OBJ'II' = LIST(-
              IX = 9+%I,-                                ;index = 18,19,20,21,22
              PT = 3,-                                   ;process object type = BI
              DX = %DX('I'),-                            ;directive text
              BI = 0,-                                   ;object value
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX('I'),-                            ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = %HE('I'),-                            ;history enable
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 1,-                                   ;receipt = acknowledgement required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class 
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = %PF('I'),-                            ;physical format for printout
              RI = %RI('I'),-                            ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = %LD('I'),-                            ;listing device
              IN = %IN(%I),-
              RX = %RX('I')))                            ;group information
      #LOOP_END

      ;external interlocking cause
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(14..15) ="N6"
        #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(14..15) ="X6"
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(14..15) ="C9"
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(14..15) ="9"
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(14..15) ="O2"
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          @DX(14..15) ="I6"
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          @DX(14..15) ="R6"
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
          @DX(14..15) ="D9"
        #BLOCK_END

        #WHEN "MODBUS_RTU" #BLOCK
          @DX(14..15) ="I6"
        #BLOCK_END

        #WHEN "IEC61850" #BLOCK
          @DX(14..15) ="E6"
        #BLOCK_END

      #CASE_END

      @OX(14..15)=FPI_SSW:VTSS_ILOCK_CAUSE               ;signal text for interlocking cause
      @RX(14..15) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -     ;function block or channel number, data acquisition unit
                    "FP'XX''YY'IINH"                     ;and group information

      #LOOP_WITH I=14..15
        #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
              IX = 9+%I,-                                ;index = 23,24
              PT = 9,-                                   ;process object type = AI
              DX = %DX('I'),-                            ;directive text
              AI = 0,-                                   ;object value = 0
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX('I'),-                            ;object text
              IU = 1,-                                   ;in use = yes
              SS = 2,-                                   ;switch state = auto
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "Cause",-                             ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = 0,-                                   ;listing device = none
              RX = %RX('I')))                            ;data acquisition unit and group information
      #LOOP_END

    #BLOCK_END                                           ;motorized

    ;selection on monitor
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
      #WHEN "SPA" #BLOCK
        @DX(16)   ="N6"
      #BLOCK_END

      #WHEN "LON","LONMARK" #BLOCK
        @DX(16)   ="X6"
      #BLOCK_END

      #WHEN "IEC101","IEC103", "ICCP" #BLOCK
        @DX(16)   ="C9"
      #BLOCK_END

      #WHEN "ANSI" #BLOCK
        @DX(16)   ="9"
      #BLOCK_END

      #WHEN "PROC" #BLOCK
        @DX(16)   ="O2"
      #BLOCK_END

      #WHEN "RTU" #BLOCK
        @DX(16)   ="I6"
      #BLOCK_END

      #WHEN "RTU_E" #BLOCK
        @DX(16)   ="R6"
      #BLOCK_END

      #WHEN "DNP_30" #BLOCK
        @DX(16)   ="D9"
      #BLOCK_END

      #WHEN "MODBUS_RTU" #BLOCK
        @DX(16)   ="I6"
      #BLOCK_END

      #WHEN "IEC61850" #BLOCK
        @DX(16)   ="E6"
      #BLOCK_END

    #CASE_END

    @RX(16) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -           ;function block or channel number, data acquisition unit
              "FP'XX''YY'XMEV"                           ;and group information

    #MODIFY P_OBJECTS:V = LIST(P_OBJ16 = LIST(-
          IX = 25,-                                      ;index = 25
          PT = 9,-                                       ;process object type = AI
          DX = %DX(16),-                                 ;directive text
          AI = 0,-                                       ;object value = 0
          OI = %OBJ_IDENT,-                              ;substation & bay name
          OX = FPI_SSW:VTSS_SEL_ON_MON,-                                 ;object text
          IU = 1,-                                       ;in use = yes
          SS = 2,-                                       ;switch state = auto
          EE = 1,-                                       ;event enable = yes
          HE = 0,-                                       ;history enable = no
          HA = 2,-                                       ;history activation = update
          HF = 1,-                                       ;history at first update = yes
          HL = BIT_MASK(15),-                            ;history log number = 15
          HI = 0,-                                       ;upper alarm limit = 0
          HW = 0,-                                       ;upper warning limit = 0
          LW = 0,-                                       ;lower warning limit = 0
          LI = 0,-                                       ;lower alarm limit = 0
          ST = "Sessions",-                              ;unit of value
          SN = "1_1",-                                   ;scale name
          SZ = 1,-                                       ;zone supervision = SCADA
          RC = 0,-                                       ;receipt = acknowledgement not required
          AB = 0,-                                       ;alarm blocking = no
          AC = 0,-                                       ;alarm class = disabled
          AD = 0,-                                       ;alarm delay = 0
          PD = 0,-                                       ;picture device = none
          PI = "",-                                      ;alarm picture
          PF = "",-                                      ;physical format for printout
          RI = 0,-                                       ;dynamic texts for printout
          PA = 2,-                                       ;printout activation = update
          PU = 1,-                                       ;picture/ printout at first update = yes
          LD = 0,-                                       ;listing device = none
          RX = %RX(16)))                                 ;group information

    ;if motorized switching device
    #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK
 
      ;input object for command event
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(17)    ="N7S"
          @HE(17)    = 0                                 ;history enable = yes
          @PF(17)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(17)    ="X7S"
          @HE(17)    = 0                                 ;history enable = yes
          @PF(17)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(17)    ="C3"
          @HE(17)    = 0                                 ;history enable = yes
          @PF(17)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(17)    ="3"
          @HE(17)    = 0                                 ;history enable = yes
          @PF(17)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(17)    ="O1"
          @HE(17)    = 0                                 ;history enable = yes
          @PF(17)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(17)  ="I7S" 
            @HE(17)  = 0                                 ;history enable = no
            @PF(17)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(17)  ="I7S" 
            @HE(17)  = 1                                 ;history enable = yes
            @PF(17)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(17)  ="R7S"
            @HE(17)  = 0                                 ;history enable = no
            @PF(17)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(17)  ="R7S"
            @HE(17)  = 1                                 ;history enable = yes
            @PF(17)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(17)  ="D3" 
            @HE(17)  = 0                                 ;history enable = yes
            @PF(17)  = "DUMMY"                           ;physical format for printout
          #BLOCK_END

          #ELSE #BLOCK
            @DX(17)  ="D3" 
            @HE(17)  = 1                                 ;history enable = yes
            @PF(17)  = "FORM5SAGR1"                      ;physical format for printout
          #BLOCK_END
        #BLOCK_END

        #WHEN "MODBUS_RTU" #BLOCK
            @DX(17)  ="I7S" 
            @HE(17)  = 1                                 ;history enable = yes
            @PF(17)  = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END

        #WHEN "IEC61850" #BLOCK
          @DX(17)    ="E7S"
          @HE(17)    = 0                                 ;history enable = yes
          @PF(17)    = "FORM5SAGR1"                      ;physical format for printout
        #BLOCK_END
      #CASE_END

      @RX(17) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -         ;function block or channel number, data acquisition unit
                "FP'XX''YY'ICEV"                         ;and group information

      #MODIFY P_OBJECTS:V = LIST(P_OBJ17 = LIST(-
            IX = 26,-                                    ;index = 26
            PT = 3,-                                     ;process object type = BI
            DX = %DX(17),-                               ;directive text
            BI = 0,-                                     ;object value
            OI = %OBJ_IDENT,-                            ;substation & bay name
            OX = FPI_SSW:VTSS_CMD_EVENT,-                ;object text
            IU = 1,-                                     ;in use = yes
            SS = 2,-                                     ;switch state = auto
            EE = 1,-                                     ;event enable = yes
            HE = %HE(17),-                               ;history enable
            HA = 1,-                                     ;history activation = new value
            HF = 0,-                                     ;history at first update = no
            HL = BIT_MASK(15),-                          ;history log number = 15
            RC = 1,-                                     ;receipt = acknowledgement required
            AB = 0,-                                     ;alarm blocking = no
            AC = 0,-                                     ;alarm class 
            AG = 0,-                                     ;alarming value = 0
            AD = 0,-                                     ;alarm delay = disabled
            PD = 0,-                                     ;picture device = none
            PI = "",-                                    ;alarm picture
            PF = %PF(17),-                               ;physical format for printout
            RI = 24,-                                    ;dynamic texts for printout
            PA = 1,-                                     ;printout activation = new value
            PU = 0,-                                     ;picture/ printout at first update = no
            LD = 0,-                                     ;listing device = none
            RX = %RX(17)))                               ;data acquisition unit and group information
 
    #BLOCK_END                                           ;motorized

    ;position indication other than double indication
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE

      ;analog inputs
      #WHEN "AI" #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(18..19) ="N6"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(18..19) ="X6"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(18..19) ="C9"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(18..19) ="9"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(18..19) ="O2"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(18..19) ="I6"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(18..19) ="R6"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(18..19) ="D9"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK         
            @DX(18..19) ="I6"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(18..19) ="E6"
          #BLOCK_END

        #CASE_END      

        @RX(18..19) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EPOS"                   ;and group information

        #LOOP_WITH I=18..19
          #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
                IX = 92+%I,-                             ;index = 110,111
                PT = 9,-                                 ;process object type = AI
                DX = %DX('I'),-                          ;directive text
                AI = %I-17,-                             ;object value = 1,2
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = FPI_SSW:VTSS_POS_IND,-              ;object text
                IU = 1,-                                 ;in use = yes
                SS = 1,-                                 ;switch state = manual
                EE = 1,-                                 ;event enable = yes
                HE = 0,-                                 ;history enable = no
                HA = 0,-                                 ;history activation = alarm
                HF = 0,-                                 ;history at first update = no
                HL = BIT_MASK(15),-                      ;history log number = 15
                HI = 0,-                                 ;upper alarm limit = 0
                HW = 0,-                                 ;upper warning limit = 0
                LW = 0,-                                 ;lower warning limit = 0
                LI = 0,-                                 ;lower alarm limit = 0
                ST = "POS",-                             ;unit of value
                SN = "BGU_1_1000",-                      ;scale name
                SZ = 1,-                                 ;zone supervision = SCADA
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "",-                                ;physical format for printout
                RI = 0,-                                 ;dynamic texts for printout
                PA = 0,-                                 ;printout activation = alarm
                PU = 0,-                                 ;picture/ printout at first update = no
                LD = 0,-                                 ;listing device = none
                AN = "BGU_AI2DB",-                       ;action name
                AE = 1,-                                 ;action enabled
                AA = 2,-                                 ;action activation = update
                AF = 1,-                                 ;action at first update = yes
                RX = %RX('I')))                          ;data acquisition unit and group information
        #LOOP_END

      #BLOCK_END                                         ;analog input

      ;binary inputs (1+1)
      #WHEN "BI" #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(18..19) ="N7S"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(18..19) ="X7S"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(18..19) ="C3"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(18..19) ="3"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(18..19) ="O1"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(18..19) ="I7S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(18..19) ="R7S"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(18..19) ="D3"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(18..19) ="I7S"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(18..19) ="E7S"
          #BLOCK_END
        #CASE_END

        @RX(18..19) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EPOS"                   ;and group information

        #LOOP_WITH I = 18..19
          #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
              IX = 92+%I,-                               ;index = 110,111
              PT = 3,-                                   ;process object type = BI
              DX = %DX('I'),-                            ;directive text
              BI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VTSS_POS_IND,-                ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_BI2DB",-                         ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX('I')))                            ;data acquisition unit and group information
        #LOOP_END

      #BLOCK_END                                         ;binary input

      ;binary inputs (2+2)
      #WHEN "2BI" #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(18..21) ="N7S"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(18..21) ="X7S"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(18..21) ="C3"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(18..21) ="3"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(18..21) ="O1"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(18..21) ="I7S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(18..21) ="R7S"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(18..21) ="D3"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(18..21) ="I7S"
          #BLOCK_END
 
           #WHEN "IEC61850" #BLOCK
            @DX(18..21) ="E7S"
          #BLOCK_END
        #CASE_END

        @OX(18)=FPI_SSW:VTSS_OPEN_IND                    ;signal text for open indication
        @OX(19)=FPI_SSW:VTSS_CLOSE_IND                   ;signal text for close indication
        @OX(20)=FPI_SSW:VTSS_FREE_IND                    ;signal text for free indication
        @OX(21)=FPI_SSW:VTSS_EARTH_IND                   ;signal text for earth indication
        @RX(18..21) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EPOS"                   ;and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ18 = LIST(-
              IX = 110,-                                 ;index = 110
              PT = 3,-                                   ;process object type = BI
              DX = %DX(18),-                             ;directive text
              BI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(18),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_2BI2DB",-                        ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(18)))                             ;data acquisition unit and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ19 = LIST(-
              IX = 108,-                                 ;index = 108
              PT = 3,-                                   ;process object type = BI
              DX = %DX(19),-                             ;directive text
              BI = 0,-                                   ;object value = 0
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(19),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_2BI2DB",-                        ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(19)))                             ;data acquisition unit and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ20 = LIST(-
              IX = 111,-                                 ;index = 111
              PT = 3,-                                   ;process object type = BI
              DX = %DX(20),-                             ;directive text
              BI = 0,-                                   ;object value = 0
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(20),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_2BI2DB",-                        ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(20)))                             ;data acquisition unit and group information

        #MODIFY P_OBJECTS:V = LIST(P_OBJ21 = LIST(-
              IX = 109,-                                 ;index = 109
              PT = 3,-                                   ;process object type = BI
              DX = %DX(21),-                             ;directive text
              BI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(21),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_2BI2DB",-                        ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(21)))                             ;data acquisition unit and group information
      #BLOCK_END                                         ;two binary inputs
    #CASE_END                                            ;indication type

    ;** TiLi 07.01.2004 additional faulty indication for DNP 3.0 and MODBUS
    #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30" #THEN #BLOCK

       #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "DNP_30" #BLOCK
            @DX(33..34)   ="D3"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(33..34)   ="I7S"
          #BLOCK_END
        #CASE_END

        @OX(33)=FPI_SSW:VTSS_D_FAULTY_IND               ;signal text for faulty indication
        @OX(34)=FPI_SSW:VTSS_E_FAULTY_IND               ;signal text for faulty indication

       @RX(33..34) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EPOS"                   ;and group information
       #LOOP_WITH I = 33 .. 34
         #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
              IX = 73+%I,-                               ;index = 106 , 107
              PT = 3,-                                   ;process object type = BI
              DX = %DX(%I),-                             ;directive text
              BI = 1,-                                   ;object value = 1
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX(%I),-                             ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enabled = no
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = 0,-                                   ;listing device
              AN = "BGU_1TO3",-                          ;action name
              AE = 1,-                                   ;action enabled
              AA = 2,-                                   ;action activation = update
              AF = 1,-                                   ;action at first update = yes
              RX = %RX(%I)))                             ;data acquisition unit and group information
        #LOOP_END
    #BLOCK_END
    ;** TiLi END

    ;event recording objects
    #IF ('ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="RTU" OR -
        'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="RTU_E" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30") AND -
        'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK

      ;event recording object for position indication (DB)
      #IF 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE=="DB" #THEN #BLOCK
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "RTU" #BLOCK
            @DX(18..19) ="I10D"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(18..19) ="R10D"
          #BLOCK_END

           #WHEN "DNP_30" #BLOCK
            @DX(18..19) ="D12"
          #BLOCK_END
        #CASE_END

        @RI(18)=7                                        ;dynamic text for disc. section position indication printout
        @RI(19)=8                                        ;dynamic text for earth switch section position indication printout
        @RX(18..19) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EPOS"                   ;and group information

        #LOOP_WITH I=18..19
          #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
              IX = 92+%I,-                               ;index = 110,111
              PT = 12,-                                  ;process object type = DB
              DX = %DX('I'),-                            ;directive text
              NV = 4,-                                   ;normal value = none
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VTSS_POS_IND,-                ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = 1,-                                   ;history enable = yes
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              LA = 0,-                                   ;alarm activation = none
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "FORM5SAGR1",-                        ;physical format for printout
              RI = %RI('I'),-                            ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = BIT_MASK(1),-                         ;listing device = 1
              RX = %RX('I')))                            ;data acquisition unit and group information
        #LOOP_END

      #BLOCK_END                                         ;double binary inputs (1+1)

      ;if motorized switching device
      #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

        ;event recording objects for external control blocking and open/close/free/earth interlocking 
        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "RTU" #BLOCK
            @DX(22..26) ="I10S"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(22..26) ="R10S"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(22..26) ="D3"
          #BLOCK_END
        #CASE_END

        @OX(22)=FPI_SSW:VTSS_EXT_CNTR_BLK                ;signal text for external interlocking
        @OX(23)=FPI_SSW:VTSS_OPEN_ILOCKED                ;signal text for open interlocked
        @OX(24)=FPI_SSW:VTSS_CLOSE_ILOCKED               ;signal text for close interlocked
        @OX(25)=FPI_SSW:VTSS_FREE_ILOCKED                ;signal text for free interlocked
        @OX(26)=FPI_SSW:VTSS_EARTH_ILOCKED               ;signal text for earth interlocked
        @RI(22..26)=23                                   ;dynamic text for object printout
 
        @RX(22)     = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EBLK"                   ;and group information
        @RX(23..26) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
                      "FP'XX''YY'EINH"                   ;and group information

        #LOOP_WITH I=22..26
          #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
                IX = 96+%I,-                             ;index = 118,119,120,121,122
                PT = 3,-                                 ;process object type = BI
                DX = %DX('I'),-                          ;directive text
                BI = 0,-                                 ;object value
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX('I'),-                          ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class 
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI('I'),-                          ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX('I')))                          ;data acquisition unit and group information
        #LOOP_END
      #BLOCK_END                                         ;motorized

      ;position indication other than double indication
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VINDICATION_TYPE

        ;event recording object for position indication of the analog input (1+1) types
        #WHEN "AI" #BLOCK
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "RTU" #BLOCK
              @DX(27..28) ="I11"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(27..28) ="R11"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(27..28) ="D9"
            #BLOCK_END
          #CASE_END

          @RI(27)=7                                      ;dynamic text for disc. section position indication printout
          @RI(28)=8                                      ;dynamic text for earth switch section position indication printout
          @RX(27..28) = %ADDITIONAL_IDENT+%UNIT_IDENT+ - ;function block or channel number, data acquisition unit
                        "FP'XX''YY'EPOS"                 ;and group information

          #LOOP_WITH I=27..28
            #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
                IX = 183+%I,-                            ;index = 210,211
                PT = 9,-                                 ;process object type = AI
                DX = %DX('I'),-                          ;directive text
                AI = %I-26,-                             ;object value = 1, 2
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = FPI_SSW:VTSS_POS_IND,-              ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 1,-                                 ;event enable = yes
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                HI = 0,-                                 ;upper alarm limit = 0
                HW = 0,-                                 ;upper warning limit = 0
                LW = 0,-                                 ;lower warning limit = 0
                LI = 0,-                                 ;lower alarm limit = 0
                ST = "POS",-                             ;unit of value
                SN = "1_1",-                             ;scale name
                SZ = 1,-                                 ;zone supervision = SCADA
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = %RI('I'),-                          ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX('I')))                          ;data acquisition unit and group information
          #LOOP_END

        #BLOCK_END                                       ;analog inputs (1+1)

        ;event recording object for position indication of the binary input (1+1) types
        #WHEN "BI" #BLOCK
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "RTU" #BLOCK
              @DX(27..28) ="I10S"
            #BLOCK_END

            #WHEN "DNP_30" #BLOCK
              @DX(27..28) ="D3"
            #BLOCK_END
          #CASE_END

          @RI(27)=25                                     ;dynamic text for disc. section position indication printout
          @RI(28)=26                                     ;dynamic text for earth switch section position indication printout
          @RX(27..28) = %ADDITIONAL_IDENT+%UNIT_IDENT+ - ;function block or channel number, data acquisition unit
                        "FP'XX''YY'EPOS"                 ;and group information

          #LOOP_WITH I=27..28
            #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
                  IX = 183+%I,-                          ;index = 210
                  PT = 3,-                               ;process object type = BI
                  DX = %DX('I'),-                        ;directive text
                  BI = %I-27,-                           ;object value = 0, 1
                  OI = %OBJ_IDENT,-                      ;substation & bay name
                  OX = FPI_SSW:VTSS_POS_IND,-            ;object text
                  IU = 1,-                               ;in use = yes
                  SS = 2,-                               ;switch state = auto
                  EE = 0,-                               ;event enable = no
                  HE = 1,-                               ;history enable = yes
                  HA = 2,-                               ;history activation = update
                  HF = 1,-                               ;history at first update = yes
                  HL = BIT_MASK(15),-                    ;history log number = 15
                  RC = 0,-                               ;receipt = acknowledgement not required
                  AB = 0,-                               ;alarm blocking = no
                  AC = 0,-                               ;alarm class = disabled
                  AG = 0,-                               ;alarming value = 0
                  AD = 0,-                               ;alarm delay = 0
                  PD = 0,-                               ;picture device = none
                  PI = "",-                              ;alarm picture
                  PF = "FORM5SAGR1",-                    ;physical format for printout
                  RI = %RI('I'),-                        ;dynamic texts for printout
                  PA = 2,-                               ;printout activation = update
                  PU = 1,-                               ;picture/ printout at first update = yes
                  LD = BIT_MASK(1),-                     ;listing device
                  RX = %RX('I')))                        ;data acquisition unit and group information
          #LOOP_END
        #BLOCK_END                                       ;binary inputs (1+1)

        ;event recording object for position indication of binary input (2+2) types
        #WHEN "2BI" #BLOCK
          #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
            #WHEN "RTU" #BLOCK
              @DX(27..30) ="I10S"
            #BLOCK_END

            #WHEN "RTU_E" #BLOCK
              @DX(27..30) ="R10S"
            #BLOCK_END

             #WHEN "DNP_30" #BLOCK
              @DX(27..30) ="D3"
            #BLOCK_END
          #CASE_END

          @OX(27)=FPI_SSW:VTSS_OPEN_IND                  ;signal text for open indication
          @OX(28)=FPI_SSW:VTSS_CLOSE_IND                 ;signal text for close indication
          @OX(29)=FPI_SSW:VTSS_FREE_IND                  ;signal text for free indication
          @OX(30)=FPI_SSW:VTSS_EARTH_IND                 ;signal text for earth indication
          @RX(27..30) = %ADDITIONAL_IDENT+%UNIT_IDENT+ - ;function block or channel number, data acquisition unit
                        "FP'XX''YY'EPOS"                 ;and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ27 = LIST(-
                IX = 210,-                               ;index = 210
                PT = 3,-                                 ;process object type = BI
                DX = %DX(27),-                           ;directive text
                BI = 1,-                                 ;object value = 1
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(27),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 27,-                                ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(27)))                           ;data acquisition unit and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ28 = LIST(-
                IX = 208,-                               ;index = 208
                PT = 3,-                                 ;process object type = BI
                DX = %DX(28),-                           ;directive text
                BI = 0,-                                 ;object value = 0
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(28),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 28,-                                ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(28)))                           ;data acquisition unit and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ29 = LIST(-
                IX = 211,-                               ;index = 211
                PT = 3,-                                 ;process object type = BI
                DX = %DX(29),-                           ;directive text
                BI = 0,-                                 ;object value = 0
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(29),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 29,-                                ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(29)))                           ;data acquisition unit and group information

          #MODIFY P_OBJECTS:V = LIST(P_OBJ30 = LIST(-
                IX = 209,-                               ;index = 209
                PT = 3,-                                 ;process object type = BI
                DX = %DX(30),-                           ;directive text
                BI = 1,-                                 ;object value = 1
                OI = %OBJ_IDENT,-                        ;substation & bay name
                OX = %OX(30),-                           ;object text
                IU = 1,-                                 ;in use = yes
                SS = 2,-                                 ;switch state = auto
                EE = 0,-                                 ;event enable = no
                HE = 1,-                                 ;history enable = yes
                HA = 2,-                                 ;history activation = update
                HF = 1,-                                 ;history at first update = yes
                HL = BIT_MASK(15),-                      ;history log number = 15
                RC = 0,-                                 ;receipt = acknowledgement not required
                AB = 0,-                                 ;alarm blocking = no
                AC = 0,-                                 ;alarm class = disabled
                AG = 0,-                                 ;alarming value = 0
                AD = 0,-                                 ;alarm delay = 0
                PD = 0,-                                 ;picture device = none
                PI = "",-                                ;alarm picture
                PF = "FORM5SAGR1",-                      ;physical format for printout
                RI = 30,-                                ;dynamic texts for printout
                PA = 2,-                                 ;printout activation = update
                PU = 1,-                                 ;picture/ printout at first update = yes
                LD = BIT_MASK(1),-                       ;listing device
                RX = %RX(30)))                           ;data acquisition unit and group information
        #BLOCK_END                                       ;binary inputs (2+2)
      #CASE_END                                          ;indication type
    #BLOCK_END                                           ;event recording

    ;command termination
    #IF ('ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="IEC101" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="IEC103" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30") AND 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

      ;control type
      #CASE 'ID'_PICTURE_FUNCTION_CONF:VCONTROL_TYPE

        ;secured control with four binary outputs
        #WHEN "SEC-4BO" #BLOCK
          ;indexing
          @START_INDEX = 22
          @STOP_INDEX  = 27
          @OX(22)=FPI_SSW:VTSS_OPEN_SEL                  ;signal text for open select
          @OX(23)=FPI_SSW:VTSS_CLOSE_SEL                 ;signal text for close select
          @OX(24)=FPI_SSW:VTSS_FREE_SEL                  ;signal text for free select
          @OX(25)=FPI_SSW:VTSS_EARTH_SEL                 ;signal text for earth select
          @OX(26)=FPI_SSW:VTSS_EXEC_CMD                  ;signal text for execute
          @OX(27)=FPI_SSW:VTSS_CANCEL_CMD                ;signal text for cancel
        #BLOCK_END

        ;secured control with two binary or digital outputs
        #WHEN "SEC-2BO","SEC-2DO" #BLOCK
          ;indexing
          @START_INDEX = 22
          @STOP_INDEX  = 25
          @OX(22)=FPI_SSW:VTSS_OPEN_EXEC                 ;signal text for open execute
          @OX(23)=FPI_SSW:VTSS_CLOSE_EXEC                ;signal text for close execute
          @OX(24)=FPI_SSW:VTSS_FREE_EXEC                 ;signal text for free execute
          @OX(25)=FPI_SSW:VTSS_EARTH_EXEC                ;signal text for earth execute
        #BLOCK_END

        ;secured control with a single binary or analog output/direct control with a single binary output  
        #WHEN "SEC-BO","AO","DIR-BO" #BLOCK
          ;indexing
          @START_INDEX = 26
          @STOP_INDEX  = 27
          @OX(26..27)=FPI_SSW:VTSS_OBJ_CMD               ;signal text for control object
        #BLOCK_END
      #CASE_END                                          ;control type

      @RX(%START_INDEX..%STOP_INDEX) = %ADDITIONAL_IDENT+ -  ;function block or channel number, data acquisition unit
          %UNIT_IDENT+"FP'XX''YY'TOBC"                       ;and group information

      #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30" #THEN @TMP_DX = "D9E"
      #ELSE @TMP_DX = "C9E"


      #LOOP_WITH I=%START_INDEX..%STOP_INDEX
        #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
              IX = %I+90,-                               ;index = (112, 113, 114, 115,) 116, 117
              PT = 9,-                                   ;process object type = AI
              DX = %TMP_DX,-                             ;directive text
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX('I'),-                            ;object text
              IU = 1,-                                   ;in use = yes
              SS = 2,-                                   ;switch state = auto
              EE = 1,-                                   ;event enable = yes
              HE = 1,-                                   ;history enable
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "cmd status",-                        ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "FORM5SAGR1",-                        ;physical format for printout
              RI = 10,-                                  ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = BIT_MASK(1),-                         ;listing device
              RX = %RX('I')))                            ;data acquisition unit and group information

      #LOOP_END
    #BLOCK_END                                           ;IEC 870-5-101/103 and motorized

    ;if motorized switching device
    #IF 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK

      ;interlocking cause (calculated by topological interlocking)
      #IF 'ID'_PICTURE_FUNCTION_CONF:VCREATE_TOPO_INTL_CAUSE #THEN #BLOCK

        #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
          #WHEN "SPA" #BLOCK
            @DX(31..32) ="N6"
          #BLOCK_END

          #WHEN "LON","LONMARK" #BLOCK
            @DX(31..32) ="X6"
          #BLOCK_END

          #WHEN "IEC101","IEC103", "ICCP" #BLOCK
            @DX(31..32) ="C9"
          #BLOCK_END

          #WHEN "ANSI" #BLOCK
            @DX(31..32) ="9"
          #BLOCK_END

          #WHEN "PROC" #BLOCK
            @DX(31..32) ="O2"
          #BLOCK_END

          #WHEN "RTU" #BLOCK
            @DX(31..32) ="I6"
          #BLOCK_END

          #WHEN "RTU_E" #BLOCK
            @DX(31..32) ="R6"
          #BLOCK_END

          #WHEN "DNP_30" #BLOCK
            @DX(31..32) ="D9"
          #BLOCK_END

          #WHEN "MODBUS_RTU" #BLOCK
            @DX(31..32) ="I6"
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(31..32) ="E6"
          #BLOCK_END

        #CASE_END

        @RX(31) = "                    FP'XX''YY'IINH"   ;group information

        #LOOP_WITH I=31..32
          #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
              IX = 220+%I,-                              ;index = 251,252
              PT = 9,-                                   ;process object type = AI
              DX = %DX('I'),-                            ;directive text
              AI = 0,-                                   ;object value = 0
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = FPI_SSW:VINTL_CAUSE,-                 ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = auto
              EE = 1,-                                   ;event enable = yes
              HE = 0,-                                   ;history enable = no
              HA = 2,-                                   ;history activation = update
              HF = 1,-                                   ;history at first update = yes
              HL = BIT_MASK(15),-                        ;history log number = 15
              HI = 0,-                                   ;upper alarm limit = 0
              HW = 0,-                                   ;upper warning limit = 0
              LW = 0,-                                   ;lower warning limit = 0
              LI = 0,-                                   ;lower alarm limit = 0
              ST = "Cause",-                             ;unit of value
              SN = "1_1",-                               ;scale name
              SZ = 1,-                                   ;zone supervision = SCADA
              RC = 0,-                                   ;receipt = acknowledgement not required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class = disabled
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = "",-                                  ;physical format for printout
              RI = 0,-                                   ;dynamic texts for printout
              PA = 2,-                                   ;printout activation = update
              PU = 1,-                                   ;picture/ printout at first update = yes
              LD = 0,-                                   ;listing device = none
              RX = %RX('I')))                            ;group information
        #LOOP_END
      #BLOCK_END                                         ;topological interlocking
    #BLOCK_END                                           ;motorized

  #BLOCK_END                                             ;three-state switch
#CASE_END 
                                                         ;switching device type
#IF 'ID'_PICTURE_FUNCTION_CONF:VTAGOUT #THEN #BLOCK
   @v_attrs = list_attr(%P_OBJECTS)
   @i_P_OBJ_Nr = 49

   @RX(%i_P_OBJ_Nr) = %ADDITIONAL_IDENT+%UNIT_IDENT+ - ;function block or channel number, data acquisition unit
             "FPXTAGXIND"                            ;and group information

   #IF %i_P_OBJ_Nr < 10 #THEN @TMP_OBJ_NR = "0'i_P_OBJ_Nr'"
   #ELSE @TMP_OBJ_NR = "'i_P_OBJ_Nr'"
   #modify P_OBJECTS:v = LIST(-
     P_OBJ'TMP_OBJ_NR' = LIST(-
        IX = %i_P_OBJ_Nr,-                           ;index = 49
        DX = "6",-                                   ;directive text
        IU = 1,-                                     ;in use = yes
        SS = 1,-                                     ;switch state = manual
        EE = 1,-                                     ;event enable = yes
        HE = 0,-                                     ;history activation = yes
        HA = 2,-                                     ;history activation = update
        HF = 1,-                                     ;history at first update = yes
        PA = 2,-                                     ;printout activation = update
        PU = 1,-                                     ;printout at first update = yes
        RX = %RX(%i_P_OBJ_Nr),-                      ;data acquisition unit and group information
        OI = %OBJ_IDENT,-                            ;object identification
        HL = BIT_MASK(15),-                          ;history log number = 15
        LD = 0,-                           ;listing device = 1
        PF = "FORM5SAGR1",-                          ;physical format for printout
        RI = 0,-                                     ;reserved integer
        OX = FPI_SSW:VTAGOUT_IND,-                   ;object text
        RZ = 1,-						     ;reserved tagout state
        PT = 6))                                     ;process object type = DI

   #if not application_object_exists(0,"H","SAGR_TAGOUT_HIST") #then -
      #create SAGR_TAGOUT_HIST:H=List(VC=4,ST=vector("Attr. changed","Attr. removed","new","removed"))       ;ST values will be defined with ToEdit

   @i_P_OBJ_Nr = 50
   @RX(%i_P_OBJ_Nr) = %ADDITIONAL_IDENT+%UNIT_IDENT+ - ;function block or channel number, data acquisition unit
             "FPXTAGXEVT"                          ;and group information


   #IF %i_P_OBJ_Nr < 10 #THEN @TMP_OBJ_NR = "0'i_P_OBJ_Nr'"
   #ELSE @TMP_OBJ_NR = "'i_P_OBJ_Nr'"

   #modify P_OBJECTS:v = LIST(-
     P_OBJ'TMP_OBJ_NR' = LIST(-
        IX = %i_P_OBJ_Nr,-                            ;index = 50
        DX = "6",-                                   ;directive text
        IU = 1,-                                     ;in use = yes
        SS = 1,-                                     ;switch state = manual
        EH = "SAGR_TAGOUT_HIST",-                    ;Event Handling Object
        EE = 1,-                                     ;event enable = yes
        HE = 1,-                                     ;history activation = yes
        HA = 2,-                                     ;history activation = update
        HF = 1,-                                     ;history at first update = yes
        PA = 2,-                                     ;printout activation = update
        PU = 1,-                                     ;printout at first update = yes
        RX = %RX(%i_P_OBJ_Nr),-                      ;data acquisition unit and group information
        OI = %OBJ_IDENT,-                            ;object identification
        HL = BIT_MASK(15),-                          ;history log number = 15
        LD = BIT_MASK(1),-                           ;listing device = 1
        PF = "FORM5SAGR1",-                          ;physical format for printout
        RI = 0,-                                     ;reserved integer
        OX = FPI_SSW:VTAGOUT_LOG,-                   ;object text
        RZ = 1,-						     ;reserved tagout state
        PT = 6))                                     ;process object type = DI
#block_end

;blkopn , blkcls only IEC61850
#IF ('ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" OR  'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "DNP_30") AND 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK
    
;input objects for control blocking
@v_objs = dec_scan(substr(list_attr(%p_objects), 6, 0))
@I_LOOP_START = %v_objs(length(%v_objs)) + 1

#IF 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE == "Q3" #THEN @I_LOOP_END = %I_LOOP_START + 3
#ELSE @I_LOOP_END = %I_LOOP_START + 1

      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
        #WHEN "SPA" #BLOCK
          @DX(%I_LOOP_START..%I_LOOP_END)   ="N7S"
          @HE(%I_LOOP_START..%I_LOOP_END)   = 1                                ;history enable = yes
          @PF(%I_LOOP_START..%I_LOOP_END)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(%I_LOOP_START..%I_LOOP_END)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "LON","LONMARK" #BLOCK
          @DX(%I_LOOP_START..%I_LOOP_END)   ="X7S"
          @HE(%I_LOOP_START..%I_LOOP_END)   = 1                                ;history enable = yes
          @PF(%I_LOOP_START..%I_LOOP_END)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(%I_LOOP_START..%I_LOOP_END)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "IEC101","IEC103", "ICCP" #BLOCK
          @DX(%I_LOOP_START..%I_LOOP_END)   ="C3"
          @HE(%I_LOOP_START..%I_LOOP_END)   = 1                                ;history enable = yes
          @PF(%I_LOOP_START..%I_LOOP_END)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(%I_LOOP_START..%I_LOOP_END)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "ANSI" #BLOCK
          @DX(%I_LOOP_START..%I_LOOP_END)   ="3"
          @HE(%I_LOOP_START..%I_LOOP_END)   = 1                                ;history enable = yes
          @PF(%I_LOOP_START..%I_LOOP_END)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(%I_LOOP_START..%I_LOOP_END)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "PROC" #BLOCK
          @DX(%I_LOOP_START..%I_LOOP_END)   ="O1"
          @HE(%I_LOOP_START..%I_LOOP_END)   = 1                                ;history enable = yes
          @PF(%I_LOOP_START..%I_LOOP_END)   = "FORM5SAGR1"                     ;physical format for printout
          @LD(%I_LOOP_START..%I_LOOP_END)   = BIT_MASK(1)                      ;listing device = 1
        #BLOCK_END

        #WHEN "RTU" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(%I_LOOP_START..%I_LOOP_END) ="I7S" 
            @HE(%I_LOOP_START..%I_LOOP_END) = 0                                ;history enable = no
            @PF(%I_LOOP_START..%I_LOOP_END) = "DUMMY"                          ;physical format for printout
            @LD(%I_LOOP_START..%I_LOOP_END) = 0                                ;listing device = none
          #BLOCK_END

          #ELSE #BLOCK
            @DX(%I_LOOP_START..%I_LOOP_END) ="I7S" 
            @HE(%I_LOOP_START..%I_LOOP_END) = 1                                ;history enable = yes
            @PF(%I_LOOP_START..%I_LOOP_END) = "FORM5SAGR1"                     ;physical format for printout
            @LD(%I_LOOP_START..%I_LOOP_END) = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "RTU_E" #BLOCK
          #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
            @DX(%I_LOOP_START..%I_LOOP_END) ="R7S"
            @HE(%I_LOOP_START..%I_LOOP_END) = 0                                ;history enable = no
            @PF(%I_LOOP_START..%I_LOOP_END) = "DUMMY"                          ;physical format for printout
            @LD(%I_LOOP_START..%I_LOOP_END) = 0                                ;listing device = none
          #BLOCK_END

          #ELSE #BLOCK
            @DX(%I_LOOP_START..%I_LOOP_END) ="R7S"
            @HE(%I_LOOP_START..%I_LOOP_END) = 1                                ;history enable = yes
            @PF(%I_LOOP_START..%I_LOOP_END) = "FORM5SAGR1"                     ;physical format for printout
            @LD(%I_LOOP_START..%I_LOOP_END) = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END
        #BLOCK_END

        #WHEN "DNP_30" #BLOCK
            #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
               @DX(%I_LOOP_START..%I_LOOP_END) ="D3" 
               @HE(%I_LOOP_START..%I_LOOP_END) = 0                             ;history enable = no
               @PF(%I_LOOP_START..%I_LOOP_END) = "DUMMY"                       ;physical format for printout
               @LD(%I_LOOP_START..%I_LOOP_END) = 0                             ;listing device = 1
            #BLOCK_END
            
            #ELSE #BLOCK
               @DX(%I_LOOP_START..%I_LOOP_END) ="D3" 
               @HE(%I_LOOP_START..%I_LOOP_END) = 1                             ;history enable = yes
               @PF(%I_LOOP_START..%I_LOOP_END) = "FORM5SAGR1"                  ;physical format for printout
               @LD(%I_LOOP_START..%I_LOOP_END) = BIT_MASK(1)                   ;listing device = 1
            #BLOCK_END
          #BLOCK_END

         #WHEN "MODBUS_RTU" #BLOCK
            @DX(%I_LOOP_START..%I_LOOP_END) ="I7S" 
            @HE(%I_LOOP_START..%I_LOOP_END) = 1                                ;history enable = yes
            @PF(%I_LOOP_START..%I_LOOP_END) = "FORM5SAGR1"                     ;physical format for printout
            @LD(%I_LOOP_START..%I_LOOP_END) = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END

          #WHEN "IEC61850" #BLOCK
            @DX(%I_LOOP_START..%I_LOOP_END)   = "E7S"
            @HE(%I_LOOP_START..%I_LOOP_END)   = 1                                ;history enable = yes
            @PF(%I_LOOP_START..%I_LOOP_END)   = "FORM5SAGR1"                     ;physical format for printout
            @LD(%I_LOOP_START..%I_LOOP_END)   = BIT_MASK(1)                      ;listing device = 1
          #BLOCK_END
      #CASE_END                     

       @RX(%I_LOOP_START..%I_LOOP_END)    = %ADDITIONAL_IDENT+%UNIT_IDENT+ -       ;function block or channel number, data acquisition unit
                  "FP'XX''YY'IBLK"

      #CASE 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE
        #WHEN "QB","QS","QI" #BLOCK                      ;circuit breaker
          @OX(%I_LOOP_START)=FPI_SSW:VCB_OPEN_BLOCKED                ;signal text for open interlocked
          @OX(%I_LOOP_START+1)=FPI_SSW:VCB_CLOSE_BLOCKED               ;signal text for close interlocked
          @I_IX(%I_LOOP_START .. %I_LOOP_END) = (41,42)
          @IN(%I_LOOP_START .. %I_LOOP_END) = ""
          @RI(%I_LOOP_START..%I_LOOP_END)=3
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
             @RX(%I_LOOP_START) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XCBR.BlkOpn.stVal"
             @RX(%I_LOOP_END) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XCBR.BlkCls.stVal"
             #IF %b_Fill_IN AND LENGTH(%v_XCBR_Instance) > 0 #THEN #BLOCK 
                @IN(%I_LOOP_START) = %t_OPC_Prefix + "." + %v_XCBR_Instance(1) + ".BlkOpn.stVal"
                @IN(%I_LOOP_END) = %t_OPC_Prefix + "." + %v_XCBR_Instance(1) + ".BlkCls.stVal"
             #BLOCK_END
             #ELSE @IN(%I_LOOP_START..%I_LOOP_END) = ""
          #BLOCK_END
          #ELSE @RI(%I_LOOP_START..%I_LOOP_END)=3                             ;dynamic text for object printout
        #BLOCK_END
        #WHEN "QD","QF","QL" #BLOCK                      ;disconnector
          @OX(%I_LOOP_START)=FPI_SSW:VDC_OPEN_BLOCKED                ;signal text for open interlocked
          @OX(%I_LOOP_START+1)=FPI_SSW:VDC_CLOSE_BLOCKED               ;signal text for close interlocked
          @IN(%I_LOOP_START .. %I_LOOP_END) = ""
          @I_IX(%I_LOOP_START .. %I_LOOP_END) = (41,42)
          @RI(%I_LOOP_START..%I_LOOP_END)=8
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK  
             @RX(%I_LOOP_START) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkOpn.stVal"
             @RX(%I_LOOP_END) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkCls.stVal"
             @I_IX(%I_LOOP_START .. %I_LOOP_END) = (41,42)
             #IF %b_Fill_IN  AND LENGTH(%v_XSWI_Instance) > 0 #THEN #BLOCK           
                @IN(%I_LOOP_START) = %t_OPC_Prefix + "." + %v_XSWI_Instance(1) + ".BlkOpn.stVal"
                @IN(%I_LOOP_END) = %t_OPC_Prefix + "." + %v_XSWI_Instance(1) + ".BlkCls.stVal"
             #BLOCK_END
             #ELSE @IN(%I_LOOP_START..%I_LOOP_END) = ""
          #BLOCK_END
          #ELSE @RI(%I_LOOP_START..%I_LOOP_END)=8                                    ;dynamic text for object printout
        #BLOCK_END
        #WHEN "QE","QM" #BLOCK                           ;earth switch
          @OX(%I_LOOP_START)=FPI_SSW:VES_OPEN_BLOCKED                ;signal text for open interlocked
          @OX(%I_LOOP_START+1)=FPI_SSW:VES_CLOSE_BLOCKED               ;signal text for close interlocked
          @IN(%I_LOOP_START .. %I_LOOP_END) = ""
          @I_IX(%I_LOOP_START .. %I_LOOP_END) = (41,42)
          @RI(%I_LOOP_START..%I_LOOP_END)=13
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK            
             @RX(%I_LOOP_START) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkOpn.stVal"
             @RX(%I_LOOP_END) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkCls.stVal"            
             #IF %b_Fill_IN   AND LENGTH(%v_XSWI_Instance) > 0 #THEN #BLOCK           
                @IN(%I_LOOP_START) = %t_OPC_Prefix + "." + %v_XSWI_Instance(1) + ".BlkOpn.stVal"
                @IN(%I_LOOP_END) = %t_OPC_Prefix + "." + %v_XSWI_Instance(1) + ".BlkCls.stVal"
             #BLOCK_END
             #ELSE @IN(%I_LOOP_START..%I_LOOP_END) = ""
          #BLOCK_END
          #ELSE @RI(%I_LOOP_START..%I_LOOP_END)=13                           	;dynamic text for object printouT
        #BLOCK_END
        #WHEN "QT" #BLOCK                      				;disconnector
          @OX(%I_LOOP_START)=FPI_SSW:VTR_OPEN_BLOCKED                	;signal text for open interlocked
          @OX(%I_LOOP_START+1)=FPI_SSW:VTR_CLOSE_BLOCKED               	;signal text for close interlocked
          @IN(%I_LOOP_START .. %I_LOOP_END) = ""
          @I_IX(%I_LOOP_START .. %I_LOOP_END) = (61,62)
           @RI(%I_LOOP_START..%I_LOOP_END)=18
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK            
             @RX(%I_LOOP_START) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkOpn.stVal"
             @RX(%I_LOOP_END) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkCls.stVal"             
             #IF %b_Fill_IN   AND LENGTH(%v_XSWI_Instance) > 0 #THEN #BLOCK           
                @IN(%I_LOOP_START) = %t_OPC_Prefix + "." + %v_XSWI_Instance(1) + ".BlkOpn.stVal"
                @IN(%I_LOOP_END) = %t_OPC_Prefix + "." + %v_XSWI_Instance(1) + ".BlkCls.stVal"
             #BLOCK_END
             #ELSE @IN(%I_LOOP_START..%I_LOOP_END) = ""
          #BLOCK_END
          #ELSE @RI(%I_LOOP_START..%I_LOOP_END)=18                                    ;dynamic text for object printout
        #BLOCK_END
        #WHEN "Q3" #BLOCK                      				;disconnector
          @OX(%I_LOOP_START)=FPI_SSW:VTSS_OPEN_BLOCKED                	;signal text for open interlocked
          @OX(%I_LOOP_START+2)=FPI_SSW:VTSS_FREE_BLOCKED                	;signal text for open interlocked
          @OX(%I_LOOP_START+1)=FPI_SSW:VTSS_CLOSE_BLOCKED               	;signal text for close interlocked
          @OX(%I_LOOP_START+3)=FPI_SSW:VTSS_EARTH_BLOCKED               	;signal text for close interlocked
          @IN(%I_LOOP_START .. %I_LOOP_END) = ""
          @I_IX(%I_LOOP_START .. %I_LOOP_END) = (41,42,61,62)
          @RI(%I_LOOP_START..%I_LOOP_END)=23
          #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK             
             @RX(%I_LOOP_START) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkOpn.stVal"
             @RX(%I_LOOP_START+2) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkOpn.stVal"
             @RX(%I_LOOP_START+1) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkCls.stVal"
             @RX(%I_LOOP_START+3) = SUBSTR(%RX(%I_LOOP_START),1,35) + "XSWI.BlkCls.stVal"
             #IF %b_Fill_IN   AND LENGTH(%v_XSWI_Instance) > 0 #THEN #BLOCK           
                @IN(%I_LOOP_START) = %t_OPC_Prefix + "." + %v_XSWI_Instance(1) + ".BlkOpn.stVal"
                @IN(%I_LOOP_END) = %t_OPC_Prefix + "." + %v_XSWI_Instance(1) + ".BlkCls.stVal"
             #BLOCK_END
             #ELSE @IN(%I_LOOP_START..%I_LOOP_END) = ""
          #BLOCK_END
          #ELSE @RI(%I_LOOP_START..%I_LOOP_END)=23                                    ;dynamic text for object printout
        #BLOCK_END
      #CASE_END
		
      #LOOP_WITH I=%I_LOOP_START..%I_LOOP_END
        #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
              IX = %I_IX(%I),-                           ;index = 
              PT = 3,-                                   ;process object type = BI
              DX = %DX('I'),-                            ;directive text
              BI = 0,-                       		      ;object value
              OI = %OBJ_IDENT,-                          ;substation & bay name
              OX = %OX('I'),-                            ;object text
              IU = 1,-                                   ;in use = yes
              SS = 1,-                                   ;switch state = manual
              EE = 1,-                                   ;event enable = yes
              HE = %HE('I'),-                            ;history enable
              HA = 1,-                                   ;history activation = new value
              HF = 0,-                                   ;history at first update = no
              HL = BIT_MASK(15),-                        ;history log number = 15
              RC = 1,-                                   ;receipt = acknowledgement required
              AB = 0,-                                   ;alarm blocking = no
              AC = 0,-                                   ;alarm class 
              AG = 0,-                                   ;alarming value = 0
              AD = 0,-                                   ;alarm delay = 0
              PD = 0,-                                   ;picture device = none
              PI = "",-                                  ;alarm picture
              PF = %PF('I'),-                            ;physical format for printout
              RI = %RI('I'),-                            ;dynamic texts for printout
              PA = 1,-                                   ;printout activation = new value
              PU = 0,-                                   ;picture/ printout at first update = no
              LD = %LD('I'),-                            ;listing device
              IN = %IN(%I),-
              RX = %RX('I')))                            ;group information
      #LOOP_END

#BLOCK_END

#IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" AND 'ID'_PICTURE_FUNCTION_CONF:VMOTORIZED #THEN #BLOCK
      ;add cause
      @v_objs = dec_scan(substr(list_attr(%p_objects), 6, 0))
      @I_START = %v_objs(length(%v_objs)) + 1
      @RX(%I_START) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
             "FP'XX''YY'TAEC"                           ;and group information
             
      #IF %b_Fill_IN #THEN @IN(%I_START) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Pos.lastApplError"
      #ELSE @IN(%I_START) = ""
      
      #IF DATA_TYPE(FPI_SSW:VADD_CAUSE) <> "NONE" #THEN @OX(%I_START) = FPI_SSW:VADD_CAUSE
      #ELSE @OX(%I_START) = "Add cause of command"
      
      @i_IX = 'ID'_PICTURE_FUNCTION_CONF:VADD_CAUSE_IX
      
		#MODIFY P_OBJECTS:V = LIST(P_OBJ'I_START' = LIST(-
          IX = %i_IX,-                                   ;index = 50
          PT = 9,-                                       ;process object type = AI
          DX = "E6",-                                    ;directive text
          AI = 0,-                                       ;object value = 0
          OI = %OBJ_IDENT,-                              ;substation & bay name
          OX = %OX(%I_START),-                           ;object text
          IU = 1,-                                       ;in use = yes
          SS = 1,-                                       ;switch state = auto
          EE = 1,-                                       ;event enable = yes
          HE = 1,-                                       ;history enable = no
          HA = 2,-                                       ;history activation = update
          HF = 1,-                                       ;history at first update = yes
          HL = BIT_MASK(15),-                            ;history log number = 15
          HI = 0,-                                       ;upper alarm limit = 0
          HW = 0,-                                       ;upper warning limit = 0
          LW = 0,-                                       ;lower warning limit = 0
          LI = 0,-                                       ;lower alarm limit = 0
          ST = "Add Cause",-                             ;unit of value
          SN = "1_1",-                                   ;scale name
          SZ = 1,-                                       ;zone supervision = SCADA
          RC = 0,-                                       ;receipt = acknowledgement not required
          AB = 0,-                                       ;alarm blocking = no
          AC = 0,-                                       ;alarm class = disabled
          AD = 0,-                                       ;alarm delay = 0
          PD = 0,-                                       ;picture device = none
          PI = "",-                                      ;alarm picture
          PF = "FORM5SAGR1",-                            ;physical format for printout
          EH = "SAGR_FORM5FPAI5_0",-                     ;Event Handling
          RI = 0,-                                      ;dynamic texts for printout
          PA = 1,-                                       ;printout activation = update
          PU = 1,-                                       ;picture/ printout at first update = yes
          LD = 0,-                                       ;listing device = none
          IN = %IN(%I_START),-                           ;
          RX = %RX(%I_START)))                           ;group information


#BLOCK_END

#IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK

	@I_LOOPS = 1
	#IF 'ID'_PICTURE_FUNCTION_CONF:VSWITCHING_DEVICE_TYPE == "Q3" #THEN @I_LOOPS = 2
	
	#LOOP_WITH I = 1 .. %I_LOOPS
		@v_objs = dec_scan(substr(list_attr(%p_objects), 6, 0))
      @I_INDEX = %v_objs(length(%v_objs)) + 1
		#IF %I == 1 #THEN @V_IND = (70, 71, 72)
		#ELSE @V_IND = (73, 74, 75)
		#IF 'ID'_PICTURE_FUNCTION_CONF:VOPERATOR_PLACE_HANDLING == "LOC" OR -
			'ID'_PICTURE_FUNCTION_CONF:VOPERATOR_PLACE_HANDLING == "LOC_AND_LOCSTA" #THEN #BLOCK
			
			@DX(%I_INDEX)	= "E7S"
			@HE(%I_INDEX)   = 1                                ;history enable = yes
			@PF(%I_INDEX)   = "FORM5SAGR1"                     ;physical format for printout
			@LD(%I_INDEX)   = BIT_MASK(1)
			@HF(%I_INDEX)   = 0
			@AC(%I_INDEX)   = 0
			@RI(%I_INDEX)   = 47
			@EH(%I_INDEX)   = ""
			@RX(%I_INDEX) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
					 "FP'XX''YY'ILRS"                           	;and group information
				 
			@RX(%I_INDEX) = SUBSTR(%RX(%I_INDEX),1,35) + "CSWI.Loc.stVal"
			
			#IF %b_Fill_IN #THEN @IN(%I_INDEX) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".Loc.stVal"
			#ELSE @IN(%I_INDEX) = ""
			
			#IF ATTRIBUTE_EXISTS(%FPI_SSW, "LR_SWITCH_IND") #THEN @OX(%I_INDEX) = %FPI_SSW.LR_SWITCH_IND
			#ELSE @OX(%I_INDEX) = "Local/Remote-switch"
			
			  #MODIFY P_OBJECTS:V = LIST(P_OBJ'I_INDEX' = LIST(-
				 IX = %V_IND(1),-                                	;index = 10
				 PT = 3,-                                 	;process object type = BI
				 DX = %DX(%I_INDEX),-                    	;directive text
				 OI = %OBJ_IDENT,-                        	;substation & bay name
				 OX = %OX(%I_INDEX),-                     	;object text
				 IU = 1,-                                 	;in use = yes
				 SS = 1,-                                 	;switch state = auto
				 EE = 1,-                                 	;event enable = yes
				 HE = %HE(%I_INDEX),-                      ;history enable
				 HA = 1,-                                  ;history activation = new value
				 HF = %HF(%I_INDEX),-                      ;history at first update = no
				 HL = BIT_MASK(15),-                       ;history log number = 15
				 RC = 1,-                                  ;receipt = acknowledgement required
				 AC = %AC(%I_INDEX),-                      ;alarm class = 1
				 AD = 0,-                                  ;alarm delay = 0
				 PD = 0,-                                  ;picture device = none
				 PI = "",-                                 ;alarm picture
				 PF = %PF(%I_INDEX),-                      ;physical format for printout
				 RI = %RI(%I_INDEX),-                      ;dynamic texts for printout
				 PA = 1,-                                  ;printout activation = new value
				 PU = 0,-                                  ;picture/ printout at first update = no
				 IN = %IN(%I_INDEX),-
				 LD = %LD(%I_INDEX),-                      ;listing device
				 EH = %EH(%I_INDEX),-
				 RX = %RX(%I_INDEX))) ;data acquisition unit and group information
			
		#BLOCK_END
		
		#IF 'ID'_PICTURE_FUNCTION_CONF:VOPERATOR_PLACE_HANDLING == "LOCSTA" OR -
			'ID'_PICTURE_FUNCTION_CONF:VOPERATOR_PLACE_HANDLING == "LOC_AND_LOCSTA" #THEN #BLOCK
		
			@v_objs = dec_scan(substr(list_attr(%p_objects), 6, 0))
         @I_INDEX = %v_objs(length(%v_objs)) + 1
			
			@DX(%I_INDEX)	= "E7S"
			@HE(%I_INDEX)   = 1                                ;history enable = yes
			@PF(%I_INDEX)   = "FORM5SAGR1"                     ;physical format for printout
			@LD(%I_INDEX)   = BIT_MASK(1)
			@HF(%I_INDEX)   = 0
			@AC(%I_INDEX)   = 0
			@RI(%I_INDEX)   = 48
			@EH(%I_INDEX)   = ""
			@RX(%I_INDEX) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
					 "FP'XX''YY'IOPS"                           	;and group information
				 
			@RX(%I_INDEX) = SUBSTR(%RX(%I_INDEX),1,35) + "CSWI.LocSta.stVal"
			
			#IF %b_Fill_IN #THEN @IN(%I_INDEX) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".LocSta.stVal"
			#ELSE @IN(%I_INDEX) = ""
			
			#IF ATTRIBUTE_EXISTS(%FPI_SSW, "OP_SWITCH_IND") #THEN @OX(%I_INDEX) = %FPI_SSW.OP_SWITCH_IND
			#ELSE @OX(%I_INDEX) = "Operator place-switch"
			
			  #MODIFY P_OBJECTS:V = LIST(P_OBJ'I_INDEX' = LIST(-
				 IX = %V_IND(2),-                                	;index = 10
				 PT = 3,-                                 	;process object type = BI
				 DX = %DX(%I_INDEX),-                    	;directive text
				 OI = %OBJ_IDENT,-                        	;substation & bay name
				 OX = %OX(%I_INDEX),-                     	;object text
				 IU = 1,-                                 	;in use = yes
				 SS = 1,-                                 	;switch state = auto
				 EE = 1,-                                 	;event enable = yes
				 HE = %HE(%I_INDEX),-                      ;history enable
				 HA = 1,-                                  ;history activation = new value
				 HF = %HF(%I_INDEX),-                      ;history at first update = no
				 HL = BIT_MASK(15),-                       ;history log number = 15
				 RC = 1,-                                  ;receipt = acknowledgement required
				 AC = %AC(%I_INDEX),-                      ;alarm class = 1
				 AD = 0,-                                  ;alarm delay = 0
				 PD = 0,-                                  ;picture device = none
				 PI = "",-                                 ;alarm picture
				 PF = %PF(%I_INDEX),-                      ;physical format for printout
				 RI = %RI(%I_INDEX),-                      ;dynamic texts for printout
				 PA = 1,-                                  ;printout activation = new value
				 PU = 0,-                                  ;picture/ printout at first update = no
				 IN = %IN(%I_INDEX),-
				 LD = %LD(%I_INDEX),-                      ;listing device
				 EH = %EH(%I_INDEX),-
				 RX = %RX(%I_INDEX))) 							 ;data acquisition unit and group information
			  
			  
			@v_objs = dec_scan(substr(list_attr(%p_objects), 6, 0))
         @I_INDEX = %v_objs(length(%v_objs)) + 1
			
			@DX(%I_INDEX)	= "E1"
			@HE(%I_INDEX)   = 1                                ;history enable = yes
			@PF(%I_INDEX)   = "FORM5SAGR1"                     ;physical format for printout
			@LD(%I_INDEX)   = BIT_MASK(1)
			@RI(%I_INDEX)   = 60
			@EH(%I_INDEX)   = ""
			@RX(%I_INDEX) = %ADDITIONAL_IDENT+%UNIT_IDENT+ -   ;function block or channel number, data acquisition unit
					 "FP'XX''YY'COPS"                           	;and group information
				 
			  @RX(%I_INDEX) = SUBSTR(%RX(%I_INDEX),1,35) + "CSWI.LocSta.ctlVal"
			
			#IF %b_Fill_IN #THEN @IN(%I_INDEX) = %t_OPC_Prefix + "." + %v_CSWI_Instance(1) + ".LocSta.ctlVal"
			#ELSE @IN(%I_INDEX) = ""
			
			#IF ATTRIBUTE_EXISTS(%FPI_SSW, "OP_SWITCH_CMD") #THEN @OX(%I_INDEX) = %FPI_SSW.OP_SWITCH_CMD
			#ELSE @OX(%I_INDEX) = "Operator place-switch command"
			
			#MODIFY P_OBJECTS:V = LIST(P_OBJ'I_INDEX' = LIST(-
				  IX = %V_IND(3),-                     	;index = 72
				  PT = 5,-                               	;process object type = BO
				  DX = %DX(%I_INDEX),-                    ;directive text
				  OI = %OBJ_IDENT,-                      	;substation & bay name
				  OX = %OX(%I_INDEX),-                    ;object text
				  IU = 1,-                               	;in use = yes
				  SS = 1,-                               	;switch state = manual
				  EE = 1,-                               	;event enable = yes
				  HE = 1,-                               	;history enable = yes
				  HA = 2,-                               	;history activation = update
				  HF = 1,-                               	;history at first update = yes
				  HL = BIT_MASK(15),-                    	;history log number = 15
				  PF = "FORM5SAGR1",-                    	;physical format for printout
				  RI = %RI(%I_INDEX),-                    ;dynamic texts for printout
				  PA = 2,-                               	;printout activation = update
				  PU = 1,-                               	;picture/ printout at first update = yes
				  LD = BIT_MASK(1),-                     	;listing device = 1
				  IN = %IN(%I_INDEX),-
				  RX = %RX(%I_INDEX)))                    ;data acquisition unit and group information
			  
		#BLOCK_END
	#LOOP_END
#BLOCK_END

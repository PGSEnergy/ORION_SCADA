;read object texts
;Object text (OX) for process objects, event channels and command procedures 
#CREATE FPI_BAY2:V = LIST(-
     LR_SWITCH_IND           = "Group local/remote-switch",-
     LOCAL_IND               = "Group local indication",-
     REMOTE_IND              = "Group remote indication",-
     LR_DISABLED_CMD         = "Group L/R-switch to disabled cmd",-
     LR_LOCAL_CMD            = "Group L/R-switch to local cmd",-
     LR_REMOTE_CMD           = "Group L/R-switch to remote cmd",-
     LR_LOC_REM_CMD          = "Group local/remote command",-
     LR_RESERVED_CMD         = "Group L/R-switch to reserved cmd",-
     OP_SWITCH_IND           = "Group operator place switch",-
     OP_NOT_IN_USE_CMD       = "Group operator place switch to not in use cmd",-
     OP_STATION_CMD          = "Group operator place switch to station cmd",-
     OP_REMOTE_CMD           = "Group operator place switch to remote cmd",-
     OP_STA_REM_CMD          = "Group operator place switch to station/remote cmd",-
     EXTERNAL_INT_SCE_HW_IND = "Ext. interlocking (hardware)",-
     EXTERNAL_INT_SCE_SW_IND = "Ext. interlocking (software)",-
     EXTERNAL_INT_SCE_SW_CMD = "Ext. interlocking command",-
     INTERNAL_INT_SCE_IND    = "Internal interlocking",-
     INTERNAL_INT_SCE_CMD    = "Internal interlocking command",-
     BLOCKINGS               = "Group blockings",-
     MONITOR_EVENT           = "Group selection on monitor",-
	  OP_SWITCH_IND      	  = "Operator place-switch",-
	  OP_SWITCH_CMD           = "Operator place-switch command",-
	  MLTLEV_IND              = "Multilevel control",-
     AI2DB_COMMENT           = "Updates DB from AI",-
     BI22DB_COMMENT          = "Updates DB from two BIs - 1",-
     SETDB_COMMENT           = "Updates DB from two BIs - 2",-
     UPDATE_COMMENT          = "Used for updating objects from the process")

;collect information for object identifier (OI-attribute)
@OBJ_IDENT
#LOOP_WITH I = 1 .. %NR_OF_FIELDS
  #IF %I <= %POINTER_BAY #THEN #BLOCK  
    @FIELD_IDENT = %OBJECT_IDENTIFIER_'I'_NAME
    @OBJ_IDENT=%OBJ_IDENT+SUBSTR('ID'_PICTURE_FUNCTION_CONF:V'FIELD_IDENT',1,%OI_LENGTH'I')
  #BLOCK_END
  #ELSE #LOOP_EXIT
#LOOP_END

@UNIT_IDENT= SUBSTR('ID'_PICTURE_FUNCTION_CONF:VDATA_ACQUISITION_UNIT,1,10)

;command procedure for updating objects from the process
@C_SEARCH = FETCH(0,"C","BPU_UPDATE")
#IF C_SEARCH:VIU == -1 #THEN #BLOCK
  #CREATE BPU_UPDATE:C =LIST(-
       IU = 1,-
       MO = 1,-
       CM = FPI_BAY2:VUPDATE_COMMENT,-
       IN = ("",-
             "#DO READ_TEXT(""SAGR_BBONE/BPU_UPDATE.TXT"")"))
#BLOCK_END

;define 1:1 scale for AI object if it does not exist
@X_SEARCH=FETCH(0,"X","1_1")
#IF X_SEARCH:VIU == -1 #THEN #BLOCK
  #CREATE 1_1:X = LIST(SA = 0)
#BLOCK_END

#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "ANSI" #BLOCK
    ;define 1/1000 scale for ANSI-AI object if it does not exist
    @X_SEARCH = FETCH(0,"X","BPU_1_1000")
    #IF X_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BPU_1_1000:X = LIST(SA = 1, SC = (0,1000,0,1))
    #BLOCK_END

    ;create command procedure for AI to DB updating
    @C_SEARCH = FETCH(0,"C","BPU_AI2DB")
    #IF C_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BPU_AI2DB:C =LIST(-
            IU = 1,-
            MO = 1,-
            CM = FPI_BAY2:VAI2DB_COMMENT,-
          IN = ("@INDEX = %IX-100","#SET ''LN'':P''INDEX'' = LIST(DB=TRUNC(%AI),RT=%RT,RM=%RM,OS=%OS)"))
    #BLOCK_END

    ;create event channel for AI to DB updating command procedure
    @A_SEARCH = FETCH(0,"A","BPU_AI2DB")
    #IF A_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BPU_AI2DB:A=LIST(-
          CM = FPI_BAY2:VAI2DB_COMMENT,-
            OT = "C",-
            ON = "BPU_AI2DB")
    #BLOCK_END
  #BLOCK_END
  
  #WHEN "PROC" #BLOCK
    ;create event channel for 2 BIs to DB updating command procedure
    @A_SEARCH = FETCH(0,"A","BPU_2BI2DB")
    #IF A_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BPU_2BI2DB:A = LIST(-
          CM = FPI_BAY2:VBI22DB_COMMENT,-
            OT = "C",-
            ON = "BPU_2BI2DB")
    #BLOCK_END

    ;create command procedure 1 for 2 BIs to DB updating
    @C1_SEARCH = FETCH(0,"C","BPU_2BI2DB")    
    #IF C1_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BPU_2BI2DB:C =LIST(-
            IU = 1,-
            MO = 1,-
            CM = FPI_BAY2:VBI22DB_COMMENT,-
            IN = ("#IF %IX==110 OR %IX==111 OR %IX==130 #THEN #BLOCK",-
                  "  @IX1 = %IX",-
                  "  @IX2 = %IX-2",-
                  "#BLOCK_END",-
                  "#ELSE #BLOCK",-
                  "  @IX1 = %IX+2",-
                  "  @IX2 = %IX",-
                  "#BLOCK_END",-
                  "@OBJ1_STATUS = ''LN'':POS''IX1''",-
                  "@OBJ2_STATUS = ''LN'':POS''IX2''",-
                  "#IF %OBJ1_STATUS + %OBJ2_STATUS == 0 #THEN #BLOCK",-
                  "  @OBJ1_VALUE = ''LN'':POV''IX1''",-
                  "  @OBJ2_VALUE = ''LN'':POV''IX2''",-
                  "  #IF %OBJ1_VALUE <> %OBJ2_VALUE #THEN #EXEC BPU_SETDB:C (@LN=%LN,@IX=%IX,@RT=%RT,@RM=%RM,@OS=%OS)",-
                  "  #ELSE #EXEC_AFTER 2 BPU_SETDB:C (@LN=%LN,@IX=%IX,@RT=%RT,@RM=%RM,@OS=%OS)",-
                  "#BLOCK_END"))    
    #BLOCK_END

    ;create command procedure 2 for 2 BIs to DB updating
    @C2_SEARCH = FETCH(0,"C","BPU_SETDB")    
    #IF C2_SEARCH:VIU == -1 #THEN #BLOCK
      #CREATE BPU_SETDB:C =LIST(-
            IU = 1,-
            MO = 1,-
            CM = FPI_BAY2:VBI22DB_COMMENT,-
          IN = ("@T0=PACK_TIME(YEAR,MONTH,DAY,0,0,0)",-
                  "",-
                  "#CASE %IX",-
                  "  #WHEN 110 #BLOCK",-
                  "    @IX1=%IX",-
                  "    @IX2=%IX-2",-
                  "    @IX3=10",-
                  "    @IX4=%IX-2",-
                  "  #BLOCK_END",-
                  "  #WHEN 108 #BLOCK",-
                  "    @IX1=%IX+2",-
                  "    @IX2=%IX",-
                  "    @IX3=10",-
                  "    @IX4=%IX+2",-
                  "  #BLOCK_END",-
                  "  #WHEN 111 #BLOCK",-
                  "    @IX1=%IX",-
                  "    @IX2=%IX-2",-
                  "    @IX3=11",-
                  "    @IX4=%IX-2",-
                  "  #BLOCK_END",-                 
                  "  #WHEN 109 #BLOCK",-
                  "    @IX1=%IX+2",-
                  "    @IX2=%IX",-
                  "    @IX3=11",-
                  "    @IX4=%IX+2",-
                  "  #BLOCK_END",-                 
                  "  #WHEN 130 #BLOCK",-
                  "    @IX1=%IX",-
                  "    @IX2=%IX-2",-
                  "    @IX3=30",-
                  "    @IX4=%IX-2",-
                  "  #BLOCK_END",-
                  "  #WHEN 128 #BLOCK",-
                  "    @IX1=%IX+2",-
                  "    @IX2=%IX",-
                  "    @IX3=30",-
                  "    @IX4=%IX+2",-
                  "  #BLOCK_END",-
                  "#CASE_END",-
                  "@VALUE = 2*''LN'':P''IX1''+''LN'':P''IX2''",-
                  "#IF (''LN'':PRT''IX''-%T0)+''LN'':PRM''IX''/1000 >= -",-
                  "    (''LN'':PRT''IX4''-%T0)+''LN'':PRM''IX4''/1000 -",-
                  "    #THEN #SET ''LN'':P''IX3'' = LIST(DB=ROUND(%VALUE),RT=%RT,RM=%RM,OS=%OS)"))
    #BLOCK_END
  #BLOCK_END
#CASE_END

#IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
      @v_LN_OPC_Instances = vector
      @t_OPC_Prefix = ""
      @v_LLN0_Instance(1) = ""
      @v_Dots = vector

      #if length('ID'_PICTURE_FUNCTION_CONF:VOPC_LN_INSTANCES) > 0 #then #block
			@v_LN_OPC_Instances = 'ID'_PICTURE_FUNCTION_CONF:VOPC_LN_INSTANCES
			@v_LN_OPC_Instances = pick(%v_LN_OPC_Instances, sort(%v_LN_OPC_Instances))
				
			#loop_with i = 1 .. length(%v_LN_OPC_Instances)
				@v_Dots = locate(%v_LN_OPC_Instances(%i),".","ALL")
				@t_OPC_Prefix = 'ID'_PICTURE_FUNCTION_CONF:VOPC_ITEM_PREFIX
				@v_LLN0_Instance = pick(%v_LN_OPC_Instances,select(locate(%v_LN_OPC_Instances,"LLN0"),">0"))			
				#if length(%v_LLN0_Instance) == 0 or length(%v_Dots) > 0 #then #block
					#if length(%v_Dots) > 0 #then #block
						@v_LLN0_Instance(%i) = %v_LN_OPC_Instances(%i)
					#block_end
					#else @v_LLN0_Instance(%i) = ""
				#block_end
			#loop_end
      #block_end

      #IF DATA_TYPE('ID'_PICTURE_FUNCTION_CONF:VDEFINE_ITEM_NAME) <> "NONE" #THEN - 
         @b_Fill_IN = 'ID'_PICTURE_FUNCTION_CONF:VDEFINE_ITEM_NAME
      #ELSE @b_Fill_IN = false
#BLOCK_END
@IN(1..10) = ""

;initialize variables
@DX
@OX
@IU
@HE
@PF
@PT
@LD
@P_OBJ01
@P_OBJ02
@P_OBJ03
@P_OBJ04
@P_OBJ05
@P_OBJ06
@P_OBJ07
@P_OBJ08
@P_OBJ09
@P_OBJ10
@P_OBJ11
@P_OBJ12
@P_OBJ13
@P_OBJ14
@P_OBJ15
@P_OBJ16
@P_OBJ17
@P_OBJ18
@P_OBJECTS = LIST()

;input object for local/remote -indication
;binary (single) indication

@RX(1) = "          "+%UNIT_IDENT+"DPAGROILRS"
#IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
   @RX(1) = SUBSTR(%RX(1),1,35) + "LLN0.Loc.stVal"
   @RI = 45
   #IF %b_Fill_IN #THEN #BLOCK
		#IF LENGTH(%v_Dots) == 0 #THEN @IN(1) = %t_OPC_Prefix + "." + %v_LLN0_Instance(1) + ".Loc.stVal"
      #ELSE @IN(1) = %t_OPC_Prefix + "." + %v_LLN0_Instance(1)
   #BLOCK_END
   #ELSE @IN(1) = ""
#BLOCK_END
#ELSE @RI = 1

#IF NOT 'ID'_PICTURE_FUNCTION_CONF:VIND_ANALOG_INPUT #THEN #BLOCK
 #IF NOT 'ID'_PICTURE_FUNCTION_CONF:VIND_DOUBLE_BINARY #THEN #BLOCK

  #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
    #WHEN "SPA" #BLOCK
      @DX(1)    ="N7S"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "LON","LONMARK" #BLOCK
      @DX(1)    ="X7S"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "IEC101","IEC103" #BLOCK
      @DX(1)    ="C3"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "ANSI" #BLOCK
      @DX(1)    ="3"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "PROC" #BLOCK
      @DX(1)    ="O1"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "RTU" #BLOCK
      #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
        @DX(1)  ="I7S"
        @HE(1)  = 0                                    ;history enable = no
        @PF(1)  = "DUMMY"                              ;physical format for printout
        @LD(1)  = 0                                    ;listing device = none
      #BLOCK_END

      #ELSE #BLOCK
        @DX(1)  ="I7S"
        @HE(1)  = 1                                    ;history enable = yes
        @PF(1)  = "FORM5BPU1"                         ;physical format for printout
        @LD(1)  = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END
    #BLOCK_END

    #WHEN "RTU_E" #BLOCK
      #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
        @DX(1)  ="R7S"
        @HE(1)  = 0                                    ;history enable = no
        @PF(1)  = "DUMMY"                              ;physical format for printout
        @LD(1)  = 0                                    ;listing device = none
      #BLOCK_END

      #ELSE #BLOCK
        @DX(1)  ="R7S"
        @HE(1)  = 1                                    ;history enable = yes
        @PF(1)  = "FORM5BPU1"                         ;physical format for printout
        @LD(1)  = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END
    #BLOCK_END

    #WHEN "DNP_30" #BLOCK
      #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
        @DX(1)  ="D3"
        @HE(1)  = 0                                    ;history enable = yes
        @PF(1)  = "DUMMY"                              ;physical format for printout
        @LD(1)  = 0                                    ;listing device = 1
      #BLOCK_END
      
      #ELSE #BLOCK
        @DX(1)  ="D3"
        @HE(1)  = 1                                    ;history enable = yes
        @PF(1)  = "FORM5BPU1"                         ;physical format for printout
        @LD(1)  = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END
    #BLOCK_END

    #WHEN "MODBUS_RTU" #BLOCK
        @DX(1)  ="I7S"
        @HE(1)  = 1                                    ;history enable = yes
        @PF(1)  = "FORM5BPU1"                         ;physical format for printout
        @LD(1)  = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "IEC61850" #BLOCK
      @DX(1)    ="E7S"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END
  #CASE_END
  
  #if 'ID'_PICTURE_FUNCTION_CONF:VBAY_LR_POLARITY == "R1" #then @t_EH = "FD_FORM5_3_1"
  #else @t_EH = "FD_FORM5_3_1X"
  
  #if %IN(1) == "..Loc.stVal" #THEN @IN(1) = ""
  #MODIFY P_OBJECTS:V = LIST(P_OBJ01 = LIST(-
          IX = 10,-                                    ;index = 10
          PT = 3,-                                     ;process object type = BI
          DX = %DX(1),-                                ;directive text
          BI = 1,-                                     ;object value = 1
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VLR_SWITCH_IND,-               ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = %HE(1),-                                ;history enable
          HA = 1,-                                     ;history activation = new value
          HF = 0,-                                     ;history at first update = no
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AG = 0,-                                     ;alarming value = 0
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = %PF(1),-                                ;physical format for printout
          RI = %RI,-                                   ;dynamic texts for printout
          PA = 1,-                                     ;printout activation = new value
          PU = 0,-                                     ;picture/ printout at first update = no
          LD = %LD(1),-                                ;listing device
          IN = %IN(1),-
			 EH = %t_EH,-
          RX = %RX(1))) ;data acquisition unit and group information
 #BLOCK_END

          ;IN = %IN(1),-

 ;double binary indication
 #ELSE_IF 'ID'_PICTURE_FUNCTION_CONF:VIND_DOUBLE_BINARY #THEN #BLOCK
  #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
    #WHEN "SPA" #BLOCK
      @DX(1)    ="N7D"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "LON","LONMARK" #BLOCK
      @DX(1)    ="X7D"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "IEC101","IEC103" #BLOCK
      @DX(1)    ="C12"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "ANSI" #BLOCK
      @DX(1)    ="12"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "PROC" #BLOCK
      @DX(1)    ="12"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END

    #WHEN "RTU" #BLOCK
      #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
        @DX(1)  ="I7D"
        @HE(1)  = 0                                    ;history enable = no
        @PF(1)  = "DUMMY"                              ;physical format for printout
        @LD(1)  = 0                                    ;listing device = none
      #BLOCK_END

      #ELSE #BLOCK
        @DX(1)  ="I7D"
        @HE(1)  = 1                                    ;history enable = yes
        @PF(1)  = "FORM5BPU1"                         ;physical format for printout
        @LD(1)  = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END
    #BLOCK_END

    #WHEN "RTU_E" #BLOCK
      #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
        @DX(1)  ="R7D"
        @HE(1)  = 0                                    ;history enable = no
        @PF(1)  = "DUMMY"                              ;physical format for printout
        @LD(1)  = 0                                    ;listing device = none
      #BLOCK_END

      #ELSE #BLOCK
        @DX(1)  ="R7D"
        @HE(1)  = 1                                    ;history enable = yes
        @PF(1)  = "FORM5BPU1"                         ;physical format for printout
        @LD(1)  = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END
    #BLOCK_END

    #WHEN "DNP_30" #BLOCK
      #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
        @DX(1)  ="D12"
        @HE(1)  = 0                                    ;history enable = yes
        @PF(1)  = "DUMMY"                              ;physical format for printout
        @LD(1)  = 0                                    ;listing device = 1
      #BLOCK_END
      
      #ELSE #BLOCK
        @DX(1)  ="D12"
        @HE(1)  = 1                                    ;history enable = yes
        @PF(1)  = "FORM5BPU1"                         ;physical format for printout
        @LD(1)  = BIT_MASK(1)                          ;listing device = 1
      #BLOCK_END     
    #BLOCK_END

    #WHEN "MODBUS_RTU" #BLOCK
        @DX(1)  ="I7D"
        @HE(1)  = 1                                    ;history enable = yes
        @PF(1)  = "FORM5BPU1"                         ;physical format for printout
        @LD(1)  = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END
    #WHEN "IEC61850" #BLOCK
      @DX(1)    ="E7D"
      @HE(1)    = 1                                    ;history enable = yes
      @PF(1)    = "FORM5BPU1"                         ;physical format for printout
      @LD(1)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END
  #CASE_END
  
  #if %IN(1) == "..Loc.stVal" #THEN @IN(1) = ""
  #MODIFY P_OBJECTS:V = LIST(P_OBJ01 = LIST(-
          IX = 10,-                                    ;index = 10
          PT = 12,-                                    ;process object type = DB
          DX = %DX(1),-                                ;directive text
          DB = 2,-                                     ;object value = 2
          NV = 4,-                                     ;normal value = none
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VLR_SWITCH_IND,-               ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = %HE(1),-                                ;history enable
          HA = 1,-                                     ;history activation = new value
          HF = 0,-                                     ;history at first update = no
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          LA = 0,-                                     ;alarm activation = none
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = %PF(1),-                                ;physical format for printout
          RI = 2,-                                     ;dynamic texts for printout
          PA = 1,-                                     ;printout activation = new value
          PU = 0,-                                     ;picture/ printout at first update = no
          LD = %LD(1),-                                ;listing device
          IN = %IN(1),-
			 EH = "FD_FORM5_12_1",-
          RX = %RX(1)))                                ;data acquisition unit and group information
 #BLOCK_END
#BLOCK_END
#ELSE #BLOCK
 #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "SPA" #BLOCK
    @DX(11)="N6"
  #BLOCK_END

  #WHEN "LON","LONMARK" #BLOCK
    @DX(11)="X6"
  #BLOCK_END

  #WHEN "IEC101","IEC103" #BLOCK
    @DX(11)="C9"
  #BLOCK_END

  #WHEN "ANSI" #BLOCK
    @DX(11)="9"
  #BLOCK_END

  #WHEN "PROC" #BLOCK
    @DX(11)="O2"
  #BLOCK_END

  #WHEN "RTU" #BLOCK
    @DX(11)="I6"
  #BLOCK_END

  #WHEN "RTU_E" #BLOCK
    @DX(11)="R6"
  #BLOCK_END

  #WHEN "DNP_30" #BLOCK
    @DX(11)="D9"
  #BLOCK_END

  #WHEN "MODBUS_RTU" #BLOCK
    @DX(11)="I6"
  #BLOCK_END

  #WHEN "IEC61850" #BLOCK
    @DX(11)="E6"
  #BLOCK_END

#CASE_END

@LD(1)    = BIT_MASK(1)

#MODIFY P_OBJECTS:V = LIST(P_OBJ01 = LIST(-
          IX = 10,-                                    ;index = 20
          PT = 9,-                                     ;process object type = AI
          DX = %DX(11),-                               ;directive text
          AI = 0,-                                     ;object value = 0
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VLR_SWITCH_IND,-               ;object text
          IU = 1,-                                     ;in use = yes
          SS = 2,-                                     ;switch state = auto
          EE = 1,-                                     ;event enable = yes
          HE = 1,-                                     ;history enable = yes
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          HI = 0,-                                     ;upper alarm limit = 0
          HW = 0,-                                     ;upper warning limit = 0
          LW = 0,-                                     ;lower warning limit = 0
          LI = 0,-                                     ;lower alarm limit = 0
          ST = "Indication",-                           ;unit of value
          SN = "1_1",-                                 ;scale name
          SZ = 1,-                                     ;zone supervision = SCADA
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 17,-                                    ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = yes
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = BIT_MASK(1),-                           ;listing device
			 EH = "FD_FORM5_12_1",-
          RX = %RX(1)))      ;group information

#BLOCK_END

#IF 'ID'_PICTURE_FUNCTION_CONF:VLR_REMOTELY_CONTROLLABLE #THEN #BLOCK
  ;output object for local/remote-switch command
  #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
    #WHEN "SPA" #BLOCK
      @DX(2..5)    ="N1"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 5 
    #BLOCK_END

    #WHEN "LON","LONMARK" #BLOCK
      @DX(2..5)    ="X1"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 5 
    #BLOCK_END

    #WHEN "IEC101","IEC103" #BLOCK
      @DX(2..5)    ="C5"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 5 
    #BLOCK_END

    #WHEN "ANSI" #BLOCK
      @DX(2..5)    ="5"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 5 
    #BLOCK_END

    #WHEN "PROC" #BLOCK
      @DX(2..5)    ="O7"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 7 
    #BLOCK_END

    #WHEN "RTU" #BLOCK
      @DX(2..5)    ="I1"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 5 
    #BLOCK_END

    #WHEN "RTU_E" #BLOCK
      @DX(2..5)    ="R1"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 5 
    #BLOCK_END

    #WHEN "DNP_30" #BLOCK
      @DX(2..5)    ="D5"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 5
      #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(102..105)="D3T" 
    #BLOCK_END

    #WHEN "MODBUS_RTU" #BLOCK
      @DX(2..5)    ="I1"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 5 
    #BLOCK_END

    #WHEN "IEC61850" #BLOCK
      @DX(2..5)    ="E1"
      @IU(2..5)    = 0
      @IU(3..4)    = 1
      @PT(2..5)    = 5 
    #BLOCK_END
  #CASE_END

  @OX(2)   = FPI_BAY2:VLR_DISABLED_CMD
  @OX(3)   = FPI_BAY2:VLR_LOCAL_CMD
  @OX(4)   = FPI_BAY2:VLR_REMOTE_CMD
  @OX(5)   = FPI_BAY2:VLR_RESERVED_CMD
  @RI(2..5)= 2

  #IF 'ID'_PICTURE_FUNCTION_CONF:VIND_DOUBLE_BINARY #THEN #BLOCK
    @START_INDEX = 2
    @STOP_INDEX  = 5
  #BLOCK_END
  #ELSE #BLOCK
    #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
       @START_INDEX = 2
       @STOP_INDEX  = 2
       @OX(2) = "Bay local/remote command"
       #IF DATA_TYPE(FPI_BAY2:VLR_LOC_REM_CMD) <> "NONE" #THEN @OX(2)= FPI_BAY2:VLR_LOC_REM_CMD
       @IU(2) = 1
       @RI(2) = 59
    #BLOCK_END
    #ELSE #BLOCK
       @START_INDEX = 3
       @STOP_INDEX  = 4
    #BLOCK_END
  #BLOCK_END
  @RX(2..5) = "          "+%UNIT_IDENT+"DPAGROCLRS"
  #IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE == "IEC61850" #THEN #BLOCK
     @RX(2..5) = SUBSTR(%RX(2),1,35) + "LLN0.Loc.ctlVal"
     #IF %b_Fill_IN AND NOT('ID'_PICTURE_FUNCTION_CONF:VIND_DOUBLE_BINARY) #THEN -
        @IN(2..5) = %t_OPC_Prefix + "." + %v_LLN0_Instance(1) + ".Loc.ctlVal"
  #BLOCK_END

  #LOOP_WITH I = %START_INDEX .. %STOP_INDEX
    @P_OBJ0'I'_LIST = LIST(-
          IX = 9 + %I,-                                ;index
          PT = %PT('I'),-                              ;process object type = BO (PROCOL=DO)
          DX = %DX(%I),-                               ;directive text
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = %OX('I'),-                              ;object text
          IU = %IU('I'),-                              ;in use 
          SS = 2,-                                     ;switch state = auto
          EE = 1,-                                     ;event enable = yes
          HE = 1,-                                     ;history enable = yes
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 2,-                                     ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = update
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = BIT_MASK(1),-                           ;listing device = 1
          IN = %IN(%I),-
          RX = %RX(%I))                                ;data acquisition unit and group information

    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
      #WHEN "IEC101" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
          TY = 45)                                     ;type identification (ASDU) 45 = single command, 46 = double command
      #WHEN "IEC103" #MODIFY P_OBJ0'I'_LIST:V = LIST(-
          TY = 0)                                     ;type identification (ASDU) 20 = general command
      #WHEN "DNP_30" #BLOCK 
          #IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN #BLOCK
          @TMP_INDEX = %I + 100 
     @P_OBJ0'TMP_INDEX'_LIST = LIST(-
          IX = 109+%I,-                             ;index 
          PT = 3,-                                  ;process object type = BI (PROCOL=DO)
          DX = %DX(%I+100),-                        ;directive text
          OI = %OBJ_IDENT,-                         ;substation & bay name
          OX = %OX('I'),-                           ;object text
          IU = 1,-                                  ;in use = yes
          SS = 1,-                                  ;switch state = manual
          EE = 1,-                                  ;event enable = yes
          HE = 0,-                                  ;history enable = no
          HA = 2,-                                  ;history activation = update
          HF = 1,-                                  ;history at first update = yes
          HL = BIT_MASK(15),-                       ;history log number = 15
          PF = "FORM5BPU1",-                       ;physical format for printout
          RI = 2,-                                  ;dynamic texts for printout
          PA = 2,-                                  ;printout activation = update
          PU = 1,-                                  ;picture/ printout at first update = yes
          LD = 0,-                                  ;listing device = 0
          RX =  %RX(%I))                            ;data acquisition unit and group information
 
          #MODIFY P_OBJECTS:V = LIST(P_OBJ0'TMP_INDEX'=%P_OBJ0'TMP_INDEX'_LIST)
          #BLOCK_END
       #BLOCK_END                              
    #CASE_END
    #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I'=%P_OBJ0'I'_LIST)
  #LOOP_END
#BLOCK_END

;external interlocking in use/out of use (hardware switch) -indication
#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "SPA" #BLOCK
    @DX(6)    ="N7S"
    @HE(6)    = 1                                      ;history enable = yes
    @PF(6)    = "FORM5BPU1"                           ;physical format for printout
    @LD(6)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "LON","LONMARK" #BLOCK
    @DX(6)    ="X7S"
    @HE(6)    = 1                                      ;history enable = yes
    @PF(6)    = "FORM5BPU1"                           ;physical format for printout
    @LD(6)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "IEC101","IEC103" #BLOCK
    @DX(6)    ="C3"
    @HE(6)    = 1                                      ;history enable = yes
    @PF(6)    = "FORM5BPU1"                           ;physical format for printout
    @LD(6)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "ANSI" #BLOCK
    @DX(6)    ="3"
    @HE(6)    = 1                                      ;history enable = yes
    @PF(6)    = "FORM5BPU1"                           ;physical format for printout
    @LD(6)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "PROC" #BLOCK
    @DX(6)    ="O1"
    @HE(6)    = 1                                      ;history enable = yes
    @PF(6)    = "FORM5BPU1"                           ;physical format for printout
    @LD(6)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "RTU" #BLOCK
    #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
      @DX(6)    ="I7S" 
      @HE(6)    = 0                                    ;history enable = no
      @PF(6)    = "DUMMY"                              ;physical format for printout
      @LD(6)    = 0                                    ;listing device = none
    #BLOCK_END

    #ELSE #BLOCK
      @DX(6)    ="I7S" 
      @HE(6)    = 1                                    ;history enable = yes
      @PF(6)    = "FORM5BPU1"                         ;physical format for printout
      @LD(6)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END
  #BLOCK_END

  #WHEN "RTU_E" #BLOCK
    #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
      @DX(6)    ="R7S"
      @HE(6)    = 0                                    ;history enable = no
      @PF(6)    = "DUMMY"                              ;physical format for printout
      @LD(6)    = 0                                    ;listing device = none
    #BLOCK_END

    #ELSE #BLOCK
      @DX(6)    ="R7S"
      @HE(6)    = 1                                    ;history enable = yes
      @PF(6)    = "FORM5BPU1"                         ;physical format for printout
      @LD(6)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END
  #BLOCK_END

  #WHEN "DNP_30" #BLOCK
    #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
      @DX(6)    ="D3" 
      @HE(6)    = 0                                    ;history enable = yes
      @PF(6)    = "DUMMY"                              ;physical format for printout
      @LD(6)    = 0                                    ;listing device = 1
    #BLOCK_END
    
    #ELSE #BLOCK
      @DX(6)    ="D3" 
      @HE(6)    = 1                                    ;history enable = yes
      @PF(6)    = "FORM5BPU1"                         ;physical format for printout
      @LD(6)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END
  #BLOCK_END

  #WHEN "MODBUS_RTU" #BLOCK
      @DX(6)    ="I7S" 
      @HE(6)    = 1                                    ;history enable = yes
      @PF(6)    = "FORM5BPU1"                         ;physical format for printout
      @LD(6)    = BIT_MASK(1)                          ;listing device = 1
  #BLOCK_END

  #WHEN "IEC61850" #BLOCK
    @DX(6)    ="E7S"
    @HE(6)    = 1                                      ;history enable = yes
    @PF(6)    = "FORM5BPU1"                           ;physical format for printout
    @LD(6)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END
#CASE_END

#MODIFY P_OBJECTS:V = LIST(P_OBJ06 = LIST(-
          IX = 15,-                                    ;index = 15
          PT = 3,-                                     ;process object type = BI
          DX = %DX(6),-                                ;directive text
          BI = 1,-                                     ;object value = 1
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VEXTERNAL_INT_SCE_HW_IND,-     ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = %HE(6),-                                ;history enable
          HA = 1,-                                     ;history activation = new value
          HF = 0,-                                     ;history at first update = no
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 1,-                                     ;receipt = acknowledgement required
          AB = 0,-                                     ;alarm blocking = no
          AC = 1,-                                     ;alarm class = 1
          AG = 0,-                                     ;alarming value = 0
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = %PF(6),-                                ;physical format for printout
          RI = 2,-                                     ;dynamic texts for printout
          PA = 1,-                                     ;printout activation = new value
          PU = 0,-                                     ;picture/ printout at first update = no
          LD = %LD(6),-                                ;listing device
          RX = "          "+%UNIT_IDENT+"DPAGROIINH")) ;data acquisition unit and group information

;external interlocking in use/out of use (software switch) -indication
#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "SPA" #BLOCK
    @DX(7)    ="N7S"
    @HE(7)    = 1                                      ;history enable = yes
    @PF(7)    = "FORM5BPU1"                           ;physical format for printout
    @LD(7)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "LON","LONMARK" #BLOCK
    @DX(7)    ="X7S"
    @HE(7)    = 1                                      ;history enable = yes
    @PF(7)    = "FORM5BPU1"                           ;physical format for printout
    @LD(7)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "IEC101","IEC103" #BLOCK
    @DX(7)    ="C3"
    @HE(7)    = 1                                      ;history enable = yes
    @PF(7)    = "FORM5BPU1"                           ;physical format for printout
    @LD(7)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "ANSI" #BLOCK
    @DX(7)    ="3"
    @HE(7)    = 1                                      ;history enable = yes
    @PF(7)    = "FORM5BPU1"                           ;physical format for printout
    @LD(7)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "PROC" #BLOCK
    @DX(7)    ="O1"
    @HE(7)    = 1                                      ;history enable = yes
    @PF(7)    = "FORM5BPU1"                           ;physical format for printout
    @LD(7)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END

  #WHEN "RTU" #BLOCK
    #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
      @DX(7)    ="I7S" 
      @HE(7)    = 0                                    ;history enable = no
      @PF(7)    = "DUMMY"                              ;physical format for printout
      @LD(7)    = 0                                    ;listing device = none
    #BLOCK_END

    #ELSE #BLOCK
      @DX(7)    ="I7S" 
      @HE(7)    = 1                                    ;history enable = yes
      @PF(7)    = "FORM5BPU1"                         ;physical format for printout
      @LD(7)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END
  #BLOCK_END

  #WHEN "RTU_E" #BLOCK
    #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
      @DX(7)    ="R7S"
      @HE(7)    = 0                                    ;history enable = no
      @PF(7)    = "DUMMY"                              ;physical format for printout
      @LD(7)    = 0                                    ;listing device = none
    #BLOCK_END

    #ELSE #BLOCK
      @DX(7)    ="R7S"
      @HE(7)    = 1                                    ;history enable = yes
      @PF(7)    = "FORM5BPU1"                         ;physical format for printout
      @LD(7)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END
  #BLOCK_END

  #WHEN "DNP_30" #BLOCK
    #IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
      @DX(7)    ="D3" 
      @HE(7)    = 0                                    ;history enable = yes
      @PF(7)    = "DUMMY"                              ;physical format for printout
      @LD(7)    = 0                                    ;listing device = 1
    #BLOCK_END
    
    #ELSE #BLOCK
      @DX(7)    ="D3" 
      @HE(7)    = 1                                    ;history enable = yes
      @PF(7)    = "FORM5BPU1"                         ;physical format for printout
      @LD(7)    = BIT_MASK(1)                          ;listing device = 1
    #BLOCK_END
  #BLOCK_END

  #WHEN "MODBUS_RTU" #BLOCK
      @DX(7)    ="I7S" 
      @HE(7)    = 1                                    ;history enable = yes
      @PF(7)    = "FORM5BPU1"                         ;physical format for printout
      @LD(7)    = BIT_MASK(1)                          ;listing device = 1
  #BLOCK_END

  #WHEN "IEC61850" #BLOCK
    @DX(7)    ="E7S"
    @HE(7)    = 1                                      ;history enable = yes
    @PF(7)    = "FORM5BPU1"                           ;physical format for printout
    @LD(7)    = BIT_MASK(1)                            ;listing device = 1
  #BLOCK_END
#CASE_END

#MODIFY P_OBJECTS:V = LIST(P_OBJ07 = LIST(-
          IX = 16,-                                    ;index = 16
          PT = 3,-                                     ;process object type = BI
          DX = %DX(7),-                                ;directive text
          BI = 1,-                                     ;object value = 1
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VEXTERNAL_INT_SCE_SW_IND,-     ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = %HE(7),-                                ;history enable
          HA = 1,-                                     ;history activation = new value
          HF = 0,-                                     ;history at first update = no
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 1,-                                     ;receipt = acknowledgement required
          AB = 0,-                                     ;alarm blocking = no
          AC = 1,-                                     ;alarm class = 1
          AG = 0,-                                     ;alarming value = 0
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = %PF(7),-                                ;physical format for printout
          RI = 2,-                                     ;dynamic texts for printout
          PA = 1,-                                     ;printout activation = new value
          PU = 0,-                                     ;picture/ printout at first update = no
          LD = %LD(7),-                                ;listing device
          RX = "          "+%UNIT_IDENT+"DPAGROIINH")) ;data acquisition unit and group information

;output object for external interlocking in use/out of use (software switch) -command
#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "SPA" #BLOCK
    @DX(8)    ="N1"
    @PT(8)    = 5 
  #BLOCK_END

  #WHEN "LON","LONMARK" #BLOCK
    @DX(8)    ="X1"
    @PT(8)    = 5 
  #BLOCK_END

  #WHEN "IEC101","IEC103" #BLOCK
    @DX(8)    ="C5"
    @PT(8)    = 5 
  #BLOCK_END

  #WHEN "ANSI" #BLOCK
    @DX(8)    ="5"
    @PT(8)    = 5 
  #BLOCK_END

  #WHEN "PROC" #BLOCK
    @DX(8)    ="O7"
    @PT(8)    = 7 
  #BLOCK_END

  #WHEN "RTU" #BLOCK
    @DX(8)    ="I1"
    @PT(8)    = 5 
  #BLOCK_END

  #WHEN "RTU_E" #BLOCK
    @DX(8)    ="R1"
    @PT(8)    = 5 
  #BLOCK_END

  #WHEN "DNP_30" #BLOCK
    @DX(8)    ="D5"
    @PT(8)    = 5 
  #BLOCK_END

  #WHEN "MODBUS_RTU" #BLOCK
    @DX(8)    ="I1"
    @PT(8)    = 5 
  #BLOCK_END

  #WHEN "IEC61850" #BLOCK
    @DX(8)    ="E1"
    @PT(8)    = 5 
  #BLOCK_END

#CASE_END

@P_OBJ08_LIST = LIST(-
          IX = 17,-                                    ;index = 17
          PT = %PT(8),-                                ;process object type = BO (PROCOL=DO)
          DX = %DX(8),-                                ;directive text
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VEXTERNAL_INT_SCE_SW_CMD,-     ;object text
          IU = 1,-                                     ;in use = yes
          SS = 2,-                                     ;switch state = auto
          EE = 0,-                                     ;event enable = no
          HE = 1,-                                     ;history enable = yes
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 3,-                                     ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = update
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = BIT_MASK(1),-                           ;listing device = 1
          RX = "          "+%UNIT_IDENT+"DPAGROCINH")  ;data acquisition unit and group information

#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "IEC101" #MODIFY P_OBJ08_LIST:V = LIST(-
          TY = 45)                                     ;type identification (ASDU) 45 = single command, 46 = double command
  #WHEN "IEC103" #MODIFY P_OBJ08_LIST:V = LIST(-
          TY = 0)                                     ;type identification (ASDU) 20 = general command
#CASE_END
#MODIFY P_OBJECTS:V = LIST(P_OBJ08=%P_OBJ08_LIST)

;internal interlocking in use/out of use -indication
#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "SPA" #BLOCK
    @DX(9)    ="N7S"
  #BLOCK_END

  #WHEN "LON","LONMARK" #BLOCK
    @DX(9)    ="X7S"
  #BLOCK_END

  #WHEN "IEC101","IEC103" #BLOCK
    @DX(9)    ="C3"
  #BLOCK_END

  #WHEN "ANSI" #BLOCK
    @DX(9)    ="3"
  #BLOCK_END

  #WHEN "PROC" #BLOCK
    @DX(9)    ="O1"
  #BLOCK_END

  #WHEN "RTU" #BLOCK
    @DX(9)    ="I7S"
  #BLOCK_END

  #WHEN "RTU_E" #BLOCK
    @DX(9)    ="R7S"
  #BLOCK_END

  #WHEN "DNP_30" #BLOCK
    @DX(9)    ="D3"
  #BLOCK_END

  #WHEN "MODBUS_RTU" #BLOCK
    @DX(9)    ="I7S"
  #BLOCK_END

  #WHEN "IEC61850" #BLOCK
    @DX(9)    ="E7S"
  #BLOCK_END

#CASE_END               

#MODIFY P_OBJECTS:V = LIST(P_OBJ09 = LIST(-
          IX = 18,-                                    ;index = 18
          PT = 3,-                                     ;process object type = BI
          DX = %DX(9),-                                ;directive text
          BI = 1,-                                     ;object value = 1
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VINTERNAL_INT_SCE_IND,-        ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = 1,-                                     ;history enable = yes
          HA = 1,-                                     ;history activation = new value
          HF = 0,-                                     ;history at first update = no
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 1,-                                     ;receipt = acknowledgement required
          AB = 0,-                                     ;alarm blocking = no
          AC = 1,-                                     ;alarm class = 1
          AG = 0,-                                     ;alarming value = 0
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 2,-                                     ;dynamic texts for printout
          PA = 1,-                                     ;printout activation = new value
          PU = 0,-                                     ;picture/ printout at first update = no
          LD = BIT_MASK(1),-                           ;listing device = 1
          RX = "          "+%UNIT_IDENT+"DPAGROIINH")) ;data acquisition unit and group information

;output object for internal interlocking in use/out of use -command
#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "SPA" #BLOCK
    @DX(10)    ="N1"
    @PT(10)    = 5 
  #BLOCK_END

  #WHEN "LON","LONMARK" #BLOCK
    @DX(10)    ="X1"
    @PT(10)    = 5 
  #BLOCK_END

  #WHEN "IEC101","IEC103" #BLOCK
    @DX(10)    ="C5"
    @PT(10)    = 5 
  #BLOCK_END

  #WHEN "ANSI" #BLOCK
    @DX(10)    ="5"
    @PT(10)    = 5 
  #BLOCK_END

  #WHEN "PROC" #BLOCK
    @DX(10)    ="O7"
    @PT(10)    = 7 
  #BLOCK_END

  #WHEN "RTU" #BLOCK
    @DX(10)    ="I1"
    @PT(10)    = 5 
  #BLOCK_END

  #WHEN "RTU_E" #BLOCK
    @DX(10)    ="R1"
    @PT(10)    = 5 
  #BLOCK_END

  #WHEN "DNP_30" #BLOCK
    @DX(10)    ="D5"
    @PT(10)    = 5 
  #BLOCK_END

  #WHEN "MODBUS_RTU" #BLOCK
    @DX(10)    ="I1"
    @PT(10)    = 5 
  #BLOCK_END

  #WHEN "IEC61850" #BLOCK
    @DX(10)    ="E1"
    @PT(10)    = 5 
  #BLOCK_END

#CASE_END

@P_OBJ10_LIST = LIST(-
          IX = 19,-                                    ;index = 19
          PT = %PT(10),-                               ;process object type = BO (PROCOL=DO)
          DX = %DX(10),-                               ;directive text
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VINTERNAL_INT_SCE_CMD,-        ;object text
          IU = 1,-                                     ;in use = yes
          SS = 2,-                                     ;switch state = auto
          EE = 0,-                                     ;event enable = no
          HE = 1,-                                     ;history enable = yes
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 3,-                                     ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = update
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = BIT_MASK(1),-                           ;listing device = 1
          RX = "          "+%UNIT_IDENT+"DPAGROCINH")  ;data acquisition unit and group information

#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "IEC101" #MODIFY P_OBJ10_LIST:V = LIST(-
          TY = 45)                                     ;type identification (ASDU) 45 = single command, 46 = double command
  #WHEN "IEC103" #MODIFY P_OBJ10_LIST:V = LIST(-
          TY = 0)                                     ;type identification (ASDU) 20 = general command
#CASE_END
#MODIFY P_OBJECTS:V = LIST(P_OBJ10=%P_OBJ10_LIST)

;Bay blockings
#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "SPA" #BLOCK
    @DX(11)="N6"
  #BLOCK_END

  #WHEN "LON","LONMARK" #BLOCK
    @DX(11)="X6"
  #BLOCK_END

  #WHEN "IEC101","IEC103" #BLOCK
    @DX(11)="C9"
  #BLOCK_END

  #WHEN "ANSI" #BLOCK
    @DX(11)="9"
  #BLOCK_END

  #WHEN "PROC" #BLOCK
    @DX(11)="O2"
  #BLOCK_END

  #WHEN "RTU" #BLOCK
    @DX(11)="I6"
  #BLOCK_END

  #WHEN "RTU_E" #BLOCK
    @DX(11)="R6"
  #BLOCK_END

  #WHEN "DNP_30" #BLOCK
    @DX(11)="D9"
  #BLOCK_END

  #WHEN "MODBUS_RTU" #BLOCK
    @DX(11)="I6"
  #BLOCK_END

  #WHEN "IEC61850" #BLOCK
    @DX(11)="E6"
  #BLOCK_END

#CASE_END

#MODIFY P_OBJECTS:V = LIST(P_OBJ11 = LIST(-
          IX = 20,-                                    ;index = 20
          PT = 9,-                                     ;process object type = AI
          DX = %DX(11),-                               ;directive text
          AI = 0,-                                     ;object value = 0
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VBLOCKINGS,-                   ;object text
          IU = 1,-                                     ;in use = yes
          SS = 2,-                                     ;switch state = auto
          EE = 1,-                                     ;event enable = yes
          HE = 1,-                                     ;history enable = yes
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          HI = 0,-                                     ;upper alarm limit = 0
          HW = 0,-                                     ;upper warning limit = 0
          LW = 0,-                                     ;lower warning limit = 0
          LI = 0,-                                     ;lower alarm limit = 0
          ST = "Blocking",-                            ;unit of value
          SN = "1_1",-                                 ;scale name
          SZ = 1,-                                     ;zone supervision = SCADA
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 2,-                                     ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = yes
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = BIT_MASK(1),-                           ;listing device
			 EH = "FD_FORM5_9_3",-
          RX = "                    DPAGROXBLK"))      ;group information

;Bay selection on monitor
#CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
  #WHEN "SPA" #BLOCK
    @DX(12)   ="N6"
  #BLOCK_END

  #WHEN "LON","LONMARK" #BLOCK
    @DX(12)   ="X6"
  #BLOCK_END

  #WHEN "IEC101","IEC103" #BLOCK
    @DX(12)   ="C9"
  #BLOCK_END

  #WHEN "ANSI" #BLOCK
    @DX(12)   ="9"
  #BLOCK_END

  #WHEN "PROC" #BLOCK
    @DX(12)   ="O2"
  #BLOCK_END

  #WHEN "RTU" #BLOCK
    @DX(12)   ="I6"
  #BLOCK_END

  #WHEN "RTU_E" #BLOCK
    @DX(12)   ="R6"
  #BLOCK_END

  #WHEN "DNP_30" #BLOCK
    @DX(12)   ="D9"
  #BLOCK_END

  #WHEN "MODBUS_RTU" #BLOCK
    @DX(12)   ="I6"
  #BLOCK_END

  #WHEN "IEC61850" #BLOCK
    @DX(12)   ="E6"
  #BLOCK_END

#CASE_END

#MODIFY P_OBJECTS:V = LIST(P_OBJ12 = LIST(-
          IX = 21,-                                    ;index = 21
          PT = 9,-                                     ;process object type = AI
          DX = %DX(12),-                               ;directive text
          AI = 0,-                                     ;object value = 0
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VMONITOR_EVENT,-               ;object text
          IU = 1,-                                     ;in use = yes
          SS = 2,-                                     ;switch state = auto
          EE = 1,-                                     ;event enable = yes
          HE = 0,-                                     ;history enable = no
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          HI = 0,-                                     ;upper alarm limit = 0
          HW = 0,-                                     ;upper warning limit = 0
          LW = 0,-                                     ;lower warning limit = 0
          LI = 0,-                                     ;lower alarm limit = 0
          ST = "Sessions",-                            ;unit of value
          SN = "1_1",-                                 ;scale name
          SZ = 1,-                                     ;zone supervision = SCADA
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "",-                                    ;physical format for printout
          RI = 0,-                                     ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = update
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = 0,-                                     ;listing device = none
          RX = "                    DPAGROXMEV"))      ;group information

;analog input for local/remote -indication (to update ANSI double binary)
#IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="ANSI" AND 'ID'_PICTURE_FUNCTION_CONF:VIND_DOUBLE_BINARY #THEN #BLOCK
  #MODIFY P_OBJECTS:V = LIST(P_OBJ13 = LIST(-
          IX = 110,-                                   ;index = 110
          PT = 9,-                                     ;process object type = AI
          DX = "9",-                                   ;directive text
          AI = 2,-                                     ;object value = 2
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VLR_SWITCH_IND,-               ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = 0,-                                     ;history enable = no
          HA = 0,-                                     ;history activation = alarm
          HF = 0,-                                     ;history at first update = no
          HL = BIT_MASK(15),-                          ;history log number = 15
          HI = 0,-                                     ;upper alarm limit = 0
          HW = 0,-                                     ;upper warning limit = 0
          LW = 0,-                                     ;lower warning limit = 0
          LI = 0,-                                     ;lower alarm limit = 0
          ST = "L/R-sw",-                              ;unit of value
          SN = "BPU_1_1000",-                          ;scale name
          SZ = 1,-                                     ;zone supervision = SCADA
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "",-                                    ;physical format for printout
          RI = 0,-                                     ;dynamic texts for printout
          PA = 0,-                                     ;printout activation = alarm
          PU = 0,-                                     ;picture/ printout at first update = no
          LD = 0,-                                     ;listing device = none
          AN = "BPU_AI2DB",-                           ;action name
          AE = 1,-                                     ;action enabled
          AA = 2,-                                     ;action activation = update
          AF = 1,-                                     ;action at first update = yes
          RX = "          "+%UNIT_IDENT+"DPAGROELRS")) ;data acquisition unit and group information
#BLOCK_END


;binary input for station local/remote -indication (PROCOL)
#IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="PROC" AND 'ID'_PICTURE_FUNCTION_CONF:VIND_DOUBLE_BINARY #THEN #BLOCK

  #MODIFY P_OBJECTS:V = LIST(P_OBJ13 = LIST(-
          IX = 110,-                                   ;index 110
          PT = 3,-                                     ;process object type = BI
          DX = "O1",-                                  ;directive text
          BI = 1,-                                     ;object value = 1
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VREMOTE_IND,-                  ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = 0,-                                     ;history disable
          HA = 1,-                                     ;history activation = new value
          HF = 0,-                                     ;history at first update = no
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AG = 0,-                                     ;alarming value = 0
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "",-                                    ;physical format for printout
          RI = 0,-                                     ;dynamic texts for printout
          PA = 1,-                                     ;printout activation = new value
          PU = 0,-                                     ;picture/ printout at first update = no
          LD = 0,-                                     ;listing device
          AN = "BPU_2BI2DB",-                          ;action name
          AE = 1,-                                     ;action enabled
          AA = 2,-                                     ;action activation = update
          AF = 1,-                                     ;action at first update = yes
          RX = "          "+%UNIT_IDENT+"DPAGROELRS")) ;data acquisition unit and group information

  #MODIFY P_OBJECTS:V = LIST(P_OBJ14 = LIST(-
          IX = 108,-                                   ;index 108
          PT = 3,-                                     ;process object type = BI
          DX = "O1",-                                  ;directive text
          BI = 0,-                                     ;object value = 0
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VLOCAL_IND,-                   ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = 0,-                                     ;history disable
          HA = 1,-                                     ;history activation = new value
          HF = 0,-                                     ;history at first update = no
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AG = 0,-                                     ;alarming value = 0
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "",-                                    ;physical format for printout
          RI = 0,-                                     ;dynamic texts for printout
          PA = 1,-                                     ;printout activation = new value
          PU = 0,-                                     ;picture/ printout at first update = no
          LD = 0,-                                     ;listing device
          AN = "BPU_2BI2DB",-                          ;action name
          AE = 1,-                                     ;action enabled
          AA = 2,-                                     ;action activation = update
          AF = 1,-                                     ;action at first update = yes
          RX = "          "+%UNIT_IDENT+"DPAGROELRS")) ;data acquisition unit and group information
#BLOCK_END

;event recording object for local/remote -indication
#IF ('ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="RTU" OR -
'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="RTU_E" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="DNP_30") -
AND 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK

  ;binary (single) indication
  #IF NOT 'ID'_PICTURE_FUNCTION_CONF:VIND_DOUBLE_BINARY #THEN #BLOCK
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
      #WHEN "RTU" #BLOCK
        @DX(13)   ="I6"
      #BLOCK_END

      #WHEN "RTU_E" #BLOCK
        @DX(13)    ="R10S"
      #BLOCK_END
      
      #WHEN "DNP_30" #BLOCK
        @DX(13)    ="D3"
      #BLOCK_END

    #CASE_END

    #MODIFY P_OBJECTS:V = LIST(P_OBJ13 = LIST(-
          IX = 110,-                                   ;index = 110
          PT = 3,-                                     ;process object type = BI
          DX = %DX(13),-                               ;directive text
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VLR_SWITCH_IND,-               ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = 1,-                                     ;history enable = yes
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AG = 0,-                                     ;alarming value = 0
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 1,-                                     ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = update
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = BIT_MASK(1),-                           ;listing device = 1
          RX = "          "+%UNIT_IDENT+"DPAGROELRS")) ;data acquisition unit and group information
  #BLOCK_END

  ;double binary indication
  #IF 'ID'_PICTURE_FUNCTION_CONF:VIND_DOUBLE_BINARY #THEN #BLOCK
    #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
      #WHEN "RTU" #BLOCK
        @DX(13)    ="I10D"
      #BLOCK_END

      #WHEN "RTU_E" #BLOCK
        @DX(13)    ="R10D"
      #BLOCK_END
      
      #WHEN "DNP_30" #BLOCK
        @DX(13)    ="D12"
      #BLOCK_END
    #CASE_END

    #MODIFY P_OBJECTS:V = LIST(P_OBJ13 = LIST(-
          IX = 110,-                                   ;index = 110
          PT = 12,-                                    ;process object type = DB
          DX = %DX(13),-                               ;directive text
          NV = 4,-                                     ;normal value = none
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VLR_SWITCH_IND,-               ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = 1,-                                     ;history enable = yes
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          LA = 0,-                                     ;alarm activation = none
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 2,-                                     ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = update
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = BIT_MASK(1),-                           ;listing device = 1
          RX = "          "+%UNIT_IDENT+"DPAGROELRS")) ;data acquisition unit and group information
  #BLOCK_END

  ;event recording object for external interlocking in use/out of use (hardware switch) -indication
  #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
    #WHEN "RTU" #BLOCK
      @DX(14)    ="I10S"
    #BLOCK_END

    #WHEN "RTU_E" #BLOCK
      @DX(14)    ="R10S"
    #BLOCK_END
    
    #WHEN "DNP_30" #BLOCK
      @DX(14)    ="D3"
    #BLOCK_END
  #CASE_END

  #MODIFY P_OBJECTS:V = LIST(P_OBJ14 = LIST(-
          IX = 115,-                                   ;index = 115
          PT = 3,-                                     ;process object type = BI
          DX = %DX(14),-                               ;directive text
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VEXTERNAL_INT_SCE_HW_IND,-     ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = 1,-                                     ;history enable = yes
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AG = 0,-                                     ;alarming value = 0
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 2,-                                     ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = update
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = BIT_MASK(1),-                           ;listing device = 1
          RX = "          "+%UNIT_IDENT+"DPAGROEINH")) ;data acquisition unit and group information

  ;event recording object for external interlocking in use/out of use (software switch) -indication
  #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
    #WHEN "RTU" #BLOCK
      @DX(15)    ="I10S"
    #BLOCK_END

    #WHEN "RTU_E" #BLOCK
      @DX(15)    ="R10S"
    #BLOCK_END
    
    #WHEN "DNP_30" #BLOCK
      @DX(15)    ="D3"
    #BLOCK_END
  #CASE_END

  #MODIFY P_OBJECTS:V = LIST(P_OBJ15 = LIST(-
          IX = 116,-                                   ;index = 116
          PT = 3,-                                     ;process object type = BI
          DX = %DX(15),-                               ;directive text
          OI = %OBJ_IDENT,-                            ;substation & bay name
          OX = FPI_BAY2:VEXTERNAL_INT_SCE_HW_IND,-     ;object text
          IU = 1,-                                     ;in use = yes
          SS = 1,-                                     ;switch state = manual
          EE = 1,-                                     ;event enable = yes
          HE = 1,-                                     ;history enable = yes
          HA = 2,-                                     ;history activation = update
          HF = 1,-                                     ;history at first update = yes
          HL = BIT_MASK(15),-                          ;history log number = 15
          RC = 0,-                                     ;receipt = acknowledgement not required
          AB = 0,-                                     ;alarm blocking = no
          AC = 0,-                                     ;alarm class = disabled
          AG = 0,-                                     ;alarming value = 0
          AD = 0,-                                     ;alarm delay = 0
          PD = 0,-                                     ;picture device = none
          PI = "",-                                    ;alarm picture
          PF = "FORM5BPU1",-                          ;physical format for printout
          RI = 2,-                                     ;dynamic texts for printout
          PA = 2,-                                     ;printout activation = update
          PU = 1,-                                     ;picture/ printout at first update = yes
          LD = BIT_MASK(1),-                           ;listing device = 1
          RX = "          "+%UNIT_IDENT+"DPAGROEINH")) ;data acquisition unit and group information
#BLOCK_END

;command termination
#IF 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="IEC101" OR 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE=="IEC103" #THEN #BLOCK
  #IF 'ID'_PICTURE_FUNCTION_CONF:VLR_REMOTELY_CONTROLLABLE #THEN #BLOCK
    ;command termination for bay local/remote-switch command
    @OX(13) = FPI_BAY2:VLR_DISABLED_CMD
    @OX(14) = FPI_BAY2:VLR_LOCAL_CMD
    @OX(15) = FPI_BAY2:VLR_REMOTE_CMD
    @OX(16) = FPI_BAY2:VLR_RESERVED_CMD

    #IF 'ID'_PICTURE_FUNCTION_CONF:VIND_DOUBLE_BINARY #THEN #BLOCK
      @START_INDEX = 13
      @STOP_INDEX  = 16
    #BLOCK_END
    #ELSE #BLOCK
      @START_INDEX = 14
      @STOP_INDEX  = 15
    #BLOCK_END

    #LOOP_WITH I = %START_INDEX .. %STOP_INDEX
      #MODIFY P_OBJECTS:V = LIST(P_OBJ'I' = LIST(-
            IX = 98 + %I,-                             ;index = (111),112,113,(114)
            PT = 9,-                                   ;process object type = AI
            DX = "C9E",-                               ;directive text
            OI = %OBJ_IDENT,-                          ;substation & bay name
            OX = %OX('I'),-                            ;object text
            IU = 1,-                                   ;in use = yes
            SS = 2,-                                   ;switch state = auto
            EE = 1,-                                   ;event enable = yes
            HE = 1,-                                   ;history enable
            HA = 2,-                                   ;history activation = update
            HF = 1,-                                   ;history at first update = yes
            HL = BIT_MASK(15),-                        ;history log number = 15
            HI = 0,-                                   ;upper alarm limit = 0
            HW = 0,-                                   ;upper warning limit = 0
            LW = 0,-                                   ;lower warning limit = 0
            LI = 0,-                                   ;lower alarm limit = 0
            ST = "cmd status",-                        ;unit of value
            SN = "1_1",-                               ;scale name
            SZ = 1,-                                   ;zone supervision = SCADA
            RC = 0,-                                   ;receipt = acknowledgement not required
            AB = 0,-                                   ;alarm blocking = no
            AC = 0,-                                   ;alarm class = 0
            AD = 0,-                                   ;alarm delay = 0
            PD = 0,-                                   ;picture device = none
            PI = "",-                                  ;alarm picture
            PF = "FORM5BPU1",-                        ;physical format for printout
            RI = 10,-                                  ;dynamic texts for printout
            PA = 2,-                                   ;printout activation = update
            PU = 1,-                                   ;picture/ printout at first update = yes
            LD = BIT_MASK(1),-                         ;listing device
            RX = "          "+%UNIT_IDENT+"DPAGROTLRS")) ;data acquisition unit and group information
    #LOOP_END
  #BLOCK_END

  ;command termination for external interlocking in use/out of use (software switch) -command
  #MODIFY P_OBJECTS:V = LIST(P_OBJ17 = LIST(-
            IX = 117,-                                 ;index = 117
            PT = 9,-                                   ;process object type = AI
            DX = "C9E",-                               ;directive text
            OI = %OBJ_IDENT,-                          ;substation & bay name
            OX = FPI_BAY2:VEXTERNAL_INT_SCE_SW_CMD,-   ;object text
            IU = 1,-                                   ;in use = yes
            SS = 2,-                                   ;switch state = auto
            EE = 1,-                                   ;event enable = yes
            HE = 1,-                                   ;history enable
            HA = 2,-                                   ;history activation = update
            HF = 1,-                                   ;history at first update = yes
            HL = BIT_MASK(15),-                        ;history log number = 15
            HI = 0,-                                   ;upper alarm limit = 0
            HW = 0,-                                   ;upper warning limit = 0
            LW = 0,-                                   ;lower warning limit = 0
            LI = 0,-                                   ;lower alarm limit = 0
            ST = "cmd status",-                        ;unit of value
            SN = "1_1",-                               ;scale name
            SZ = 1,-                                   ;zone supervision = SCADA
            RC = 0,-                                   ;receipt = acknowledgement not required
            AB = 0,-                                   ;alarm blocking = no
            AC = 0,-                                   ;alarm class = 0
            AD = 0,-                                   ;alarm delay = 0
            PD = 0,-                                   ;picture device = none
            PI = "",-                                  ;alarm picture
            PF = "FORM5BPU1",-                        ;physical format for printout
            RI = 10,-                                  ;dynamic texts for printout
            PA = 2,-                                   ;printout activation = update
            PU = 1,-                                   ;picture/ printout at first update = yes
            LD = BIT_MASK(1),-                         ;listing device
            RX = "          "+%UNIT_IDENT+"DPAGROTINH")) ;data acquisition unit and group information

  ;command termination for internal interlocking in use/out of use -command
  #MODIFY P_OBJECTS:V = LIST(P_OBJ18 = LIST(-
            IX = 119,-                                 ;index = 119
            PT = 9,-                                   ;process object type = AI
            DX = "C9E",-                               ;directive text
            OI = %OBJ_IDENT,-                          ;substation & bay name
            OX = FPI_BAY2:VINTERNAL_INT_SCE_CMD,-      ;object text
            IU = 1,-                                   ;in use = yes
            SS = 2,-                                   ;switch state = auto
            EE = 1,-                                   ;event enable = yes
            HE = 1,-                                   ;history enable
            HA = 2,-                                   ;history activation = update
            HF = 1,-                                   ;history at first update = yes
            HL = BIT_MASK(15),-                        ;history log number = 15
            HI = 0,-                                   ;upper alarm limit = 0
            HW = 0,-                                   ;upper warning limit = 0
            LW = 0,-                                   ;lower warning limit = 0
            LI = 0,-                                   ;lower alarm limit = 0
            ST = "cmd status",-                        ;unit of value
            SN = "1_1",-                               ;scale name
            SZ = 1,-                                   ;zone supervision = SCADA
            RC = 0,-                                   ;receipt = acknowledgement not required
            AB = 0,-                                   ;alarm blocking = no
            AC = 0,-                                   ;alarm class = 0
            AD = 0,-                                   ;alarm delay = 0
            PD = 0,-                                   ;picture device = none
            PI = "",-                                  ;alarm picture
            PF = "FORM5BPU1",-                        ;physical format for printout
            RI = 10,-                                  ;dynamic texts for printout
            PA = 2,-                                   ;printout activation = update
            PU = 1,-                                   ;picture/ printout at first update = yes
            LD = BIT_MASK(1),-                         ;listing device
            RX = "          "+%UNIT_IDENT+"DPAGROTINH")) ;data acquisition unit and group information
#BLOCK_END

#IF 'ID'_PICTURE_FUNCTION_CONF:VOPERATOR_PLACE_HANDLING == "MS_INTERNAL" #THEN #BLOCK

	@v_attrs = list_attr(%P_OBJECTS)
	@v_attrs = dec_scan(substr(%v_attrs,6,0))
	@v_attrs = pick(%v_attrs,sort(%v_attrs))
	@i_P_OBJ_Nr = %v_attrs(length(%v_attrs)) + 1

	@RX(%i_P_OBJ_Nr) = "          "+%UNIT_IDENT+"DPAGROIOPS"

	;double binary indication
	  #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
		 #WHEN "SPA" #BLOCK
			@DX(%i_P_OBJ_Nr)    ="N7D"
			@HE(%i_P_OBJ_Nr)    = 1                                    ;history enable = yes
			@PF(%i_P_OBJ_Nr)    = "FORM5BPU1"                         ;physical format for printout
			@LD(%i_P_OBJ_Nr)    = BIT_MASK(1)                          ;listing device = 1
		 #BLOCK_END

		 #WHEN "LON","LONMARK" #BLOCK
			@DX(%i_P_OBJ_Nr)    ="X7D"
			@HE(%i_P_OBJ_Nr)    = 1                                    ;history enable = yes
			@PF(%i_P_OBJ_Nr)    = "FORM5BPU1"                         ;physical format for printout
			@LD(%i_P_OBJ_Nr)    = BIT_MASK(1)                          ;listing device = 1
		 #BLOCK_END

		 #WHEN "IEC101","IEC103" #BLOCK
			@DX(%i_P_OBJ_Nr)    ="C12"
			@HE(%i_P_OBJ_Nr)    = 1                                    ;history enable = yes
			@PF(%i_P_OBJ_Nr)    = "FORM5BPU1"                         ;physical format for printout
			@LD(%i_P_OBJ_Nr)    = BIT_MASK(1)                          ;listing device = 1
		 #BLOCK_END

		 #WHEN "ANSI" #BLOCK
			@DX(%i_P_OBJ_Nr)    ="12"
			@HE(%i_P_OBJ_Nr)    = 1                                    ;history enable = yes
			@PF(%i_P_OBJ_Nr)    = "FORM5BPU1"                         ;physical format for printout
			@LD(%i_P_OBJ_Nr)    = BIT_MASK(1)                          ;listing device = 1
		 #BLOCK_END

		 #WHEN "PROC" #BLOCK
			@DX(%i_P_OBJ_Nr)    ="12"
			@HE(%i_P_OBJ_Nr)    = 1                                    ;history enable = yes
			@PF(%i_P_OBJ_Nr)    = "FORM5BPU1"                         ;physical format for printout
			@LD(%i_P_OBJ_Nr)    = BIT_MASK(1)                          ;listing device = 1
		 #BLOCK_END

		 #WHEN "RTU" #BLOCK
			#IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
			  @DX(%i_P_OBJ_Nr)  ="I7D"
			  @HE(%i_P_OBJ_Nr)  = 0                                    ;history enable = no
			  @PF(%i_P_OBJ_Nr)  = "DUMMY"                              ;physical format for printout
			  @LD(%i_P_OBJ_Nr)  = 0                                    ;listing device = none
			#BLOCK_END

			#ELSE #BLOCK
			  @DX(%i_P_OBJ_Nr)  ="I7D"
			  @HE(%i_P_OBJ_Nr)  = 1                                    ;history enable = yes
			  @PF(%i_P_OBJ_Nr)  = "FORM5BPU1"                         ;physical format for printout
			  @LD(%i_P_OBJ_Nr)  = BIT_MASK(1)                          ;listing device = 1
			#BLOCK_END
		 #BLOCK_END

		 #WHEN "RTU_E" #BLOCK
			#IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
			  @DX(%i_P_OBJ_Nr)  ="R7D"
			  @HE(%i_P_OBJ_Nr)  = 0                                    ;history enable = no
			  @PF(%i_P_OBJ_Nr)  = "DUMMY"                              ;physical format for printout
			  @LD(%i_P_OBJ_Nr)  = 0                                    ;listing device = none
			#BLOCK_END

			#ELSE #BLOCK
			  @DX(%i_P_OBJ_Nr)  ="R7D"
			  @HE(%i_P_OBJ_Nr)  = 1                                    ;history enable = yes
			  @PF(%i_P_OBJ_Nr)  = "FORM5BPU1"                         ;physical format for printout
			  @LD(%i_P_OBJ_Nr)  = BIT_MASK(1)                          ;listing device = 1
			#BLOCK_END
		 #BLOCK_END

		 #WHEN "DNP_30" #BLOCK
			#IF 'ID'_PICTURE_FUNCTION_CONF:VEVENT_RECORDING #THEN #BLOCK
			  @DX(%i_P_OBJ_Nr)  ="D12"
			  @HE(%i_P_OBJ_Nr)  = 0                                    ;history enable = yes
			  @PF(%i_P_OBJ_Nr)  = "DUMMY"                              ;physical format for printout
			  @LD(%i_P_OBJ_Nr)  = 0                                    ;listing device = 1
			#BLOCK_END
			
			#ELSE #BLOCK
			  @DX(%i_P_OBJ_Nr)  ="D12"
			  @HE(%i_P_OBJ_Nr)  = 1                                    ;history enable = yes
			  @PF(%i_P_OBJ_Nr)  = "FORM5BPU1"                         ;physical format for printout
			  @LD(%i_P_OBJ_Nr)  = BIT_MASK(1)                          ;listing device = 1
			#BLOCK_END     
		 #BLOCK_END

		 #WHEN "MODBUS_RTU" #BLOCK
			  @DX(%i_P_OBJ_Nr)  ="I7D"
			  @HE(%i_P_OBJ_Nr)  = 1                                    ;history enable = yes
			  @PF(%i_P_OBJ_Nr)  = "FORM5BPU1"                         ;physical format for printout
			  @LD(%i_P_OBJ_Nr)  = BIT_MASK(1)                          ;listing device = 1
		 #BLOCK_END
		 #WHEN "IEC61850" #BLOCK
			@DX(%i_P_OBJ_Nr)    ="E7D"
			@HE(%i_P_OBJ_Nr)    = 1                                    ;history enable = yes
			@PF(%i_P_OBJ_Nr)    = "FORM5BPU1"                         ;physical format for printout
			@LD(%i_P_OBJ_Nr)    = BIT_MASK(1)                          ;listing device = 1
		 #BLOCK_END
	  #CASE_END

	;define CX - text
	@APL_ID=APL:BNA
	@CX="'APL_ID'"
	#IF DATA_TYPE(FPI_BAY2:VOP_SWITCH_IND) == "NONE" #THEN #SET FPI_BAY2:VOP_SWITCH_IND = "Bay operator place switch"

	#IF %i_P_OBJ_Nr < 10 #THEN @TMP_OBJ_NR = "0'i_P_OBJ_Nr'"
	#ELSE @TMP_OBJ_NR = "'i_P_OBJ_Nr'"
	#MODIFY P_OBJECTS:V = LIST(P_OBJ'TMP_OBJ_NR' = LIST(-
				 IX = 22,-                                    ;index = 10
				 PT = 12,-                                    ;process object type = DB
				 DX = %DX(%i_P_OBJ_Nr),-                      ;directive text
				 CX = %CX,-                                   ;comment text
				 DB = 2,-                                     ;object value = 2
				 NV = 4,-                                     ;normal value = none
				 OI = %OBJ_IDENT,-                            ;substation & bay name
				 OX = FPI_BAY2:VOP_SWITCH_IND,-               ;object text
				 IU = 1,-                                     ;in use = yes
				 SS = 1,-                                     ;switch state = manual
				 EE = 1,-                                     ;event enable = yes
				 HE = %HE(%i_P_OBJ_Nr),-                      ;history enable
				 HA = 1,-                                     ;history activation = new value
				 HF = 0,-                                     ;history at first update = no
				 HL = BIT_MASK(15),-                          ;history log number = 15
				 RC = 0,-                                     ;receipt = acknowledgement not required
				 AB = 0,-                                     ;alarm blocking = no
				 AC = 0,-                                     ;alarm class = disabled
				 LA = 0,-                                     ;alarm activation = none
				 AD = 0,-                                     ;alarm delay = 0
				 PD = 0,-                                     ;picture device = none
				 PI = "",-                                    ;alarm picture
				 PF = %PF(%i_P_OBJ_Nr),-                      ;physical format for printout
				 RI = 23,-                                     ;dynamic texts for printout
				 PA = 1,-                                     ;printout activation = new value
				 PU = 0,-                                     ;picture/ printout at first update = no
				 LD = %LD(1),-                                ;listing device
				 RX = %RX(%i_P_OBJ_Nr)))                      ;data acquisition unit and group information


	#SET 'ID'_PICTURE_FUNCTION_CONF:VOP_REMOTELY_CONTROLLABLE = TRUE
	#IF 'ID'_PICTURE_FUNCTION_CONF:VOP_REMOTELY_CONTROLLABLE #THEN #BLOCK
	  ;output object for local/remote-switch command
	  #CASE 'ID'_PICTURE_FUNCTION_CONF:VSTATION_TYPE
		 #WHEN "SPA" #BLOCK
			@DX(2..5)    ="N1"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 5 
		 #BLOCK_END

		 #WHEN "LON","LONMARK" #BLOCK
			@DX(2..5)    ="X1"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 5 
		 #BLOCK_END

		 #WHEN "IEC101","IEC103" #BLOCK
			@DX(2..5)    ="C5"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 5 
		 #BLOCK_END

		 #WHEN "ANSI" #BLOCK
			@DX(2..5)    ="5"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 5 
		 #BLOCK_END

		 #WHEN "PROC" #BLOCK
			@DX(2..5)    ="O7"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 7 
		 #BLOCK_END

		 #WHEN "RTU" #BLOCK
			@DX(2..5)    ="I1"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 5 
		 #BLOCK_END

		 #WHEN "RTU_E" #BLOCK
			@DX(2..5)    ="R1"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 5 
		 #BLOCK_END

		 #WHEN "DNP_30" #BLOCK
			@DX(2..5)    ="D5"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 5
			#IF 'ID'_PICTURE_FUNCTION_CONF:VOUTPUT_STATUS #THEN @DX(102..105)="D3T" 
		 #BLOCK_END

		 #WHEN "MODBUS_RTU" #BLOCK
			@DX(2..5)    ="I1"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 5 
		 #BLOCK_END

		 #WHEN "IEC61850" #BLOCK
			@DX(2..5)    ="E1"
			@IU(2..5)    = 0
			@IU(3..4)    = 1
			@PT(2..5)    = 5 
		 #BLOCK_END
	  #CASE_END

	  #IF DATA_TYPE(FPI_BAY2:VOP_NOT_IN_USE_CMD) == "NONE" #THEN @OX(2) = "Bay operator place switch to not in use cmd"
	  #ELSE @OX(2)   = FPI_BAY2:VOP_NOT_IN_USE_CMD

	  #IF DATA_TYPE(FPI_BAY2:VOP_STATION_CMD) == "NONE" #THEN @OX(3) = "Bay operator place switch to station cmd"
	  #ELSE @OX(3) = FPI_BAY2:VOP_STATION_CMD

	  #IF DATA_TYPE(FPI_BAY2:VOP_REMOTE_CMD) == "NONE" #THEN @OX(4) = "Bay operator place switch to remote cmd"
	  #ELSE @OX(4) = FPI_BAY2:VOP_REMOTE_CMD

	  #IF DATA_TYPE(FPI_BAY2:VOP_STA_REM_CMD) == "NONE" #THEN @OX(5) = "Bay operator place switch to station/remote cmd"
	  #ELSE @OX(5) = FPI_BAY2:VOP_STA_REM_CMD

	  @RI(2..5)= 2
	  
	  @START_INDEX = 2
	  @STOP_INDEX  = 5
	  @RX(2..5) = "          "+%UNIT_IDENT+"DPAGROCOPS"
	  @IN(2..5) = ""

	  @v_attrs = list_attr(%P_OBJECTS)
	  @v_attrs = dec_scan(substr(%v_attrs,6,0))
	  @v_attrs = pick(%v_attrs,sort(%v_attrs))
	  @i_P_OBJ_Nr = %v_attrs(length(%v_attrs)) + 1

	  #LOOP_WITH I = %START_INDEX .. %STOP_INDEX
		 #IF %i_P_OBJ_Nr < 10 #THEN @TMP_OBJ_NR = "0'i_P_OBJ_Nr'"
		 #ELSE @TMP_OBJ_NR = "'i_P_OBJ_Nr'"
		 @P_OBJ'TMP_OBJ_NR'_LIST = LIST(-
				 IX = 21 + %I,-                                ;index
				 PT = %PT('I'),-                              ;process object type = BO (PROCOL=DO)
				 DX = %DX(%I),-                               ;directive text
				 OI = %OBJ_IDENT,-                            ;substation & bay name
				 OX = %OX('I'),-                              ;object text
				 IU = 1,-                                     ;in use 
				 SS = 1,-                                     ;switch state = auto
				 EE = 1,-                                     ;event enable = yes
				 HE = 1,-                                     ;history enable = yes
				 HA = 2,-                                     ;history activation = update
				 HF = 1,-                                     ;history at first update = yes
				 HL = BIT_MASK(15),-                          ;history log number = 15
				 PF = "FORM5BPU1",-                          ;physical format for printout
				 RI = %RI(%I),-                               ;dynamic texts for printout
				 PA = 2,-                                     ;printout activation = update
				 PU = 1,-                                     ;picture/ printout at first update = yes
				 LD = BIT_MASK(1),-                           ;listing device = 1
				 IN = %IN(%I),-
				 RX = %RX(%I))                                ;data acquisition unit and group information
		 #MODIFY P_OBJECTS:V = LIST(P_OBJ'TMP_OBJ_NR' = %P_OBJ'TMP_OBJ_NR'_LIST)
		 @i_P_OBJ_Nr = %i_P_OBJ_Nr + 1

	  #LOOP_END
	#BLOCK_END
#BLOCK_END
#ELSE_IF 'ID'_PICTURE_FUNCTION_CONF:VOPERATOR_PLACE_HANDLING == "LOC_AND_LOCSTA" #THEN #BLOCK

	@v_attrs = list_attr(%P_OBJECTS)
	@v_attrs = dec_scan(substr(%v_attrs,6,0))
	@v_attrs = pick(%v_attrs,sort(%v_attrs))
	@I_INDEX = %v_attrs(length(%v_attrs)) + 1
		
	@DX(%I_INDEX)	= "E7S"
	@HE(%I_INDEX)   = 1                                ;history enable = yes
	@PF(%I_INDEX)   = "FORM5BPU1"                     ;physical format for printout
	@LD(%I_INDEX)   = BIT_MASK(1)
	@HF(%I_INDEX)   = 0
	@AC(%I_INDEX)   = 0
	@RI(%I_INDEX)   = 48
	@EH(%I_INDEX)   = ""
	@RX(%I_INDEX) ="          " + %UNIT_IDENT+"DPAGROIOPS" 
	@RX(%I_INDEX) = SUBSTR(%RX(%I_INDEX),1,35) + "LLN0.LocSta.stVal"
	
	#IF %b_Fill_IN #THEN #BLOCK
		#IF LENGTH(%v_LLN0_Instance) > 1 #THEN #BLOCK
			@IN(%I_INDEX) = %t_OPC_Prefix + "." + %v_LLN0_Instance(2)
			#IF LOCATE(%IN(%I_INDEX), "LocSta") == 0 #THEN @IN(%I_INDEX) = %IN(%I_INDEX) + ".LocSta.stVal"
		#BLOCK_END
	   #ELSE @IN(%I_INDEX) = ""
	#BLOCK_END
	#ELSE @IN(%I_INDEX) = ""
	@CX=APL:BNA
	
	#IF ATTRIBUTE_EXISTS(%FPI_BAY2, "OP_SWITCH_IND") #THEN @OX(%I_INDEX) = %FPI_BAY2.OP_SWITCH_IND
	#ELSE @OX(%I_INDEX) = "Operator place-switch"
	
	  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I_INDEX' = LIST(-
		 IX = 22,-                                ;index = 10
		 PT = 3,-                                 ;process object type = BI
		 CX = %CX,-
		 DX = %DX(%I_INDEX),-                    	;directive text
		 OI = %OBJ_IDENT,-                        ;substation & bay name
		 OX = %OX(%I_INDEX),-                     ;object text
		 IU = 1,-                                 ;in use = yes
		 SS = 1,-                                 ;switch state = auto
		 EE = 1,-                                 ;event enable = yes
		 HE = %HE(%I_INDEX),-                      ;history enable
		 HA = 1,-                                  ;history activation = new value
		 HF = %HF(%I_INDEX),-                      ;history at first update = no
		 HL = BIT_MASK(15),-                       ;history log number = 15
		 RC = 1,-                                  ;receipt = acknowledgement required
		 AC = %AC(%I_INDEX),-                      ;alarm class = 1
		 AD = 0,-                                  ;alarm delay = 0
		 PD = 0,-                                  ;picture device = none
		 PI = "",-                                 ;alarm picture
		 PF = %PF(%I_INDEX),-                      ;physical format for printout
		 RI = %RI(%I_INDEX),-                      ;dynamic texts for printout
		 PA = 1,-                                  ;printout activation = new value
		 PU = 0,-                                  ;picture/ printout at first update = no
		 IN = %IN(%I_INDEX),-
		 LD = %LD(%I_INDEX),-                      ;listing device
		 EH = %EH(%I_INDEX),-
		 RX = %RX(%I_INDEX))) 						;data acquisition unit and group information
	  
	  
	@I_INDEX = %I_INDEX + 1
	
	@DX(%I_INDEX)	= "E1"
	@HE(%I_INDEX)	= 1                                ;history enable = yes
	@PF(%I_INDEX)  = "FORM5BPU1"                     ;physical format for printout
	@LD(%I_INDEX)  = BIT_MASK(1)
	@RI(%I_INDEX)  = 60
	@EH(%I_INDEX)  = ""
	@RX(%I_INDEX) 	= "          "+%UNIT_IDENT+"DPAGROCOPS"
	@RX(%I_INDEX) = SUBSTR(%RX(%I_INDEX),1,35) + "LLN0Sta.ctlVal"
	
	#IF %b_Fill_IN #THEN #BLOCK
		#IF LENGTH(%v_LLN0_Instance) > 1 #THEN #BLOCK
			@v_LLN0_Instance(2) = REPLACE(%v_LLN0_Instance(2), ".LocSta.stVal", ".LocSta.ctlVal")
			@IN(%I_INDEX) = %t_OPC_Prefix + "." + %v_LLN0_Instance(2)
			#IF LOCATE(%IN(%I_INDEX), "LocSta") == 0 #THEN @IN(%I_INDEX) = %IN(%I_INDEX) + ".LocSta.ctlVal"
		#BLOCK_END
		#ELSE @IN(%I_INDEX) = ""
	#BLOCK_END
	#ELSE @IN(%I_INDEX) = ""
	
	#IF ATTRIBUTE_EXISTS(%FPI_BAY2, "OP_SWITCH_CMD") #THEN @OX(%I_INDEX) = %FPI_BAY2.OP_SWITCH_CMD
	#ELSE @OX(%I_INDEX) = "Operator place-switch command"
	
	#MODIFY P_OBJECTS:V = LIST(P_OBJ0'I_INDEX' = LIST(-
		 IX = 23,-                     			;index = 72
		 PT = 5,-                               	;process object type = BO
		 DX = %DX(%I_INDEX),-                     ;directive text
		 OI = %OBJ_IDENT,-                      	;substation & bay name
		 OX = %OX(%I_INDEX),-                     ;object text
		 IU = 1,-                               	;in use = yes
		 SS = 1,-                               	;switch state = manual
		 EE = 1,-                               	;event enable = yes
		 HE = 1,-                               	;history enable = yes
		 HA = 2,-                               	;history activation = update
		 HF = 1,-                               	;history at first update = yes
		 HL = BIT_MASK(15),-                    	;history log number = 15
		 PF = "FORM5BPU1",-                    	;physical format for printout
		 RI = %RI(%I_INDEX),-                     ;dynamic texts for printout
		 PA = 2,-                               	;printout activation = update
		 PU = 1,-                               	;picture/ printout at first update = yes
		 LD = BIT_MASK(1),-                     	;listing device = 1
		 IN = %IN(%I_INDEX),-
		 RX = %RX(%I_INDEX)))                     ;data acquisition unit and group information
		  
#BLOCK_END

#IF 'ID'_PICTURE_FUNCTION_CONF:VMULTILEVEL_CONTROL #THEN #BLOCK

	@v_attrs = list_attr(%P_OBJECTS)
	@v_attrs = dec_scan(substr(%v_attrs,6,0))
	@v_attrs = pick(%v_attrs,sort(%v_attrs))
	@I_INDEX = %v_attrs(length(%v_attrs)) + 1
		
	@DX(%I_INDEX)	= "E7S"
	@HE(%I_INDEX)   = 1                                ;history enable = yes
	@PF(%I_INDEX)   = "FORM5BPU1"                     ;physical format for printout
	@LD(%I_INDEX)   = BIT_MASK(1)
	@HF(%I_INDEX)   = 0
	@AC(%I_INDEX)   = 0
	@RI(%I_INDEX)   = 50
	@EH(%I_INDEX)   = ""
	@RX(%I_INDEX) ="          " + %UNIT_IDENT+"DPAGROIMLT" 
	@RX(%I_INDEX) = SUBSTR(%RX(%I_INDEX),1,35) + "LLN0.MltLev.setVal"
	
	#IF %b_Fill_IN #THEN @IN(%I_INDEX) = %t_OPC_Prefix + "." + %v_LLN0_Instance(1) + ".MltLev.setVal"
	#ELSE @IN(%I_INDEX) = ""
	#IF ATTRIBUTE_EXISTS(%FPI_BAY2, "MLTLEV_IND") #THEN @OX(%I_INDEX) = %FPI_BAY2.MLTLEV_IND
	#ELSE @OX(%I_INDEX) = "Multilevel control"
	
	
	  #MODIFY P_OBJECTS:V = LIST(P_OBJ0'I_INDEX' = LIST(-
		 IX = 30,-                              	;index = 10
		 PT = 3,- 											;process object type = BI
		 DX = %DX(%I_INDEX),-                    	;directive text
		 OI = %OBJ_IDENT,-                        ;substation & bay name
		 OX = %OX(%I_INDEX),-                     ;object text
		 IU = 1,-                                 ;in use = yes
		 SS = 1,-                                 ;switch state = auto
		 EE = 1,-                                 ;event enable = yes
		 HE = %HE(%I_INDEX),-                      ;history enable
		 HA = 1,-                                  ;history activation = new value
		 HF = %HF(%I_INDEX),-                      ;history at first update = no
		 HL = BIT_MASK(15),-                       ;history log number = 15
		 RC = 1,-                                  ;receipt = acknowledgement required
		 AC = %AC(%I_INDEX),-                      ;alarm class = 1
		 AD = 0,-                                  ;alarm delay = 0
		 PD = 0,-                                  ;picture device = none
		 PI = "",-                                 ;alarm picture
		 PF = %PF(%I_INDEX),-                      ;physical format for printout
		 RI = %RI(%I_INDEX),-                      ;dynamic texts for printout
		 PA = 1,-                                  ;printout activation = new value
		 PU = 0,-                                  ;picture/ printout at first update = no
		 IN = %IN(%I_INDEX),-
		 LD = %LD(%I_INDEX),-                      ;listing device
		 EH = %EH(%I_INDEX),-
		 RX = %RX(%I_INDEX))) 						;data acquisition unit and group information

#BLOCK_END
